<!DOCTYPE html><title MagOS wiki></title><meta charset=utf-8><html><body><p>v.2025-01-24</p>
<hr><a name="Home"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Home</h1>
<p>Welcome to the magos-linux wiki!</p>
<p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">Документация на русском языке</a></p>
<p><a href="https://translate.google.com/translate?act=url&amp;depth=1&amp;hl=ru&amp;ie=UTF8&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=#%25D0%2593%25D0%25BB%25D0%25B0%25D0%25B2%25D0%25BD%25D0%25B0%25D1%258F-%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25BD%25D0%25B8%25D1%2586%25D0%25B0">Documentation - Google Translator</a></p>
<h3>How to make MagOS-Linux with English on default</h3>
<ol>
<li>
<p>delete these files and folders:</p>
<p>boot/grub/grub_ru.cfg<br>
  boot/grub4dos/local<br>
  boot/syslinux/local<br>
  boot/magos/linux/ru_RU.UTF-8<br>
  boot/magos/windows/ru.nls  </p>
</li>
<li>
<p>edit files</p>
<p>EFI/BOOT/grub.cfg<br>
  MagOS-Data/MagOS.ini (sections clock, keyboard, i18n)  </p>
</li>
</ol>
<h3>How to add your native language in MagOS-Linux on default</h3>
<ol>
<li>
<p>please remove and edit files to setup your locale as described in section above</p>
</li>
<li>
<p>download your native language module from <a href="http://ftp.magos-linux.ru/modules/2021/international/">our server</a> and place it into <em>MagOS/modules</em></p>
</li>
<li>
<p>change lang=en to lang=<em>your_locale</em> parameter in file <em>boot/grub4dos/menu.lst</em></p>
</li>
</ol>
<hr><a name="Главная-страница"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Главная страница</h1>
<p>Добро пожаловать в раздел руководства MagOS-Linux!</p>
<ul>
<li><a href="#%D0%A1%D0%BA%D0%B0%D1%87%D0%B0%D1%82%D1%8C">Скачать</a></li>
<li><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">Установка</a></li>
<li><a href="#%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D0%B8">Модули</a></li>
<li><a href="#%D0%A1%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85">Сохранение данных</a></li>
<li><a href="#%D0%9F%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D1%8B-%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8">Параметры загрузки</a></li>
<li><a href="#%D0%A1%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D0%B0">Структура системы</a></li>
<li><a href="#%D0%A7%D0%B0%D0%92%D0%BE(%D0%A7%D0%B0%D1%81%D1%82%D0%BE-%D0%B7%D0%B0%D0%B4%D0%B0%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D1%8B)">ЧаВо(Часто задаваемые вопросы)</a></li>
<li><a href="#Pfs-utils">Pfs-utils</a></li>
<li><a href="#MagOS-%D0%B2-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0">MagOS в режиме сервера</a></li>
<li><a href="#%D0%98%D1%81%D1%82%D0%BE%D1%80%D0%B8%D1%8F">История</a></li>
</ul>
<h3>Введение</h3>
<p>MagOS Linux - это многофункциональный GNU/Linux дистрибутив на пакетной базе Rosa Linux. По принципу действия MagOS-Linux является Live-системой с гибкой настройкой и возможностью сохранения изменений, что позволяет использовать MagOS и как Live систему, и как обычный дистрибутив. При этом можно получить все то же самое, что и в обычном дистрибутиве + невероятную гибкость за счет модулей и возможности загружать систему практически откуда угодно (жесткие диски, флеш накопители, сетевая загрузка по NFS, HTTP, DVD ). А сжатая файловая система делает дистрибутив компактным и увеличивает скорость работы.</p>
<h3>Системные требования:</h3>
<ul>
<li>USB, SATA или иное устройство хранения (флешка, жесткий диск, SD карта, CD/DVD диски) объемом более 2GB (сам MagOS занимает ~2GB)</li>
<li>CPU: все процессоры не ниже i586: Pentium, Celeron, Athlon, Duron, Sempron</li>
<li>RAM: 512MB (для LXQT), 1024MB (для PLasma/KDE) , 2024MB рекомендуется. При небольшом размере памяти рекомендуется включить поиск swap (параметр загрузки findswap)</li>
<li>Видео карта: NVIDIA®, ATI™, Intel® i8xx and i9xx (есть поддержка трехмерного режима и игр)</li>
<li>Звуковая карта: все совместимые с Sound Blaster и AC97</li>
<li>Прочее: поддерживаются практически все сетевые карты, контроллеры дисков, сканеры и принтеры, имеющие свободные драйверы.</li>
<li>BIOS с возможностью загрузки с USB или EFI. Есть возможность использовать загрузочный мини-диск (от 50 MB), который перенаправляет на загрузку с USB).</li>
<li>Архитектура: 64-бит (есть архивные сборки 32бит+PAE, которые более не поддерживаются)</li>
</ul>
<h3>Состав</h3>
<ul>
<li>MagOS содержит порядка 4 GB программного обеспечения, упакованного в xzm модули общим размером около 2 GB.</li>
<li>В состав MagOS входят 2 графические среды: Plasma, LXQT. В качестве графической среды может быть загружен игровой клиент Steam. В виде дополнительного модуля также доступна среда Mate</li>
<li>Включено ПО для работы в интернете, в офисе, средства администрирования и восстановления, графические редакторы, инструменты разработки.</li>
<li>В комплект поставки входит установщик игрового клиента Steam, с помощью которого можно загружать и использовать тысячи игр, совместимые со SteamOS и Linux.</li>
<li>На видеокартах с поддержкой ускорения (Nvidia, AMD/Ati, Intel) возможно использование трёхмерного рабочего стола Compiz с невероятными графическими эффектами.</li>
<li>Для видекарт nvidia в комплекте дистрибутива есть 2 версии фирменных драйверов: nvidia515 и nvidia390 (nvidia-current и nvidia304 для 2016.64). Дистрибутив автоматически определяет необходимый драйвер и использует его, что позволяет использовать все возможности видеокарты для работы в современных играх (также драйвер можно указать вручную параметром загрузки xdriver=драйвер).</li>
</ul>
<h3>Краткий обзор системы</h3>
<ul>
<li>Установка происходит простым копированием файлов на файловую систему(FAT, NTFS, EXT2/3/4, btrfs), загрузчик ставится с помощью скриптов из-под Linux или Windows.</li>
<li>Под файлы сохранения пользователя по умолчанию выделено 512 МB, системные данные по умолчанию сохраняются в xzm модуль, который привязан к текущей машине по mac адресу. </li>
<li>Профили содержат адаптацию системы под себя и не содержат общие файлы дистрибутива, их можно легко архивировать, копировать, просматривать и изменять, сбрасывать изменения файлов (см. /memory/changes или /mnt/live/memory/changes)</li>
<li>Скрипты UIRD дают массу преимуществ, такие как: опция copy2ram и возможность сохранения данных в различных форматах  практически на любых файловых системах и даже сетевых папках.</li>
<li>Возможна работа без жёсткого диска в компьютере. Система может быть загружена с USB накопителей (флешки, жесткие диски, карт-ридеры), CD/DVD диски и даже по сети.</li>
<li>Оборудование автоматически определяется и настраивается при запуске системы. При этом система не задаёт лишние вопросы, после загрузки пользователь получает полностью готовую к использованию систему.</li>
<li>Для настройки системы под себя можно использовать возможности ini файла для редактирования практически любого текстового файла настроек и изменять систему с помощью модулей.</li>
</ul>
<h3>Гибкость системы</h3>
<ul>
<li>Возможно создание настроенных под пользователя неубиваемых ОС, где нужные данные сохраняются на винт в папки, а все изменения системы после перезагрузки пропадают и система восстанавливается в первоначальное состояние.</li>
<li>«Принцип человечности». Система ставится и настраивается не под компьютер, а под человека. Пользователь может носить свою ОС с собой и использовать её на разных компьютерах.</li>
<li>Можно отключать ненужные системные модули и собрать дистрибутив под свои задачи в форматах: Live CD/DVD, Live Flash, Live HDD</li>
<li>Систему можно легко дополнять модулями, причём сделать свой модуль может даже неподготовленный пользователь.</li>
<li>Активировать модуль можно простым щелчком и он тут же «на лету» доступен в системе.</li>
<li>Возможно загрузить систему по HTTP или NFS на бездисковых терминалах и при этом получить толстого клиента с возможностью запуска Windows в виртуальной машине (Windows, работающий по HTTP!!! и не подверженный вирусным атакам). При этом возможна работа в программах, требующих больших вычислительных ресурсов (программы 3D моделирования и т.д.), что не достичь при использовании технологии тонкого клиента.</li>
<li>Поддержка шифрованных AES256 модулей, которые легко создаются и подключаются.</li>
<li>Отдельные контейнеры домашней директории /home с возможностью шифрования AES256.</li>
<li>Модули (*.rwm), доступные на запись, в которых можно хранить отдельные директории, персональные настройки, документы, файлы и т.д.</li>
<li>Простота обновления путем синхронизации с централизованным хранилищем.</li>
<li>и многое другое.</li>
</ul>
<h3>Лицензия</h3>
<p>Данное программное обеспечение (ПО) состоит из компонентов, созданных различными людьми или организациями. Сборочные скрипты и основная часть компонентов распространяются под лицензиями GNU GPL , которые позволяют вам свободно использовать, тиражировать, адаптировать или перераспределять компоненты, на которые распространяется действие лицензий. Остальные компоненты имеют различные лицензии, которые могут ограничивать исследование кода и изменение этих компонентов (см. документацию в /usr/share/doc/ или на сайте производителя).</p>
<h3>Гарантии</h3>
<p>Данное программное обеспечение поставляется без каких-либо гарантий</p>
<h3>Авторы</h3>
<p>Сообщество MagOS-Linux основной сайт <a href="http://magos-linux.ru">magos-linux.ru</a></p>
<h3>Распространение</h3>
<p>Проект создан в рамках основного сайта и имеет свободную лицензию. 
Можно свободно распространять MagOS на носителях и через сети.</p>
<hr><a name="Скачать"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Скачать</h1>
<p>В настоящее время сборки собираются на пакетной базе дистрибутива Rosa  Linux в следующих редакциях:</p>
<ol>
<li>2016.64 (Rosa Desktop Fresh 64bit R11)</li>
<li>2021 (Rosa Desktop Fresh 64bit R12)</li>
</ol>
<p>Редакция 2021 чаще обновляется, в её состав включены более свежие версии программ. Она лучше подходит для домашнего использования, игр, интернета, работы с мультимедиа и документами. Версия 2016.64 предназначена для предприятий, содержит более стабильные старые версии программ.</p>
<p>Основной вариант распространения - архив tar.gz для установки на флешку или жесткий диск. ISO формат, как правило, используется в ознакомительных целях, в виртуальных машинах и для загрузки по сети. В ISO архиве
нет папки MagOS-Data, поэтому для установки на носитель методом копирования этот формат не рекомендуется.</p>
<p>MD5 суммы сборок публикуются на http/ftp ресурсах вместе с файлами сборок (см. файл HEADER.html)</p>
<h3>HTTP сервер</h3>
<ul>
<li><a href="http://magos.sibsau.ru/repository/dist/">http://magos.sibsau.ru/repository/dist/</a></li>
<li><a href="http://magos.sibsau.ru/repository/iso/">http://magos.sibsau.ru/repository/iso/</a></li>
</ul>
<h3>FTP сервер</h3>
<ul>
<li><a href="ftp://magos.sibsau.ru/dist/">ftp://magos.sibsau.ru/dist/</a></li>
<li><a href="ftp://magos.sibsau.ru/iso/">ftp://magos.sibsau.ru/iso/</a></li>
</ul>
<h3>HTTP зеркала</h3>
<ul>
<li><a href="http://mirror.yandex.ru/mirrors/magos/">http://mirror.yandex.ru/mirrors/magos/</a></li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/">https://mirror.yandex.ru/mirrors/magos/</a></li>
</ul>
<h3>FTP зеркала</h3>
<ul>
<li><a href="ftp://mirror.yandex.ru/mirrors/magos/">ftp://mirror.yandex.ru/mirrors/magos/</a></li>
<li><a href="ftp://mirror.yandex.ru/mirrors/magos/">ftp://mirror.yandex.ru/mirrors/magos/</a></li>
</ul>
<h3>Yandex.Disk</h3>
<ul>
<li><a href="https://yadi.sk/d/Tnne2b40zhMaK">https://yadi.sk/d/Tnne2b40zhMaK</a></li>
</ul>
<hr><a name="Установка"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Установка</h1>
<p>MagOS не требует установщика, достаточно просто переписать папки на носитель и установить загрузчик. Возможно установить MagOS на USB брелке, MMC карте, USB/SATA/IDE жёстких дисках, CD и DVD дисках. Поддерживаются как файловые системы Linux, так и fat32, ntfs.</p>
<p>Для установки нужно:</p>
<ol>
<li>
<p>Переписать папки <strong>EFI boot MagOS MagOS-Data</strong> в корень раздела жесткого диска или USB накопителя. </p>
<ul>
<li>Папка <em>boot</em> должна быть обязательно на загрузочном разделе (флешка, диск C, линуксовый загрузочный раздел). </li>
<li>Папки <em>MagOS</em> и <em>MagOS-Data</em> могут быть скопированы в корень любого раздела, как вместе, так и на разные разделы.  </li>
<li><em>Для того, чтобы иметь возможность сохранять данные в динамический файл или папку и устанавливать игровой клиент Steam, папку MagOS-Data желательно разметить на отдельном линуксовом разделе, который можно создать на флешке или диске с помощью программы Gparted.</em></li>
</ul>
</li>
<li>
<p>Установить или настроить загрузчик. В большинстве случаев достаточно запустить с правами администратора в Windows или Linux универсальный установочный скрипт <strong>boot/magos/Install.bat</strong>. </p>
<ul>
<li><strong>Не запускайте скрипты с произвольного места, только с того диска и раздела, куда вы хотите установить MagOS, скрипты меняют mbr диска и boot секторы раздела, на котором лежат!</strong></li>
<li><em>Cкрипты установки загрузчика нужно запускать под администратором:</em></li>
<li><em>В Windows сначала запустите проводник или файловый менеджер под администратором, а потом из под него скрипт,    тоже под администратором (запускается по правой кнопке мыши)</em></li>
<li><em>В Linux скрипты надёжнее всего запускать в консоли через команду bash имя_скрипта.sh. Запуск с правами администратора осуществляется с помощью команд <strong>su -</strong>(пароль) и <strong>bash Install.bat</strong> . D Ubuntu-подобной системе используйте <strong>sudo bash Install.bat</strong></em></li>
</ul>
</li>
</ol>
<p>Поддерживаемые загрузчиком syslinux файловые системы:</p>
<ul>
<li>fat32, ntfs, ext2, ext3, ext4, ext4-64bit, btrfs, xfs</li>
<li>таблицы разделов dos (mbr) и GPT (полная поддержка GPT возможна только в Linux, в Windows установка возможна только на специально подготовленное устройство с установленными флагами)</li>
<li>возможна установка на устройства без таблиц разделов (superfloppy)</li>
</ul>
<h3>Другие варианты установки</h3>
<ul>
<li>Для загрузки в режиме EFI загрузчик устанавливать не нужно, достаточно просто переписать папки <strong>EFI</strong> и <strong>boot</strong> на загрузочный раздел fat32</li>
<li>
<p>Создание ISO образа. Для создания образа используйте скрипты:</p>
<p>Linux - boot/magos/linux/make_iso.sh<br>
  Windows - boot/magos/windows/make_iso.bat</p>
</li>
<li>
<p>Если BIOS не поддерживает загрузку с USB, то можно создать специальный мини iso образ (менее 60МБ), который будет содержать лишь загрузчик, ядро и uird (initrd), в то время как сама система будет найдена и загружена с флешки. Для создания образа используйте скрипты:</p>
<p>Linux - boot/magos/linux/make_boot_iso.sh<br>
  Windows - boot/magos/windows/make_boot_iso.bat</p>
</li>
<li>
<p>Добавление загрузчика к BCD. В случае запуска под Windows Vista/7/8/10, скрипт добавит запись MagOS Linux в загрузчик Windows. После включения компьютера вам будет предложен выбор операционной системы для запуска.</p>
<p>boot/magos/windows/add2bcd.bat</p>
</li>
<li>
<p>Добавление загрузчика к ntldr. В случае запуска под Windows XP, скрипт добавит запись MagOS Linux в загрузчик Windows NTLDR. После включения компьютера вам будет предложен выбор операционной системы для запуска.</p>
<p>boot/magos/windows/add2ntld.bat</p>
</li>
<li>
<p>В MagOS можно выполнить разбивку устройства на разделы, форматирование файловых систем и автоматическую установку системы через графический помощник  <em>Меню-Настройки-Системные-Установка MagOS</em>. Будьте внимательны, этот вариант может привести к потери данных, если вы перепутаете диски!</p>
</li>
</ul>
<hr><a name="Модули"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Модули</h1>
<p>Модульность системы - одно из преимуществ MagOS-Linux. Файлы операционной системы с приложениями не поставляются одним большим куском, а разбиты на части, которые можно отключать, уменьшив размер системы. Также вы можете легко создавать свои собственные модули и добавлять их в систему. </p>
<h3>Что такое модуль?</h3>
<p>Проще говоря, стандартный модуль - это архив, который  не нужно распаковывать, чтобы использовать. Технически - это петлевое (loopback) устройство, упакованное файловой системой squashfs и сжатое по алгоритму xz. В результате получается файл с расширением <strong>.xzm</strong> </p>
<h3>Как это работает</h3>
<p>В GNU/Linux любое петлевое устройство можно подключить (смонтировать) к произвольной папке, в результате, зайдя в папку вы сможете видеть содержимое этого устройства. Стандартно, при подключении к одной папке нескольских устройств, мы сможем использовать только последнее. Файловая система aufs позволяет смешивать содержимое нескольких папок в одну, подключая ветви как в режиме чтения, так и на запись. MagOS-Linux, используя оба этих механизма, подключает каждый модуль в папку, а потом объединяет эти доступные на чтение папки в одну файловую систему aufs. Самым последним уровнем добавляется папка с возможностью записи, это либо обычная папка, либо несжатое петлевое устройство (профиль или файл-контейнер), либо просто файловая система tmpfs (чистый режим). В результате, зайдя в папку, мы видим файлы всех модулей и даже можем их изменять, как будто это обычная папка на жёстком диске. Вот схема:</p>
<pre><code>  модуль 1    +   модуль 2    +   модуль 3    =   aufs
  ├─ папка 1      ├─ папка 1      ├─ папка 1      ├─ папка 1 (атрибуты из модуля 3)
  │  ├─ файл 1-1  │  └─ файл 1-3  │  └─ файл 1-1  │  ├─ файл 1-1 (файл из модуля 3)
  │  └─ файл 1-2  └─ папка 2      └─ папка 3      │  ├─ файл 1-2
  └─ папка 2         └─ файл 2-2     └─ файл 3-1  │  └─ файл 1-3
     └─ файл 2-1                                  ├─ папка 2 (атрибуты из модуля 2)
                                                  │  ├─ файл 2-1
                                                  │  └─ файл 2-2
                                                  └─ папка 3 (атрибуты из модуля 3)
                                                     └─ файл 3-1
</code></pre>
<p>В случае, если модули содержат файл с одинаковым именем в одной и той же папке (файл 1-1 на схеме), то файл из модуля с большим уровнем "переписывает" все предыдущие. Кроме того, если папка содержится в нескольких модулях, то в результате она будет иметь права доступа, которые указаны в последнем модуле. Применительно к схеме это обозначает, что права папок 1 и 3 будут такими же, как в модуле 3, а права папки 2 - как в модуле 2.</p>
<h3>Стандартные системные модули</h3>
<p>Все модули системы лежат в папке MagOS/base. В сборке 2016.64 их всего 12:</p>
<ul>
<li><strong>00-kernel.xzm</strong> - ядро и модули ядра, обязательный модуль</li>
<li><strong>01-drivers.xzm</strong> - дополнительные драйверы и прошивки, в т.ч. драйверы для карт nvidia</li>
<li><strong>10-core.xzm</strong> - системные библиотеки и утилиты, уровня командной строки, обязательный модуль</li>
<li><strong>20-x-base.xzm</strong> - графический сервер, утилиты и библиотеки для работы в графике, LXQT, менеджеры входа sddm, slim</li>
<li><strong>35-x-plasma.xzm</strong> - графическая среда Plasma, со своими библиотеками и приложениями</li>
<li><strong>41-x-utilities.xzm</strong> - дополнительные системные утилиты</li>
<li><strong>42-x-network.xzm</strong> - программы и утилиты для работы с сетью</li>
<li><strong>43-x-multimedia.xzm</strong> - программы и библиотеки для работы со звуком/видео/играми</li>
<li><strong>44-x-office.xzm</strong> - офисные программы, поддержка печати и сканера</li>
<li><strong>45-x-java.xzm</strong> - поддержка java</li>
<li><strong>70-documentation.xzm</strong> - документация к программам и утилитам, в т.ч. man, info. </li>
<li><strong>88-magos.xzm</strong> - скрипты и файлы MagOS, меняющие и дополняющие базовую систему, файлы настроек, скрипты, наше оформление и темы.</li>
</ul>
<p>Для сборки 2021 список будет немного отличаться:</p>
<ul>
<li><strong>00-kernel.xzm</strong> - ядро и модули ядра, обязательный модуль</li>
<li><strong>01-drivers-wireless.xzm</strong> - дополнительные драйверы для wifi карт</li>
<li><strong>01-x-drivers-mesa.xzm</strong> - свободные драйверы и библиотеки для различных видеокарт</li>
<li><strong>01-x-drivers-nvidia390.xzm</strong> - фирменный драйвер для устаревших видеокарт nvidia</li>
<li><strong>01-x-drivers-nvidia515.xzm</strong> - фирменный драйвер для современных видеокарт nvidia</li>
<li><strong>10-core.xzm</strong> - системные библиотеки и утилиты, уровня командной строки, обязательный модуль</li>
<li><strong>20-x-base.xzm</strong> - графический сервер, утилиты и библиотеки для работы в графике, LXQT, менеджеры входа sddm, slim</li>
<li><strong>35-x-plasma.xzm</strong> - графическая среда Plasma, со своими библиотеками и приложениями</li>
<li><strong>41-applications.xzm</strong> - программы и утилиты уровня пользователя</li>
<li><strong>42-x-office.xzm</strong> - офисные программы, поддержка печати и сканера</li>
<li><strong>43-admintools.xzm</strong> - программы и утилиты уровня администратора</li>
<li><strong>51-x-gimp.xzm</strong> - программа Gimp для работы с фотографиями</li>
<li><strong>51-x-inkscape.xzm</strong> - программа Inkscape для работы с векторной графикой</li>
<li><strong>51-x-mozilla.xzm</strong> - программы Mozilla Firefox и Thunderbird для работы в сети</li>
<li><strong>51-x-virtualbox.xzm</strong> - эмулятор Virtualbox</li>
<li><strong>52-x-steam.xzm</strong> - игровой клиент Steam и библиотеки, необходимые для его работы</li>
<li><strong>70-documentation.xzm</strong> - документация к программам и утилитам, в т.ч. man, info. </li>
<li><strong>88-magos.xzm</strong> - скрипты и файлы MagOS, меняющие и дополняющие базовую систему, файлы настроек, скрипты, наше оформление и темы.</li>
</ul>
<p>Не вошедшие в сборку модули можно скачать с <a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/">сервера</a> и установить в папку MagOS/modules</p>
<ul>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/international/">international/</a> - папка с дополнительными языковыми модулями</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/01-drivers-extra.xzm">01-drivers-extra.xzm</a> - дополнительные драйверы, не вошедщие в сборку (cypress dpaa2 qca qcom bnx2 bnx2x cxgb4 liquidio mellanox netronome qed)</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/01-x-drivers-printers.xzm">01-x-drivers-printers.xzm</a> - драйверы принтеров</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/18-squid.xzm">18-squid.xzm</a> - прокси сервер squid</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/31-x-mate.xzm">31-x-mate.xzm</a> - графическая среда Mate </li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/45-x-java.xzm">45-x-java.xzm</a> - средства Java</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/46-devel.xzm">46-devel.xzm</a> - средства разработки и библиотеки к ним</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/51-x-chromium.xzm">51-x-chromium.xzm</a> - альтернативный браузер на движке Google Chrome</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/51-x-newmoon.xzm">51-x-newmoon.xzm</a> - альтернативный браузер для слабых машин</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/51-x-rawtherapee.xzm">51-x-rawtherapee.xzm</a> - средство для провессиональной работы с фотографиями, в т.ч. в raw формате</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/51-x-wine.xzm">51-x-wine.xzm</a> - неэмулятор wine, для запуска программ для windows</li>
<li><a href="https://mirror.yandex.ru/mirrors/magos/modules/2021/51-x-wireshark.xzm">51-x-wireshark.xzm</a> - графический перехватчик сетевых пакетов</li>
</ul>
<h3>Папки для хранения модулей</h3>
<ul>
<li><strong>MagOS/base</strong> - папка для системных модулей, загружаемых автоматически</li>
<li><strong>MagOS-Data/modules</strong> - папка для пользовательских модулей, загружаемых автоматически</li>
<li><strong>MagOS-Data/optional</strong> - папка для доп. модулей, загружаемых с помощью параметров загрузки <em>uird.load+= load=</em></li>
<li><strong>MagOS-Data/machines</strong> - папка для сохранения системных настроек в виде xzm модуля, привязанного к MAC адресу</li>
<li><strong>MagOS-Data/machines/dynamic</strong> - по умолчанию здесь ищется модуль машины при загрузке и сюда же сохраняется при выключении. </li>
<li><strong>MagOS-Data/machines/static</strong> - если модуль машины перенесён сюда (можно переносить модуль, даже если вы загружены с ним), то он "замораживается", читается при старте, но не сохраняется при выключении.</li>
</ul>
<h3>Подключение и отключение модулей</h3>
<p>Для того, чтобы подключить модуль можно использовать консольную команду <strong>activate модуль.xzm</strong> , а для отключения соответственно <strong>deactivate модуль.xzm</strong> . Команды нужно запускать под пользователем <em>root</em> . Также, можно подключить и отключить модули двойным щелчком в графической среде, при этом будет запрошен пароль root (по умолчанию это <em>toor</em>)</p>
<h3>Добавление модулей в автозагрузку и удаление из автозагрузки</h3>
<p>Чтобы модуль автоматически загружался при старте системы, его можно положить в одну из папок:</p>
<ul>
<li><strong>MagOS/base</strong> - папка для системных модулей. Сюда же можно помещать модули-заплаты, если в текущей сборке будут выявлены ошибки. Хранить пользовательские модули здесь не рекомендуется, т.к. при обновлении папка MagOS будет полностью перезаписана</li>
<li><strong>MagOS-Data/modules</strong> - папка для пользовательских модулей, при обновлении не изменяется.</li>
</ul>
<h3>Распаковка модуля</h3>
<p>Чтобы распаковать модуль в заранее созданную папку, используйте под правами root консольную команду <strong>xzm2dir модуль.xzm папка</strong>. Содержимое уже подключенного модуля можно найти в соответствующей ему папке в /memory/bundles .</p>
<h3>Создание модуля</h3>
<p>Для создания модуля, вам следует подготовить папку, где расположить все данные так, как будто они лежат в корне системы. Для создания модуля из папки используйте под правами root консольную команду <strong>dir2xzm папка модуль.xzm</strong> . Создать модуль можно также и в графической среде, через меню действий файлового менеджера Dolphin.</p>
<h3>Создание модуля программы вручную</h3>
<p>Если у вас есть архив или rpm пакет с какой-либо программой и вы хотите создать модуль вам нужно сделать следующее:</p>
<ol>
<li>распаковать под учётной записью root содержимое пакета в пустую папку. Проще всего это <a href="#%D0%A7%D0%B0%D0%92%D0%BE(%D0%A7%D0%B0%D1%81%D1%82%D0%BE-%D0%B7%D0%B0%D0%B4%D0%B0%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D1%8B)">сделать с помощью mc</a>. С помощью mc можно входить в пакеты как в папки и легко копировать их содержимое.</li>
<li>создать модуль командой  <strong>dir2xzm папка программа.xzm</strong>
Если для работы программы необходимы другие пакеты с библиотеками, отсутствующими в сборке, то их содержимое можно аналогичным образом объединить вместе с программой в один модуль, либо сделать отдельный модуль для библиотек.</li>
</ol>
<h3>Создание модуля программы автоматически</h3>
<p>Если вам нужно сделать модуль из множества пакетов, либо для сложных программ, имеющих установочные скрипты, которые меняют системные файлы при установке, вы можете воспользоваться специальным графическим помощником, расположенном в разделе "Инструменты MagOS" Центра управления MagOS. Либо консольной командой <strong>urpm2xzm &lt;название пакета&gt;</strong>. Зависящие пакеты будт скачаны и добавлены автоматически. </p>
<p><em>В сложном случае, если пакет содержит установочные скрипты (как правило, это не пользовательские программы, а серверы), то в модуль будут добавлены изменённые скриптами системные файлы, что в будущем может привести к несовместимости с другими подобными модулями, созданные этим же методом. Поэтому, если это возможно, сверните все такие программы в один модуль за один раз. Если у вас возникнут сложности, обращайтесь в сообщество за помощью.</em></p>
<h3>Другие типы модулей</h3>
<p>Кроме стандартных модулей XZM, в MagOS можно использовать другие типы модулей: </p>
<ul>
<li>*.xzm.cp - XZM модуль, который не подключается, а распаковывается в корень системы</li>
<li>*.rom - петлевое устройство (файл-контейнер) только на чтение</li>
<li>*.rwm - петлевое устройство (файл-контейнер) с записью </li>
<li>*.rom.enc - шифрованное петлевое устройство (файл-контейнер) только на чтение</li>
<li>*.rwm.enc - шифрованное петлевое устройство (файл-контейнер) с записью</li>
</ul>
<p>Использование этих модулей может быть полезно опытным пользователям, т.к. расширяет возможности модульного механизма даёт дополнительные возможности для нестандартных ситуаций.</p>
<hr><a name="Сохранение-данных"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Сохранение данных</h1>
<p>MagOS-Linux построен как Live дистрибутив и может эксплуатироваться в этом режиме (Чистый режим загрузки). Все изменённые и вновь созданные пользователем файлы в этом случае размещаются в памяти компьютера (файловая система tmpfs). После выключения или перезагрузки компьютера, всё, что не сохранено на диски компьютера или на USB носители будет утеряно.</p>
<p>В магос несколько режимов работы с сохранением данных в разных ситуациях можно использовать разные способы. Важно понимать, что <strong>новые и измененные файлы хранятся отдельно от системных</strong> и это дает интересные возможности:</p>
<ul>
<li>Изменения хранятся в tmpfs (в RAM) и после перезагрузки исчезают.</li>
<li>Изменения хранятся в tmpfs, но во время выключения сохраняются в модуль, а при старте вновь распаковываются в tmpfs</li>
<li>Изменения сразу пишутся на диск (в папку, в файл.img, в сетевую папку папку по NFS и т.д.</li>
<li>Режимы можно комбинировать для пользовательских (/home) и системных (/) данных.</li>
</ul>
<p>По умолчанию MagOS-Linux загружается в режиме сохранения данных, в этом случае дистрибутив лишён недостатков Live системы и с точки зрения пользователя ведёт себя точно так же, как и обычный дистрибутив, установленный на раздел жёсткого диска. На самом деле, MagOS-Linux от обычного дистрибутива выгодно отличается тем, что возможностей сохранения данных у нас гораздо больше. Кроме того, в случае обычного дистрибутива, если что-то пошло не так и вы в результате эксперимента сломали систему, вам придётся переустанавливать дистрибутив и настраивать его с нуля. В случае MagOS-Linux, вы можете легко посмотреть какие именно файлы изменились (см. /memory/changes) и частично или полностью сбросить эти изменения.</p>
<h2>Системные и пользовательские данные</h2>
<p>Для удобства пользователя сохраняемые данные разделены на две группы:</p>
<ul>
<li>пользовательские данные (всё что расположено в папке /home)</li>
<li>системные данные (все остальные файлы, которые не расположены в /home и на подключенных файловых системах)</li>
</ul>
<p>Такое разделение удобно тем, что данные пользователя, как правило, не зависят от машины, на которой запущена система и зависят только от предпочтений пользователя. Системные же данные, напротив, зависят от конкретной машины и её задачах в сети. В системных данных сохраняются настройки на встроенное и периферийное оборудование машины, настройки сети, настройки служб и серверов, которая эта машина предоставляет другим компьютерам в сети. Разделение данных в режиме по умолчанию позволяет пользователю иметь единые настройки пользовательских программ и графической среды на всех машинах, 
на которых загружается система и особые системные настройки для каждой машины.</p>
<p>Технически, возможно отказаться от такого разделения, не указав способ сохранения пользовательских данных, тогда пользовательские данные будут храниться вместе с системными данными.</p>
<h2>Параметры загрузки для настройки сохранений</h2>
<p>Для настройки сохранений применяются следующие параметры загрузки:</p>
<ul>
<li><strong>uird.mode=</strong> MODE - определяет режим работы сохранениями (clean, clear, changes, machines, toxzm)</li>
<li><strong>uird.home=</strong> - источник, где хранятся домашние папки пользователей </li>
<li><strong>uird.homes[+]=</strong> - источники, где хранятся домашние папки пользователей (объединяются с помощью AUFS) </li>
<li><strong>uird.changes=</strong> - источник, где хранить системные изменения</li>
</ul>
<p>Параметр <strong>uird.mode</strong> определяет режим сохранения данных, возможно использовать одно значение из следующих:</p>
<ul>
<li>clean - (по умолчанию) чистый режим, без сохранений. Не требует указания uird.changes. Возможно указание uird.home,uird.homes.</li>
<li>clear - разновидность чистого режима, с использованием источника вместо оперативной памяти, который очищается при старте. Требуется указание uird.changes. Возможно указание uird.home,uird.homes.</li>
<li>changes - режим сохранения данных в источник, единый для всех машин. Требуется указание uird.changes. Возможно указание uird.home,uird.homes.</li>
<li>machines - режим сохранения данных в особые источники для каждой машины. Не требуется обязательное указание uird.changes, но может использоваться для переопределения местоположения особых источников. Возможно указание uird.home,uird.homes.</li>
<li>toxzm - (экспериментальный) режим сохранения в модуль по смыслу аналогичный machines, но с очень гибкими настройками. Например позволяет сохранять в несколько модулей одновременно с разными фильтрами. Подробности тут https://forum.magos-linux.ru/t/instrukcziya-dlya-toxzm/122</li>
</ul>
<p>Параметры <strong>uird.home uird.homes uird.changes</strong> определяют расположение источников для сохранения данных. Эти  параметры похожи по своему использованию, их значения будут рассмотрены подробно в описании типов доступных источников. Если использовать параметр uird.homes+= (со знаком +), то значения дополняют указанные ранее в другом месте параметры, если без знака + uird.homes=, то ранее указанные значения заменяются.</p>
<p>По умолчанию в режиме сохранения данных используются параметры uird.mode=machines uird.home=home.img </p>
<h2>Варианты сохранений</h2>
<p>Использование параметров <strong>uird.home uird.homes uird.changes</strong>, которыми задаются источники для сохранений практически идентично, поэтому вы можете указывать для них любой из ниже перечисленных вариантов, кроме механизма uird.mode=machines. Значением для этих параметров может быть объект (файл img, папка, модуль и пр.), лежащий на блочном или сетевом носителе.</p>
<p>Формат параметров:</p>
<ul>
<li><strong>uird.home=</strong><em>&lt;расположение&gt;/&lt;объект&gt;</em></li>
<li><strong>uird.homes=</strong><em>&lt;расположение&gt;/&lt;объект&gt;</em></li>
<li><strong>uird.homes+=</strong><em>&lt;расположение&gt;/&lt;объект&gt;</em></li>
<li><strong>uird.changes=</strong><em>&lt;расположение&gt;/&lt;объект&gt;</em></li>
</ul>
<p>Указание параметра отменяет ранее определённое значение этого параметра. К примеру, значение, введённое вручную на  графическом экране загрузчика отменит указанное в файле настройки menu.lst. За исключением параметра uird.homes+=, когда указанное значение дополняет существующее.</p>
<h3>Расположение источников</h3>
<ul>
<li><strong>...</strong>                       - если источник расположен в каталоге MagOS-Data, то путь к нему можно не указывать</li>
<li><strong>/path/...</strong>                 - источник на любом доступном дисковом носителе</li>
<li><strong>/dev/[..]/path/...</strong>        - носитель, заданный устройством в /dev</li>
<li><strong>LABEL@/path/...</strong>           - носитель с меткой LABEL</li>
<li><strong>UUID@/path/...</strong>            - дисковый раздел с идентификатором UUID</li>
<li><strong>http://server/path/...</strong>    - сетевой ресурс, доступный по HTTP (используется httpfs) </li>
<li><strong>ssh://server/path/...</strong>     - сетевой ресурс, доступный по SSH (используется sshfs)</li>
<li><strong>ftp://server/path/...</strong>     - сетевой ресурс, доступный по FTP (используется curlftpfs)</li>
<li><strong>nfs://server/path/...</strong>     - сетевой ресурс, доступный по NFS </li>
<li><strong>cifs://server/path/...</strong>    - сетевой ресурс, доступный по CIFS </li>
</ul>
<h3>Сохранение в файл</h3>
<p>В режиме с сохранением данных данные пользователя сохраняются в файл MagOS-Data/home.img. Файл представляет собой заранее подготовленный образ файловой системы. Файловая система в таком образе может быть практически любой, поддерживаемой GNU/Linux, в которой сохранятся POSIX права и атрибуты файлов (FAT и NTFS поэтому отпадают, они могут быть лишь носителем этого файла). Расширение файла должно быть .img , чтобы скрипты загрузки правильно определили тип этого файла.</p>
<p><strong>Примеры использования:</strong></p>
<pre><code>  uird.home=home.img
  uird.homes=user1.img;user2.img
  uird.changes=/MagOS-Data/MagOS-save1.img
</code></pre>
<p><strong>Преимущества:</strong></p>
<ul>
<li>файл может лежать на любой файловой системе, которая не поддерживает Linux атрибуты, в результате, MagOS можно установить на распространённые диски с fat и ntfs, на ПК с Windows, где нет дисковых разделов для Linux</li>
<li>доступ к содержимому файла можно получить только в Linux (команда <em>mount -o loop home.img папка</em>)</li>
</ul>
<p><strong>Недостатки:</strong></p>
<ul>
<li>файл "съедает" место, выделенное на носителе, даже если он практически пустой</li>
<li>доступ к содержимому файла можно получить только в Linux</li>
</ul>
<p><strong>Как создать:</strong></p>
<p><em>Для создания ФС (команда mkfs.*) требуются полномочия root</em></p>
<pre><code>  dd if=/dev/zero of=system.img bs=1M count=1024 # Создаётся контейнер размер 2048МБ
  mkfs.ext2 system.img                           # Создается файловая система ext2
</code></pre>
<p>Создание контейнера для системных данных размером 1Гбайт с файловой системой ext2.</p>
<pre><code>  dd if=/dev/zero of=home.img bs=1M count=2048   # Создаётся контейнер размер 2048МБ
  mkfs.ext4 -m0 home.img                         # Создается файловая система ext4
</code></pre>
<p>В этом примере создаётся профиль размером 2 Гбайта c файловой системой ext4 для пользовательских данных. Параметр -u0 отменяет резервирование свободного места для пользователя root.</p>
<pre><code>  dd if=/dev/zero of=home.img bs=1 count=0 seek=4096M # создание sparse файла до 4Г
  mkfs.ext2 -m0 home.img                              # Создается ФС ext2
</code></pre>
<p>Здесь создаётся динамический файл, который занимает столько места, сколько занимает его содержимое, что устраняет основной недостаток этого типа сохранения. Возможно использование sparse файла только на линуксовых файловых системах и NTFS. При копирование sparse файла на другой раздел обычными методами его sparse свойства теряются. Создавайте такие файлы в той папке, где вы планируете их использовать.</p>
<p>Можно достать готовый профиль из архива MagOS-Data\profiles.7z, например с помощью <a href="#%D0%A7%D0%B0%D0%92%D0%BE(%D0%A7%D0%B0%D1%81%D1%82%D0%BE-%D0%B7%D0%B0%D0%B4%D0%B0%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D1%8B)">mc</a>, который умеет входить в архив, как в папку.</p>
<h3>Сохранение в каталог</h3>
<p>Cамый простой источник - это просто каталог, пустой или нет, который либо объединяется слоем поверх корневой системы (uird.changes), либо подключается к каталогу /home и сохраняет пользовательские данные (uird.home, uird.homes). Любые изменения файлов происходят одновременно и в месте подключения и в самом каталоге. Добавление или изменение файлов в каталогах напрямую желательно производить, когда эти источники отключены. Может использоваться только каталог на файловых системах GNU/Linux (к примеру, EXT2/3/4, BTRFS, REISERFS, сетевая NFS).</p>
<p><strong>Примеры использования:</strong></p>
<pre><code>  uird.home=homes
  uird.homes=user1;user2
  uird.changes=changes
</code></pre>
<p><strong>Преимущества:</strong></p>
<ul>
<li>простота создания и получения доступа к данным</li>
<li>не занимает дополнительное место в ущерб файловой системе-носителю.</li>
</ul>
<p><strong>Недостатки:</strong></p>
<ul>
<li>каталог должен лежать только на файловой системе, позволяющей сохранять атрибуты Linux. Т.е. могут использоваться только GNU/Linux ФС, не поддерживаются FAT, NTFS и большинство сетевых протоколов. </li>
</ul>
<p><strong>Как создать:</strong></p>
<ul>
<li>
<p>для того, чтобы использовать сохранение в каталог, вам следует расположить этот каталог на специальном разделе, отформатированном, к примеру под <em>ext2</em> (нежурналируемая ФС, меньше обращений к диску, бережнее к флешкам и SSD), либо <em>ext3/4</em> (журналируемая, выше надёжность, меньше вероятность потерять данные). Windows видит только первый раздел на флешке, поэтому можно с помощью программы Gparted поделить флешку на 2 (или более) раздела: </p>
<ul>
<li>первый раздел создать с типом fat/ntfs и установить туда загрузчик (папки <em>boot EFI</em>)</li>
<li>второй раздел с ext2/3/4 и расположить там папку <em>MagOS-Data</em></li>
<li>каталог <em>MagOS</em> можно расположить и там и там, но в случае, если он находится не вместе с <em>boot</em>, то в настройках загрузчика <em>boot/grub4dos/local/menu.lst</em> следует раскомментировать строку:</li>
</ul>
<p>find --set-root --ignore-floppies --ignore-cd /MagOS/MagOS.sgn</p>
</li>
</ul>
<h3>Зашифрованный контейнер</h3>
<p>Для хранения персональных данных рекомендуется использовать зашифрованный источник. Это файл, аналогичный обычному файлу-контейнеру, но зашифрованный поблочно с использованием алгоритма AES. Расширение файла должно быть <strong>.enc</strong>. Защитить можно, как пользовательские данные (uird.home, uird.homes), так и системные (uird.changes).
Во время загрузки в текстовом режиме, система спросит пароль для подключения контейнера.</p>
<p><strong>Примеры использования:</strong></p>
<pre><code>  uird.home=home.enc
  uird.changes=changes.enc
</code></pre>
<p><strong><em>(Если вы параноик со стажем можно зашифровать даже весь магос целиком:)</em></strong></p>
<pre><code>  uird.from=/magos.enc;/Magos;/MagOS-Data
</code></pre>
<p>Для того чтобы это сработало нужно создать magos.enc 3 гигабайта и больше, смонтировать его (см.ниже) и распаковать в смонтированный файл архив с магос.</p>
<p><strong>Преимущества:</strong></p>
<ul>
<li>файл может лежать на любой файловой системе, которая не поддерживает Linux атрибуты, в результате, MagOS можно установить на распространённые диски с fat и ntfs, на ПК с Windows, где нет дисковых разделов для Linux</li>
<li>доступ к содержимому файла можно получить только в Linux, зная пароль (команда <em>mountloop файл.enc папка</em>)</li>
</ul>
<p><strong>Недостатки:</strong></p>
<ul>
<li>файл "съедает" место, выделенное на носителе, даже если он практически пустой</li>
<li>требуется вводить пароль при каждой загрузке</li>
<li>если вы забудете пароль, то потеряете свои данные</li>
</ul>
<p><strong>Как создать:</strong></p>
<p>Для работы с шифрованными контейнерами в MagOS-Linux созданы специальные скрипты:</p>
<ul>
<li><strong>createloop</strong> - для создания контейнера</li>
<li><strong>mountloop</strong> - для подключения контейнера в каталог</li>
<li><strong>umountloop</strong> - для отключения контейнера</li>
</ul>
<p>Скрипты имеют краткую подсказку по параметрам, для вывода подсказки используйте <em>скрипт --help</em>, или просто запустите без параметров. Скрипты должны быть запущены <a href="#%D0%A7%D0%B0%D0%92%D0%BE(%D0%A7%D0%B0%D1%81%D1%82%D0%BE-%D0%B7%D0%B0%D0%B4%D0%B0%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D1%8B)">в консоли с правами root</a>.</p>
<p><strong>Примеры работы с контейнерами:</strong></p>
<p><em>Создание файла</em></p>
<p><strong># createloop home.enc 1024M</strong><br>
Creating encrypted filesystem home.enc with size 1024 x 1Mbytes.<br>
1048576+0 записей получено<br>
1048576+0 записей отправлено<br>
скопировано 1073741824 байта (1,1 GB), 1,71204 c, 627 MB/c<br>
Password:test<br>
mke2fs 1.43.3 (04-Sep-2016)<br>
Creating filesystem with 262144 4k blocks and 65536 inodes<br>
Filesystem UUID: 1bd40882-7535-4424-9a94-7155bd9a7a31<br>
Superblock backups stored on blocks:<br>
32768, 98304, 163840, 229376<br>
Allocating group tables: done<br>
Writing inode tables: done<br>
Creating journal (8192 blocks): done<br>
Writing superblocks and filesystem accounting information: done  </p>
<p><em>Подключение контейнера к каталогу</em></p>
<p><em>создание каталога (каталог должен быть создан заранее)</em><br>
<strong># mkdir /mnt/tmp</strong><br>
<em>подключение</em><br>
<strong># mountloop home.enc /mnt/tmp</strong><br>
Mointing encrypted filesystem home.enc to folder /mnt/tmp<br>
Password:<br>
просмотр содержимого<br>
<strong># ls /mnt/tmp</strong><br>
lost+found/</p>
<p><em>Отключение контейнера</em></p>
<p><strong># umountloop /mnt/tmp</strong></p>
<p><em>Создание вручную sparse файла с файловой системой EXT2. Возможно только, если MagOS-Data лежит на линуксовой ФС или ntfs.</em></p>
<p><em>1. создание sparse файла</em><br>
<strong># dd if=/dev/zero of=home.enc bs=1 count=0 seek=1024M</strong><br>
  0+0 записей получено<br>
  0+0 записей отправлено<br>
  скопировано 0 байт (0 B), 0,00182707 c, 0,0 kB/c<br>
<em>2. подключение файла к устройству /dev/mapper/myenchome (имя произвольное) с паролем password</em><br>
<strong># echo password | cryptsetup open --type loopaes home.enc myenchome --key-file -</strong><br>
<em>3. форматирование под ext2</em><br>
<strong># mkfs.ext2 /dev/mapper/myenchome</strong><br>
  mke2fs 1.43.3 (04-Sep-2016)<br>
  Creating filesystem with 262144 4k blocks and 65536 inodes<br>
  Filesystem UUID: 6f7c1b63-8800-4ebb-bafd-a77e1a229e7f<br>
  Superblock backups stored on blocks:<br>
           32768, 98304, 163840, 229376<br>
  Allocating group tables: done<br>
  Writing inode tables: done<br>
  Writing superblocks and filesystem accounting information: done<br>
<em>4. не забывайте про отключение устройства, иначе кто-нибудь сможет подключить его без ввода пароля</em><br>
<strong># cryptsetup close myenchome</strong></p>
<h2><a href="https://ru.wikipedia.org/wiki/LUKS">LUKS</a></h2>
<p>Разделы зашифрованные LUKS могут быть использованы в магос наравне с обычными разделами (только uird). 
То есть все что вы можете разметить на обычном разделе можно разместить и на шифрованном LUKS.
Это uird.mounts, uird.from, uird.home. Вероятно сработает и с uird.ro(cp), но там крипто контейнеры явно удобнее.</p>
<h3>Создание радела LUKS</h3>
<ol>
<li>Создаете раздел любым способом, например с помощью gparted. Допустим имя раздела /dev/sdb1</li>
<li>Форматируем раздел: <code>cryptsetup luksFormat /dev/sdb1</code></li>
<li>Подключаем luks: <code>cryptsetup luksOpen /dev/sdb1 sdb1</code> (последний параметр это произвольное имя в /dev/mapper/)</li>
<li>Форматируем luks в любимую fs: <code>mkfs.ext4 /dev/mapper/sdb1</code></li>
<li>Монтируем: <code>mkdir /mnt/luks ; mount /dev/mapper/sdb1 /mnt/luks</code></li>
</ol>
<p>Теперь вы можете копировать в /mnt/luks нужные вам файлы</p>
<h3>Разбираем в обратном порядке</h3>
<ol>
<li>Размонтируем: <code>umount /mnt/luks</code></li>
<li>Отключаем: <code>cryptsetup luksClose sdb1</code></li>
</ol>
<p>Большинство из этих команд будет требовать пароль, это тот пароль который вы назначите при форматировании раздела с cryptsetup luksFormat</p>
<h3>Примеры подключения</h3>
<ul>
<li><code>uird.mounts=LUKS@/</code>  - подключение раздела luks если такой у вас один, основано на том что тип раздела TYPE="crypto_LUKS"</li>
<li><code>uird.from=/dev/sdb1/MagOS</code> - если /dev/sdb1 это luks у вас спросят пароль</li>
</ul>
<h3>Ключи и пароли</h3>
<p>У вас есть возможность настроить загрузку с luks без ввода пароля. Например для загрузки на "доверенной" машине.
Далее приводятся примеры как это можно организовать, но насколько это безопасно решать вам.</p>
<ul>
<li><code>uird.mounts=LUKS@/::PASS=123qwe</code>  - пароль открытым текстом</li>
<li><code>uird.from=LUKS@/::KEY=/secret.key</code> - uird проведет поиск файла secret.key на всех доступных носителях и если найдет подключит с ипользованием файла в качестве ключа (Сперва поиск будет проведен внутри uird, то есть ключ может быть внедрен в uird при его сборке).</li>
<li><code>uird.home=LUKS@/::PASS=//hardware//</code> - здесь //hardware// имеет специальное значение - подключение luks с паролем сгенерированным на основе характеристик железа. Для того чтоб это сработало вам нужно добавить такой пароль в один из слотов luks (всего их 8). Пароль нужно сгенерировать на целевой машине командой:</li>
</ul>
<p><code>busybox lspci |md5sum |cut -f1 -d ' '</code></p>
<hr><a name="Параметры-загрузки"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Параметры загрузки</h1>
<p>Параметры могут быть поделены на несколько групп:</p>
<ul>
<li>параметры ядра <a href="https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.html">Linux</a></li>
<li>параметры скриптов <a href="https://github.com/neobht/uird">UIRD</a> или <a href="http://www.slax.org">linux-live.org</a></li>
<li>собственные параметры MagOS</li>
</ul>
<p><em>Параметры могут быть введены с клавиатуры в строке параметров загрузки на первом экране выбора режима загрузки MagOS. При использовании загрузчика grub4dos в текстовом режиме можно отредактировать секцию загрузки с помощью кнопки <strong>E</strong> и далее произвести загрузку клавишей <strong>B</strong>. При использовании syslinux правка параметров осуществляется клавишей <strong>Tab</strong>, загрузка клавишей <strong>Enter</strong>. Параметры, переданные таким образом, работают однократно. Для постоянного применения параметра его нужно добавить в файл настройки загрузчика /boot/grub4dos/local/menu.lst</em></p>
<h3>Примеры параметров ядра</h3>
<ul>
<li>
<p><strong>quiet</strong> - отключить вывод в консоль процесса загрузки. Так называемый «тихий режим».</p>
</li>
<li>
<p><strong>vga=x</strong>, где x соответствует видеорежиму консоли. 791 соответствует 1024×768, 788 - 800×600, 0 - текстовый режим. ask - выбор варианта. Данный параметр не влияет на разрешение графического сервера (КДЕ, Гнома, LXDE)</p>
</li>
<li>
<p><strong>noapic nolapic</strong>, без параметров. Отключают контроллер прерываний APIC. На некотором железе глючные драйверы или глючное железо может приводить к полному зависанию системы в случайный момент времени. В этом случае помогает этот параметр.</p>
</li>
<li>
<p><strong>acpi=off</strong> - отключение системы управления питанием acpi. Используется для устранения проблем с оборудованием.</p>
</li>
<li>
<p><strong>vmalloc=x</strong> - позволяет задать размер виртуальной памяти для ядра. Рекомендуется при использовании большого количества модулей увеличить размер по умолчанию (128Мб) до 256Мб или 512Мб.Пример:</p>
<p>vmalloc=256M</p>
</li>
<li>
<p><strong>nopti</strong> - отключает систему изоляции памяти ядра, введённую в связи с уязвимостью Meltdown. Пользователи процессоров AMD могут отключить эту систему, чтобы не допустить потерю производительности.</p>
</li>
</ul>
<h3>Собственные параметры MagOS</h3>
<ul>
<li>
<p><strong>xdriver=x</strong>, - принудительный выбор драйвера графического сервера. Драйвер vesa или fbdev может использоваться для всех видеокарт, поддерживающих режим framebuffer. Пример:</p>
<p>xdriver=fbdev - универсальный драйвер для любой видекарты, не поддерживает 3D (используйте в случае если на Вашу карту драйверы отсутствуют или не работают как нужно)<br>
  xdriver=nvidia515 (в 2016 сборке nvidia-current) - eсли система не смогла автоматически определить драйвер для вашей современной Nvidia карты<br>
  xdriver=nvidia390 (в 2016 сборке nvidia304) - используйте, если у вас старая видеокарта Nvidia и система не смогла автоматически определить драйвер для вашей карты<br>
  xdriver=nouveau - свободный драйвер для видеокарт nvidia, поддерживает большинство карт, поддержка 3D ускорения реализована частично<br>
  xdriver=intel - используйте, если система не смогла автоматически определить драйвер для вашей Intel карты<br>
  xdriver=ati - для AMD/ATI Radeon карт<br>
  xdriver=vesa - старый framebuffer драйвер, сейчас почти не применяется, но иногда помогает со встроенными в процессор видеокартами Intel, где нормальный драйвер не работает</p>
</li>
<li>
<p><strong>3ddesktop</strong>, без параметров. Включает 3d эффекты рабочего стола (compiz). Эффекты включаются принудительно, даже если не поддерживает видеокарта, при включении на видеокартах отличных от intel/ati/nvidia может привести к неработоспособности графической среды.</p>
</li>
<li>
<p><strong>no3ddesktop</strong>, без параметров, отключает 3d эффекты рабочего стола.</p>
</li>
<li>
<p><strong>desktop=x</strong>, - позволяет выбрать графическую среду для загрузки.  Параметр none отключает загрузку графического сервера. Параметров может быть несколько, в таком случае они разделяются запятой, причем менеджер входа должен стоять после среды, иначе среда переопределит его на свой стандартный менеджер входа. Примеры:</p>
<p>desktop=steam,slim - загрузить среду Steam, использовать менеджер входа Slim  <br>
  desktop=lxqt,sddm,3d - загрузить среду LXQT, использовать менеджер входа sddm, включить эффекты.</p>
<ul>
<li>Менеджеры входа: slim, kdm (2014* сборки) sddm (2016 сборка). </li>
<li>Графические среды: none, steam, lxde (2014<em>), lxqt (2016), kdm (2014</em>), plasma (2016). </li>
<li>Можно указать также параметры 3d и no3d, соответственно для включения и выключения эффектов. </li>
</ul>
</li>
<li>
<p><strong>findswap</strong> - найти и использовать swap раздел или файл. Если отсутствует специальный swap раздел, будет найден и использован swap файл от Windows. Данный параметр необходим при работе с малым объёмом памяти.</p>
</li>
<li>
<p><strong>savelist</strong> - при сохранении в модуль xzm (параметры changes=xzm) возможно указание определённых путей для сохранения. Все остальные файлы не сохраняются. Пути могут быть заданы в виде шаблонов команды grep. Также можно задавать исключения в виде шаблонов с помощью символа »!», если он указан в начале. После загрузки внести изменения в список можно через файл /.savelist Пример:</p>
<p>savelist=/home/,ifcfg-eth - сохранять домашние папки пользователей, настройки сетевых интерфейсов</p>
</li>
<li>
<p><strong>users</strong> - автоматически создать пользователей, если ранее они не были созданы, либо если вы хотите сменить пользователя по умолчанию. В качестве пароля допустимо либо поставить символ маленькой латинской буквы икс «x», что соответствует паролю по умолчанию, либо можно передать хеш пароля из /etc/shadow. Пример:</p>
<p>users=master:500:x,guest:501 - будут созданы пользователи master (с номером 500) с паролем по умолчанию и guest (501) без пароля. </p>
</li>
<li>
<p><strong>autologin=x</strong> - задаёт пользователя для автовхода. Примеры:</p>
<p>autologin=master   - войти в систему под пользователем master<br>
  autologin=none   - отключает автовход</p>
</li>
<li>
<p><strong>xres=XxY</strong> - установка конкретного разрешения для графического сервера. Пример:</p>
<p>xres=1024x768 - установка разрешения 1024 на 768 точек.</p>
</li>
<li>
<p><strong>quickshell</strong> или <strong>qs</strong> - режим быстрой загрузки в UIRD/initrd. В этом режиме загрузка останавливается на уровне initrd, вы получаете командую строку с утилитами bash, простой файловый менеджер bash, простой текстовый редактор vi. После выхода из режима, загрузка MagOS будет продолжена. Этот режим удобен для быстрой правки ini файла система, удаления и перемещения сбойных модулей и других изменений системы «на лету».</p>
</li>
<li>
<p><strong>theme=x</strong> - Выбор темы оформления графической среды. Может быть равной одному значению из MagOS MagOS-green MagOS-dark MagOS-grey <em>(MagOS-grey несовместима со сборками 2014*)</em></p>
</li>
<li>
<p><strong>flightmode</strong> - при указании этого параметра программно отключаются все устройства беспроводной связи</p>
</li>
</ul>
<h3>Параметры скриптов linux-live.org (с модификациями)</h3>
<p><strong>По умолчанию initrd более не применяется</strong>, но если, по каким-либо причинам, вы не можете использовать UIRD, то можно переключиться на initrd и использовать его параметры загрузки</p>
<ul>
<li>
<p><strong>debug</strong> - включает режим отладки</p>
</li>
<li>
<p><strong>nocd</strong>, <strong>nohd</strong> - позволяет игнорировать при поиске профиля, домашней директории и репозиториев CD-Rom-ы и HDD-диски соответственно.</p>
</li>
<li>
<p><strong>sgnfile=x</strong> - позволяет установить маркер базовой папки. Применяется для однозначного задания откуда загружать систему, например, когда MagOS установлена на нескольких носителях одновременно. Пример:</p>
<p>sgnfile=MagOS_flash.sgn</p>
</li>
<li>
<p><strong>sgndatafile=x</strong> - позволяет установить маркер папки MagOS-Data. Применяется если используется несколько локальных хранилищ пользовательских данных. Значение параметра «no» позволяет отключить поиск MagOS-Data. Пример:</p>
<p>sgndatafile=MagOS_data_20102.sgn
  sgndatafile=no</p>
</li>
<li>
<p><strong>toram</strong> (<strong>copy2ram</strong>) - позволяет при загрузке скопировать операционную систему в память (что несколько замедляет процесс загрузки) и освободить носитель. Приводит к ускорению работы системы, уменьшению износа flash-памяти. Требует наличия от 2Г памяти. Может быть использован с параметрами, тогда в память загружаются не все модули, а только указанные. Пример:</p>
<p>copy2ram=/0<em>,/1</em>,/2<em> - загружаются в память модули, имеющие в названии 0</em> (<em>-любое количество произвольных символов),1</em>,2* </p>
</li>
<li>
<p><strong>freemedia</strong> - при использовании режима toram и не использования параметра changes носитель будет отключен от папки /mnt/livemedia и может быть извлечён.</p>
</li>
<li>
<p><strong>changes=x</strong>, где x - файл или каталог для хранения данных. В случае использования файла он должен быть заранее отформатирован и иметь расширение .img. Возможно указание заранее созданного криптоконтейнера с алгоритмом AES256. Криптоконтейнер должен иметь расширение .enc. Возможно указать сохранение данных в xzm модуль. При этом данные при загрузки распаковываются из модуля в память, при выключении системы происходит упаковка (если доступен носитель). Примеры:</p>
<p>changes=changes - используется папка MagOS-Data/changes (не для fat/ntfs)<br>
  changes=/MagOS-Data/MagOS_save1.img<br>
  changes=/MagOS-Data/MagOS.enc    - заранее созданный криптоконтейнер.<br>
  changes=/dev/sda1/profiles/profile_512.img    - профиль-файл на устройстве /dev/sda1 в файле /profiles/profile_512.img<br>
  changes=/dev/sda1/profiles/profile1  - профиль-папка /profiles/profile1 на устройстве /dev/sda1<br>
  changes=/profiles/profile1    - профиль-папка /profiles/profile1 ищется по всем устройствам и разделам<br>
  changes=/MagOS-Data/save.xzm    - заранее созданный пустой модуль xzm (для сборок выше 2011).<br>
  changes=xzm - изменения записываются в MagOS-Data/machines/dynamic/mac-xxxxxx.xzm, модуль уникальный для каждой машины. Модуль заранее создавать не нужно. При каждом выключении модуль обновляется, если переместить модуль в MagOS-Data/machines/static, то изменения для данной машины будут заморожены (для сборок от 201212 и выше).</p>
</li>
<li>
<p><strong>ramsize=x</strong>, где x - проценты или количество памяти, используемой для корневой файловой системы в памяти, если не используется changes=. При наличии swap вы можете указать размер ramsize превышающий размер оперативной памяти, и корневая файловая система будет увеличиваться в swap по мере заполнения ram. Это может понадобиться например при распаковке больших ахивов, конвертировании видео и прочих действий активно использующих /tmp. Примеры:</p>
<p>ramsize=80%<br>
  ramsize=200% Рам диск вдвое больше размера оперативной памяти.  </p>
</li>
<li>
<p><strong>load=x</strong>, где x - перечень необязательных модулей из MagOS/optional, которые должны быть загружены. Пример:</p>
<p>load=my_modules,my_favorite_module.xzm</p>
</li>
<li>
<p><strong>noload=x</strong>, где x - перечень обязательных модулей из MagOS/base и MagOS/modules, которые не нужно загружать. Примеры:</p>
<p>noload=/4?-*,kde,gnome  - не загружаются модули содержащие в названии 4?- (?-любой произвольный символ, т.е. 41-, 4d-, 42-,4g- и т.д.), а также kde, gnome<br>
  noload=/modules/ - не загружаются модули из папки modules</p>
</li>
<li>
<p><strong>from=x</strong> - ручное указание места, где лежит система. Параметр нужен в случае необходимости отключения автопоиска носителя и для загрузки по сети. Путь в этом параметре должен указывать до папки MagOS. Т.е. вам нужно на сервере открыть доступ не к /mnt/livemedia/MagOS а к папке /mnt/livemedia/, содержащей в себе MagOS. Поддерживаемые web-сервера: apache, lighthttpd. В случае использования FTP сервера возможно указать параметр <strong>netfsoptions=</strong>, в котором указать дополнительные  параметры подключения FTP ресурса. Подробнее о возможных значениях ключа netfsoptions смотрите в выводе команды curlftpfs --help. Примеры:</p>
<p>from=/dev/sda1<br>
  from=/dev/sda1/distribs<br>
  from=/dev/sda1/distribs/MagOS.iso<br>
  from=nfs://192.168.1.31:/mnt/livemedia - позволяет загрузить систему с NFS сервера<br>
  from=http://192.168.1.31:80/mnt/livemedia  - позволяет загрузить систему по HTTP с web-сервера<br>
  from=http://magos-linux.ru:8080/downloader/<br>
  from=ftp://magos.sibsau.ru/repository/netlive/2011/ - позволяет загрузить систему с FTP сервера.  </p>
</li>
<li>
<p><strong>repository=x</strong>, где x - URI ( локальный путь, http, nfs) до папки или блочного устройства - задаёт репозиторий хранения дополнительных модулей. Если не задано, то устанавливается значение MagOS-Data. Структура репозитория должна быть аналогичной: repository/{base,modules,optional}. Примеры:</p>
<p>repository=/repos - осуществляется поиск на всех устройствах /repos и подключение первого найденного.<br>
  repository=http://magos-linux.ru:8080/repository<br>
  repository=nfs://192.168.1.17:/modules/main.loop<br>
  repository=ftp://http://magos.sibsau.ru/repository/modules/2011  </p>
</li>
<li>
<p><strong>home=x</strong> , где x - URI ( локальный путь, nfs) до папки или блочного устройства - задаёт расположение домашних папок пользователей. В случае использования файла он должен быть заранее отформатирован и иметь расширение .img. Возможно указание заранее созданного криптоконтейнера с алгоритмом AES256. Криптоконтейнер должен иметь расширение .enc. Примеры:</p>
<p>home=homes - используется папка MagOS-Data/homes<br>
  home=/MagOS-Data/home/ - осуществляется поиск на всех устройствах /MagOS-Data/home/ и подключение первого найденного.<br>
  home=/MagOS-Data/home.img - домашний каталог в файле /MagOS-Data/home.img<br>
  home=nfs://magos-linux.ru:/home/n/e/neikin - домашний каталог на сервере NFS  в каталоге /home/n/e/neikin
  home=/dev/sdb1/home/neikin.img - домашний каталог на устройстве /dev/sdb1 в файле /home/neikin.img  </p>
</li>
<li>
<p><strong>config=x</strong> , где x - относительно базовой папки (/MagOS-Data или /MagOS) URI - задаёт расположение файла настроек (значение по умолчанию - MagOS.ini ). Пример:</p>
<p>config=configs/MagOS_work.ini  - задает размещение файла настроек в /MagOS-Data/configs/MagOS_work.ini, либо /MagOS/configs/MagOS_work.ini если первый вариант не найден</p>
</li>
<li>
<p><strong>local_rep=x</strong>, где x - URI ( локальный путь) до папки или блочного устройства - задаёт локальный репозиторий хранения дополнительных модулей. Структура репозитория должна быть аналогичной: local_repository/{base,modules,optional}. Примеры:</p>
<p>local_rep=/repos - осуществляется поиск на всех устройствах /repos и подключение первого найденного.<br>
  local_rep=/rep/main.loop<br>
  local_rep=/dev/sda1/rep  </p>
</li>
<li>
<p><strong>copy2rep</strong> - позволяет при загрузке скопировать модули в локальный репозиторий (при указании параметра local_rep=) или в профиль. Может быть использован с параметрами, тогда копируются не все модули, а только указанные. Пример:</p>
<p>copy2rep=updates<em> - модули, имеющие в названии updates</em> (*-любое количество произвольных символов)</p>
</li>
<li>
<p><strong>unionfs</strong> - позволяет при загрузке использовать unionfs вместо aufs.</p>
</li>
<li>
<p><strong>fsck</strong> - проверка и исправление ошибок на файловых системах если они подключаются на этапе загрузки системы. Поддерживаются ext2-4, reiserfs, vfat, ntfs. Также производится обработка контейнеров (файлы .img) и криптоконтейнеров (.enc)</p>
</li>
</ul>
<h3>Параметры загрузчика UIRD</h3>
<p>В MagOS-Linux вместо системы initrd на базе скриптов linux-live.org применяется мощный унифицированный загрузчик UIRD, который, выполняя все те же функции, что и initrd, дополнительно предоставляет возможности, которых нет в других системах загрузки. Описание загрузчика UIRD и его параметров расположено на странице проекта в <a href="https://github.com/neobht/uird">GIT</a>.</p>
<hr><a name="UIRD"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>UIRD</h1>
<h1>UIRD - Unified Init Ram Disk system</h1>
<p>Унифицированная система инициализации для модульных Linux систем. </p>
<p><a href="https://gitter.im/uird/discussion"><img alt="Join the chat at https://gitter.im/uird/discussion" src="https://badges.gitter.im/uird/Lobby.svg"></a></p>
<h2>Базовое описание основных принципов</h2>
<p><strong>UIRD</strong> - это разновидность <em>initrd</em>, его задача собрать из слоёв <em>aufs/overlayfs</em> корневую файловую систему и передать загрузку <code>/sbin/init (systemd)</code> с этой корневой файловой системой.
В основе реализации <em>UIRD</em> лежит набор скриптов инициализации <em>dracut</em> (модули <em>base, kernel-modules</em>),
сценарий инициализации <em>uird-init</em> и библиотека функций к нему <em>livekitlib</em> (доработанный аналог <em>liblinuxlive, livekitlib</em> проекта <em>Slax</em>). </p>
<h2>Основные отличия от реализаций <em>initrd</em> для модульных систем схожих проектов.</h2>
<pre><code>* Отсутствие привязки к конкретному дистрибутиву
* Отсутствие привязки к конкретным каталогам для поиска источников
* Возможность подключения практически любых источников, которые можно смонтировать в linux 
* Поддержка различных сетевых протоколов для загрузки по сети
* Адаптация UIRD под вашу ОС сводится к написанию одного конфигурационного файла
</code></pre>
<h1>Параметры командной строки</h1>
<h3>Ввиду множественности параметров ядра введен префикс параметров '<em>uird</em>'  (<em>Unified Init Ram Disk</em>):</h3>
<pre><code>* uird.параметр=значение - установить новое значение, которое заменит значение по умолчанию;
* uird.параметр+=значение - добавить значение к списку значений по умолчанию
</code></pre>
<h3>В настоящий момент параметров более двух десятков, большинство из них лишь расширяют базовый функционал дополнительными возможностями.</h3>
<h2>Основные параметры</h2>
<pre><code>* uird.ro[+]=                - фильтр для модулей/директорий, которые монтируются в режиме RO
* uird.rw[+]=                - фильтр для модулей/директорий, которые монтируются в режиме RW
* uird.cp[+]=                - фильтр для модулей/директорий, содержимое которых копируется в корень
* uird.copy2ram[+]=          - фильтр для модулей/директорий, которые копируются в RAM
* uird.load[+]=              - фильтр для модулей/директорий, которые необходимо подключить на этапе загрузки
* uird.noload[+]=            - фильтр для модулей/директорий, которые необходимо пропустить во время загрузки
* uird.from[+]=              - источники, где лежат модули/директории для системы
* uird.home=                 - источник, где хранятся домашние директории пользователей
* uird.changes=              - источник, где хранить персистентные изменения
* uird.mode=MODE             - режим работы сохранениями (clean, clear, changes, machines)
</code></pre>
<h2>Параметры для более сложных конфигураций</h2>
<pre><code>* uird.cache[+]=             - источники, в которые стоит синхронизировать модули/директории
* uird.copy2cache[+]=        - фильтр для модулей/директорий, которые копируются в КЭШ
* uird.homes[+]=             - источники, где хранятся домашние директории пользователей (объединяются AUFS / OVERLAYFS)
* uird.mounts=               - источники , которые будут смонтированы в указанные точки монтирования
* uird.find_params[+]=       - параметры для утилиты find при поиске модулей (например: -maxdepth,2)
* uird.help                  - печатает подсказку по параметрам UIRD
* uird.break=STAGE           - остановка загрузки на стадии STAGE и включение режима отладки (debug)
* uird.scan=                 - поиск установленных OC и компонентов для определения параметров uird
* uird.swap=                 - список SWAP разделов и/или файлов для подключения, разделитель в списке ";" или ","
* uird.syscp[+]=             - список файлов (каталогов) для копирования из UIRD в систему /путь/файл::/путь/каталог
* uird.basecfg=              - расположение базового конфигурационного файла basecfg.ini
* uird.config=               - расположение конфигурационного файла системы MagOS.ini
* uird.sgnfiles[+]=          - перечисление файлов-маркеров для поиска источников указанных в uird.from= в соответсвии с их порядком перечисления
* uird.ip=                   - IP:GW:MASK, если не указан, то используется DHCP
* uird.netfsopt[+]=          - дополнительные опции монтирования сетевых ФС: sshfs,nfs,curlftpfs,cifs
* uird.aria2ram=             - список источников, которые нужно скопировать из сети в RAM до начала поиска uird.from
* uird.freemedia             - освободить (размонтировать) источники, используется совместно с uird.copy2ram
* uird.force                 - продолжать загрузку, не задавая вопросов, если источник не найден
* uird.run[+]=               - запуск внешних исполняемых файлов
* uird.rootfs                - размер и тип roots (tmpfs/zram)
* uird.union=overlay         - использовать overlayfs вместо aufs
* uird.shutdown              - создать каталог /run/initramfs, который использует systemd при выключении системы, передавая туда управление
* uird.preinit               - включить обработку ini файла, заданного в uird.config
* uird.hide                  - включить режим сокрытия точки монтирования MEMORY (полезно для режима kiosk)
* quickshell, qs             - консоль на начальном этапе работы uird-init
* qse                        - консоль в конце работы uird-init
* debug                      - подробный вывод и приостановка uird-init на нескольких этапах работы
</code></pre>
<h3>В качестве значений параметров могут быть использованы команды <em>shell</em>:</h3>
<pre><code>* uird.from="/MagOS;$( eval [ $(date +%u) -gt 5 ] &amp;&amp; echo /MagOS-Data)" - подключать MagOS-Data только по выходным
* uird.changes="$(mkdir -p /MagOS-Data/changes &amp;&amp; echo /MagOS-Data/changes)"
* $(udhcpc)  - поднять сеть (eth0 dhcp)
</code></pre>
<p>Для более подробного описания параметров смотрите встроенную <a href="https://github.com/neobht/uird/tree/master/initrd/usr/share/uird.help">подсказку</a></p>
<h2>Типы источников</h2>
<pre><code>/path/dir                 - директория на любом доступном носителе
/dev/[..]/path/dir        - директория на заданном носителе
LABEL@/path/dir           - директория на носителе с меткой LABEL
UUID@/path/dir            - директория на носителе с uuid UUID
file-dvd.iso, file.img    - образ диска (ISO, образ блочного устройства, VDI, VHDD и др.)
http://server/path/...    - источник, доступный по HTTP (используется httpfs) 
ssh://server/path/...     - источник, доступный по SSH (используется sshfs)
ftp://server/path/...     - источник, доступный по FTP (используется curlftpfs)
nfs://server/path/...     - источник, доступный по NFS 
cifs://server/path/...    - источник, доступный по CIFS
</code></pre>
<h2>Порядок инициализации системы</h2>
<p><em>Упрощенная схема, не учитывающая параметры <code>uird.cache, uird.mounts, uird.homes</code> и проч.</em>
<em>Более подробную информацию ищите во встроенной справке по конкретным параметрам.</em></p>
<ol>
<li>Осуществляется поиск конфигурационного файла по пути, указанному в параметре <code>uird.basecfg=</code> (дефолтное значение задаётся при сборке <em>uird</em>)</li>
<li>Устанавливаются параметры из конфигурационного файла, которые ещё не установлены в параметрах ядра</li>
<li>Происходит монтирование источников <strong>base</strong>-уровня в порядке, указанном в параметре <code>uird.from=</code></li>
<li>Происходит монтирование источников <strong>home</strong>-уровня, согласно параметру <code>uird.home=</code> </li>
<li>Происходит подключение в самый <em>верхний</em> уровень <em>AUFS</em> источника персистентных изменений, указанного в параметрами <code>uird.changes=, uird.mode=</code></li>
<li>Осуществляется синхронизация base уровня в ОЗУ с учётом параметра <code>uird.copy2ram=</code></li>
<li>Осуществляется поиск модулей/директорий в ОЗУ и base-уровне и подключение их на <em>[верхний-1]</em> уровень <em>AUFS</em> или копирование в корень (с учётом фильтров, указанных в параметрах <code>uird.load=, uird.noload=,uird.ro=,uird.rw=,uird.cp=</code>) со следующим приоритетом:<pre><code>                   uird.load --&gt; uird.noload
                   uird.cp --&gt; uird.rw --&gt; uird.ro
</code></pre>
<ol>
<li>Выполняются скрипты <em>rc.preinit</em></li>
</ol>
</li>
</ol>
<h2>Структура системной директории</h2>
<pre><code>  /memory/
  ├── bundles                   - точка монтирования модулей
  │   ├── 00-kernel.xzm
  │   ├── 01-firmware.xzm
  │   ├── 10-core.xzm
  │   ├── 80-eepm-1.5.2.xzm
  │   └── ...                   - и т.д.
  ├── changes                   - точка монтирования для хранения изменений
  │   ├── etc
  │   ├── home
  │   ├── memory
  │   ├── run
  │   ├── var
  │   └── ...                   - и т.д.
  ├── data                      - точка монтирования источников
  │   ├── cache                     - кеш уровня
  │   ├── homes                     - homes уровня
  │   ├── mounts                    - mounts уровня
  │   ├── machines                  - машинно-зависимых изменений
  │   └── from                      - базового уровня
  ├── copy2ram                  - точка монтирования для синхронизации модулей/директорий в ОЗУ
  ├── ovl                       - точка монтирования вспомогательных каталогов OverlayFS
  │   ├── lowerdir                  - lowerdir
  │   └── workdir                   - workdir
  ├── layer-base                - точка монтирования базового уровня
  │   ├── 0                         - ресурс первого источника
  │   ├── 1                         - ресурс второго источника (в порядке перечисления в uird.from=)
  │   └── ...                       - и т.д.
  ├── layer-cache               - точка монтирования кеш уровня
  │   ├── 0                         - ресурс первого источника
  │   ├── 1                         - ресурс второго источника (в порядке перечисления в uird.cache=)
  │   └── ...                       - и т.д.
  ├── layer-homes               - точка монтирования homes уровня
  │   ├── 0                         - ресурс первого источника
  │   ├── 1                         - ресурс второго источника (в порядке перечисления в uird.homes=)
  │   └── ...                       - и т.д.
  ├── layer-mounts              - точка монтирования mounts уровня
  │   ├── 0                         - ресурс первого источника
  │   ├── 1                         - ресурс второго источника (в порядке перечисления в uird.mounts=)
  │   └── ...                       - и т.д.
  ├── cmdline                   - системный файл для хранения дополнительных параметров командной строки
  └── MagOS.ini.gz              - системный файл для хранения конфигурационного файла
</code></pre>
<h2>Пример конфигурационного файла MagOS (используется при сборке UIRD для MagOS-linux)</h2>
<pre><code>  uird.config=MagOS.ini
  uird.ramsize=70%
  uird.ro=*.xzm;*.rom;*.rom.enc;*.pfs
  uird.rw=*.rwm;*.rwm.enc
  uird.cp=*.xzm.cp,*/rootcopy
  uird.load=/base/,/modules/,rootcopy
  uird.noload=/MagOS-Data/changes,/MagOS-Data/homes
  uird.from=/MagOS;/MagOS-Data
  uird.find_params=-maxdepth_3
  uird.mode=clean
  uird.changes=/MagOS-Data/changes
  uird.syscp=/livekitlib::/usr/lib/magos/scripts;/uird.scan::/usr/lib/magos/scripts;/liblinuxlive::/mnt/live/liblinuxlive
</code></pre>
<p>Расширения поддерживаемые в MagOS Linux с этим конфигом:</p>
<pre><code>*.ROM - RO слой
*.RWM - RW слой
*.XZM - RO слой с squashfs
*.XZM.CP - распаковывается в корень системы
*.RWM.ENC - RW слой криптованый
*.ROM.ENC - RO слой криптованый
</code></pre>
<p>Другие примеры конфигурационных файлов смотрите <a href="https://github.com/neobht/uird/tree/master/configs/uird_configs">тут</a></p>
<h3>Реализация</h3>
<p>В основе реализации лежит набор скриптов инициализации <a href="https://cdn.kernel.org/pub/linux/utils/boot/dracut/dracut.html">dracut</a> (модули base, kernel-modules ) и скрипты uird (livekitlib+uird-init).</p>
<pre><code>cmdline-hook: parse-root-uird.sh (заглушка)
mount-hook: mount-uird.sh (выполняет скрипт uird-init)
</code></pre>
<ul>
<li><a href="https://github.com/neobht/uird/blob/master/modules.d/00uird/livekit/livekitlib">livekitlib</a> - содержит библиотеку функций системы инициализации.</li>
<li><a href="https://github.com/neobht/uird/blob/master/modules.d/00uird/livekit/uird-init">uird-init</a> - последовательно выполняет набор функций из livekitlib и осуществляет каскадно-блочное монтирование модулей системы в единый корень AUFS в директорию, указанную в переменной dracut $NEWROOT.</li>
</ul>
<h3>Установка и сборка</h3>
<p>Смотрите описание процесса: <a href="https://github.com/neobht/uird/blob/master/UIRD_BUILD.md">uird_build.md</a></p>
<hr><a name="Структура"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Структура</h1>
<h2>Файловая структура сборки кратко</h2>
<h3>Состав сборки</h3>
<ul>
<li><strong>boot</strong> - каталог, в котором хранятся загрузчики и скрипты установки, при обновлении не изменяется. Располагается на загрузочном разделе.</li>
<li><strong>EFI</strong> - версия загрузчика grub, модифицированная для загрузки в UEFI режиме. Только для EFI режима., при обновлении не изменяется. Только для загрузочных fat разделов.</li>
<li><strong>MagOS</strong> - основной каталог системы, при обновлении полностью переписывается. Может быть на том же разделе, что и boot, а может и на другом.</li>
<li><strong>MagOS-Data</strong> - папка с настройками и модулями пользователя, при обновлении не изменяется. Желательно располагать на линуксовой файловой системе, тогда можно будет установить Steam и хранить системные и пользовательские изменения в папках, а не в ограниченном по размеру профиле.</li>
</ul>
<h3>Файлы настроек</h3>
<ul>
<li><strong>boot/grub4dos/local/menu.lst</strong> - файл настроек загрузчика</li>
<li><strong>boot/grub4dos/menu.lst</strong> - файл настроек загрузчика для английского языка, используется только, если не найден boot/grub4dos/local/menu.lst, либо при выборе строки English</li>
<li><strong>MagOS-Data/MagOS.ini</strong> - файл для изменения конфигурационных файлов системы. Возможно добавление и удаление строк, создание файлов, изменение параметров файлов настроек. Описание и шаблоны см. в самом файле.</li>
</ul>
<h3>Файлы меток</h3>
<p>По файлам-меткам производится поиск и подключение источников. В случае использования своих меток, нужно в файле настроек загрузчика передать параметр <em>uird.sgnfiles=MagOS.sgn.sgn;MagOS-Data.sgn</em></p>
<ul>
<li><strong>MagOS/MagOS.sgn</strong> - метка для папки MagOS</li>
<li><strong>MagOS-Data/MagOS-Data.sgn</strong> - метка для папки MagOS-Data</li>
</ul>
<h3>Скрипты установки</h3>
<ul>
<li><strong>boot/magos/Install.bat</strong> - основной универсальный скрипт, работающий в Linux и Windows.</li>
<li><strong>boot/magos/linux</strong> - дополнительные скрипты для Linux</li>
<li><strong>boot/magos/windows</strong> - дополнительные скрипты для Windows</li>
</ul>
<p>Описание скриптов смотрите в разделе <a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">Установка</a></p>
<h3>Полезные папки для хранения данных пользователя</h3>
<ul>
<li><strong>MagOS-Data/backgrounds</strong> - обои для рабочего стола и хранителя экрана, можете заменить файлы на свою коллекцию</li>
<li><strong>MagOS-Data/modules</strong> - каталог для пользовательских модулей, загружаемых автоматически</li>
<li><strong>MagOS-Data/optional</strong> - каталог для доп. модулей, загружаемых с помощью параметров <em>uird.load+= load=</em></li>
<li><strong>MagOS-Data/machines</strong> - каталог для сохранения системных настроек в виде модуля, привязанного к MAC адресу</li>
<li><strong>MagOS-Data/machines/dynamic</strong> - по умолчанию здесь ищется модуль машины при загрузке и сюда же сохраняется при выключении. </li>
<li><strong>MagOS-Data/machines/static</strong> - если модуль машины перенесён сюда (можно переносить модуль, даже если вы загружены с ним), то он "замораживается", читается при старте, но не сохраняется при выключении.</li>
<li><strong>MagOS-Data/homes</strong> - папка, в которую можно сохранять данные пользователя, вместо ограниченного по размеру home.img. Только, если MagOS-Data лежит не на fat/ntfs. Используйте параметры загрузки <em>uird.home=homes</em></li>
<li><strong>MagOS-Data/changes</strong> - папка, в которую можно сохранять данные системы, если MagOS-Data лежит на линуксовой ФС. Используйте <em>uird.changes=changes</em>, уберите параметр <em>uird.mode=machines</em></li>
<li><strong>MagOS-Data/steam</strong> - папка для установки клиента <em>Steam</em> (только для линуксовых ФС, не для fat/ntfs)</li>
</ul>
<h2>Файловая структура сборки подробно</h2>
<p><strong>/boot</strong> - каталог, в котором хранятся загрузчики и скрипты установки, при обновлении не изменяется</p>
<pre><code>  ├── /magos - папка со скриптами установки
  │  ├── Install.bat - универсальный скрипт, который можно запускать под Linux и Windows, автоматически выбирает нужный скрипт установки
  │  ├── /linux - папка со скриптами для Linux
  │  │  ├── bootinst.sh - основной скрипт установки
  │  │  ├── make_iso.sh - скрипт создания iso образа
  │  │  ├── make_boot_iso.sh - скрипт создания загрузочного мини-образа
  │  │  └── ru_RU.UTF-8 - поддержка русского языка для скриптов. Если удалить файл, сообщения будут на английском
  │  └── /windows - папка со скриптами для Windows
  │     ├── bootinst.bat - основной скрипт установки
  │     ├── add2bcd.bat - добавление загрузчика к стандартному загрузчику Windows Vista/7-10
  │     ├── add2ntld.bat - добавление загрузчика к стандартному загрузчику Windows XP
  │     ├── make_iso.bat - скрипт создания iso образа
  │     ├── make_boot_iso.bat - скрипт создания загрузочного мини-образа
  │     └── ru.nls  - поддержка русского языка для скриптов. Если удалить файл, сообщения будут на английском
  ├── /grub4dos/ - файлы основного загрузчика grub4dos, применяется для взаимодействия с пользователем и загрузки системы и утилит
  │   ├── gfxmenu - графическая тема (en) с параметрами загрузки, в разных сборках отличается
  │   ├── menu.lst - основной файл загрузчика (en)
  │   ├── menu-add.lst - дополнительное меню (ru)
  │   └── /local - каталог с русскими файлами настроек, если его удалить, будет только английский вариант
  │      ├── gfxmenu - графическая тема (ru) с параметрами загрузки, в разных сборках отличается
  │      ├── menu.lst - основной файл загрузчика (ru)
  │      └── menu-add.lst - дополнительное меню (ru)
  ├── /syslinux/ - файлы загрузчика syslinux, по умолчанию используется только для загрузки grub4dos
  │   ├── syslinux_gpt.exe - исполняемый файл для установки в Windows загрузчика на диски GPT в ручном режиме
  │   ├── gfxmenu - графическая тема (en) с параметрами загрузки, в разных сборках отличается
  │   ├── syslinux.cfg - основной файл настройки для загрузки grub4dos
  │   ├── menu.cfg - меню для syslinux (en), в случае если grub4dos не применяется
  │   └── /local
  │      ├── gfxmenu - графическая тема (ru) с параметрами загрузки, в разных сборках отличается
  │      └── menu.cfg - меню для syslinux (en), в случае если grub4dos не применяется
  └── /grub - файлы для загрузчика grub, модифицированного для загрузки в UEFI режиме. Только для EFI режима.
     ├── /EFI - копия каталога EFI из корневого каталога, на случай если он будет стёрт
     │   └── /BOOT
     │      ├── grub.cfg - файл настройки, ссылается на основной файл /boot/grub/grub_ru.cfg или /boot/grub/grub.cfg
     │      ├── BOOTx64.EFI - загрузчик для 64-битных систем
     │      ├── bootia32.efi - загрузчик для 32-битных систем
     │      └── grubx64.efi
     ├── /fonts/unicode.pf2 - шрифт с поддержкой юникода
     ├── grub.cfg - файл настройки загрузчика, английский вариант
     ├── grub_ru.cfg - файл настройки загрузчика, русский вариант. Загрузчик в UEFI режиме cможет загружать только ядра Linux
     └── /themes/  - тема для загрузчика
</code></pre>
<p><strong>/EFI</strong> - версия загрузчика grub, модифицированная для загрузки в UEFI режиме. Только для EFI режима.</p>
<pre><code>  └── /BOOT
     ├─ grub.cfg - файл настройки, ссылается на основной файл /boot/grub/grub_ru.cfg или /boot/grub/grub.cfg
     ├─ BOOTx64.EFI - загрузчик для 64-битных систем
     ├─ bootia32.efi - загрузчик для 32-битных систем
     └─ grubx64.efi
</code></pre>
<p><strong>/MagOS</strong> - основной каталог системы, при обновлении полностью переписывается</p>
<pre><code>  ├── MagOS.sgn - файл-метка, по которой происходит поиск местоположения системы
  ├── vmlinuz - ядро Linux
  ├── uird.magos.cpio.xz - загрузочный образ UIRD, необходим для загрузки системы
  ├── initrd.gz - альтернативный загрузочный образ для использования вместо UIRD
  ├── /base - системные модули
  │  ├── 00-kernel.xzm - ядро и модули ядра, обязательный модуль
  │  ├── 01-drivers-wireless.xzm - дополнительные драйверы для wifi карт
  │  ├── 01-x-drivers-mesa.xzm - свободные драйверы и библиотеки для различных видеокарт
  │  ├── 01-x-drivers-nvidia390.xzm - фирменный драйвер для устаревших видеокарт nvidia
  │  ├── 01-x-drivers-nvidia515.xzm - фирменный драйвер для современных видеокарт nvidia
  │  ├── 10-core.xzm - системные библиотеки и утилиты, уровня командной строки, обязательный модуль
  │  ├── 20-x-base.xzm - графический сервер, утилиты и библиотеки для работы в графике, LXQT, менеджеры входа sddm, slim
  │  ├── 35-x-plasma.xzm - графическая среда Plasma, со своими библиотеками и приложениями
  │  ├── 41-applications.xzm - программы и утилиты уровня пользователя
  │  ├── 42-x-office.xzm - офисные программы, поддержка печати и сканера
  │  ├── 43-admintools.xzm - программы и утилиты уровня администратора
  │  ├── 51-x-gimp.xzm - программа Gimp для работы с фотографиями
  │  ├── 51-x-inkscape.xzm - программа Inkscape для работы с векторной графикой
  │  ├── 51-x-mozilla.xzm - программы Mozilla Firefox и Thunderbird для работы в сети
  │  ├── 51-x-virtualbox.xzm - эмулятор Virtualbox
  │  ├── 52-x-steam.xzm - игровой клиент Steam и библиотеки, необходимые для его работы
  │  ├── 70-documentation.xzm - документация к программам и утилитам, в т.ч. man, info.
  │  └── 88-magos.xzm - скрипты и файлы MagOS, меняющие и дополняющие базовую систему, файлы настроек, скрипты, наше оформление и темы.
  ├── /modules - (если нет MagOS-Data) каталог для пользовательских модулей, загружаемых автоматически
  ├── /optional - (если нет MagOS-Data) каталог для доп. модулей, загружаемых с помощью параметров load= uird.load+=
  ├── /machines - (если нет MagOS-Data) каталог для сохранения системных настроек в виде модуля, привязанного к MAC адресу
  │  ├── /dynamic
  │  └── /static
  ├── MagOS.ini - (если нет MagOS-Data) ini файл, позволяющий менять файлы настроек системы
  ├── VERSION - текстовый файл с версией системы
  ├── MD5SUM - контрольные суммы ядра, uird, initrd и модулей. Для проверки используйте md5sum -c MD5SUM
  ├── LICENSE - текстовый файл с лицензией
  ├── boot.tar.bz2 - архив папки /boot для установки на другой носитель
  └── MagOS-Data.tar.bz2 - архив папки MagOS-Data для установки на другой носитель
</code></pre>
<p><strong>/MagOS-Data</strong> - папка с настройками и модулями пользователя, при обновлении не изменяется</p>
<pre><code>  ├── MagOS-Data.sgn - файл-метка, по которой происходит поиск местоположения MagOS-Data
  ├── MagOS.ini - файл, позволяющий менять файлы настроек системы, см комментарии в самом файле
  ├── /modules - каталог для пользовательских модулей, загружаемых автоматически
  ├── /optional - каталог для доп. модулей, загружаемых с помощью параметров load= uird.load+=
  ├── /machines - каталог для сохранения системных настроек в виде модуля, привязанного к MAC адресу
  │  ├── /dynamic - по умолчанию здесь ищется модуль машины при загрузке и сюда же сохраняется при выключении
  │  └── /static - если модуль машины перенесён сюда, то он замораживается, читается, но не сохраняется
  ├── /rootcopy - каталог, из которого все файлы "копируются" в корень системы, поверх существующих. Полезен для экспериментов
  ├── /backgrounds - графический материал, формурующийся случайно из нашей галереи. отличен для каждой сборки
  │  ├── /screensaver/Default/ - фото для хранителя экрана
  │  └── /wallpapers/Default/ - при старте системы обои рабочего стола выбираются случайным образом из этой папки
  ├── home.img - файл-профиль для сохранения данных пользователя (/home/)
  ├── profiles.7z - архив с пустыми профилями, которые можно использовать для системы и /home
  ├── /homes - папка для сохранения данных пользователя, если MagOS-Data лежит не на fat/ntfs, используйте   uird.home=homes (UIRD) или home=homes (initrd)
  ├── /changes - папка для сохранения данных системы, если MagOS-Data лежит на линуксовой ФС, можно использовать uird.changes=changes (UIRD) или changes=changes (initrd), уберите параметр uird.mode=machines
  ├── /cache - место для внешнего хранения больших данных (к примеру Антивирус Касперского), для хранения данных в чистом режиме
  └── /steam - папка для установки клиента Steam (только для линуксовых ФС, не для fat/ntfs)
</code></pre>
<p><strong>readme.html</strong> - копия всех страниц этого wiki руководства в одном html файле</p>
<hr><a name="MagOS-в-режиме-сервера"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>MagOS в режиме сервера</h1>
<h3>Введение</h3>
<p>Данная статья посвящена настройке MagOS в режиме сервера для различных целей. Мы ставим перед собой целью предоставить пользователю максимальный функционал с минимальными настройками. Для большинства серверов сделаны предварительные общие настройки, благодаря чему для работы в режиме сервера достаточно будет просто поднять ту или иную службу. Каждая роль по возможности будет рассмотрена с нескольких сторон - настройка сервера, подключение другой машины под управлением MagOS в качестве клиента, подключение другого Linux клиента, подключение Windows клиента.</p>
<p><strong>Статья написана для сборок MagOS-Linux с версией 2016.64 20180325 и старше. В более ранних версиях настройки служб могут отличаться.</strong></p>
<h3>Общие настройки</h3>
<p><strong>Адресация по умолчанию</strong></p>
<p>По умолчанию в MagOS принято что Ethernet сеть (по витой паре) адресуется диапазоном 192.168.1.0/255.255.255.0. Wifi сеть (беспроводная) адресуется диапазоном 192.168.2.0/255.255.255.0. Сам сервер по умолчанию настроен на адрес 192.168.1.31. Если у вас нет веских причин, то лучше оставить стандартную адресацию. Иначе вам придётся на всех машинах изменить следующие параметры файла настроек <em>MagOS\MagOS.ini</em> (далее по тексту просто ini файла):</p>
<pre><code>MAGOSSERVER=192.168.1.31
NETWORKIP=192.168.1.
</code></pre>
<p><strong>Открытие служб в межсетевом экране</strong></p>
<p>На MagOS по умолчанию включен межсетевой экран для защиты от несанкционированного доступа. Он настроен на блокировку всех входящих запросов. Поэтому при организации сервера нужно открыть адреса. Это можно сделать двумя способами:</p>
<ul>
<li>открытие сети;</li>
<li>открытие порта.</li>
</ul>
<p>Открытие сети (диапазона адресов) применяется для доверенной сети. Для этого диапазона будут доступны все службы. Открытие порта применяется для предоставления доступа с любого адреса (в т.ч. с Интернета).
Пример:</p>
<pre><code># Открытие сети 192.168.1.0/255.255.255.0
IPTABLESTRUSTEDIP=192.168.1.0/24
# Открытие портов, отдельно протоколы TCP и UDP
IPTABLESOPENPORTSTCP=21,22,30001
IPTABLESOPENPORTSUDP=30002
</code></pre>
<p><strong>Включение служб</strong></p>
<p>Для включения служб есть параметр ini файла <strong>SERVICESSTART</strong>, в нём через запятую задаются службы, поднимаемые автоматически. В этом параметре можно указывать как обычные службы, так и службы xinetd.
Пример:</p>
<pre><code>SERVICESSTART=NetworkManager-wait-online,sshd,rpcbind,nfs-idmap,nfs-mountd,nfs-rquotad,nfs-server,dhcpd,xinetd,tftp,ntpd
</code></pre>
<p>Желательно использовать специальную службу <strong>NetworkManager-wait-online</strong> для того чтобы избежать ошибок во время  загрузки служб, связанных с тем что на момент запуска служб ещё не будет поднят сетевой интерфейс. </p>
<p><strong>Настройки по безопасности</strong></p>
<p>Если вы используете MagOS-Linux в качестве сервера, то вам следует <strong>обязательно поменять стандартные <a href="#%D0%A7%D0%B0%D0%92%D0%BE(%D0%A7%D0%B0%D1%81%D1%82%D0%BE-%D0%B7%D0%B0%D0%B4%D0%B0%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D1%8B)">пароли</a></strong></p>
<p>Старайтесь не запускать на внешних интерфейсах службы, которые предоставляют услуги только для локальной сети. Посмотреть текущие открытые порты вы можете командой <strong>netstat -l -n -p -t</strong> Если служба слушает на адресе 0.0.0.0, то, скорее всего,  это означает, что она принимает запросы со всех интерфейсов, в т.ч. с тех, что смотрят в Интернет. Дополнительно для проверки можно использовать сканер портов на ваш внешний адрес (<em>nmap -sUT 192.168.1.31</em>)
Настроить интерфейсы службы можно либо через файл настройки службы, либо через специальный файл параметров запуска служб в /etc/sysconfig/название_службы. Примеры:</p>
<pre><code>[/etc/pdnsd.conf]
server_ip=192.168.1.31;
[/etc/resolv.conf]
nameserver 192.168.1.31
[/etc/sysconfig/dhcpd]
INTERFACES="enp0s10" #название вашего интерфейса смотрите в выводе ifconfig
[/etc/sysconfig/ntpd]
OPTIONS="-g -I 192.168.1.31 -I 127.0.0.1"
[/etc/sysconfig/nfs]
RPCNFSDARGS="-H 192.168.1.31 -H 127.0.0.1"
[/etc/hosts.deny]
portmap:ALL
lockd:ALL
mountd:ALL
rquotad:ALL
statd:ALL
[/etc/hosts.allow]
portmap:192.168.1.0/255.255.255.0
lockd:192.168.1.0/255.255.255.0
mountd:192.168.1.0/255.255.255.0
rquotad:192.168.1.0/255.255.255.0
statd:192.168.1.0/255.255.255.0
[/etc/ssh/sshd_config]
ListenAddress 192.168.1.31
ListenAddress 127.0.0.1
Port 22022
[/etc/nxserver/node.conf]
SSHD_PORT=22022
</code></pre>
<p>Хорошей практикой, также, является смена порта для sshd на нестандартный.</p>
<h2>Маршрутизатор</h2>
<p>Маршрутизатор в локальной сети используется для предоставления доступа в другие сети (к примеру, Интернет) всем клиентам локальной сети. Как правило, именно маршрутизатор обладает доступом к физическому оборудованию (модем, ADSL-модем, физическая линия), однако это не обязательное условие. Для работы в качестве маршрутизатора подойдёт и обычный сетевая машина, на которой настроен доступ к другим сетям (настроен шлюз по умолчанию). Обычно используется для:
1. предоставления доступа в Интернет другим машинам;
2. предоставления доступа из сети wifi (беспроводная сеть) в сеть ethernet (по витой паре) и обратно.</p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Используйте параметр ini файла ROUTER</p>
<pre><code>ROUTER=yes
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<p>Если на муршрутизаторе не включен DHCP сервер (автоматическое получение сетевых параметров), то нужно указать в ini файле адрес маршрутизатора в качестве шлюза по умолчанию.
Пример:</p>
<pre><code>[/etc/sysconfig/network-scripts/ifcfg-eth0]
GATEWAY=192.168.1.31
</code></pre>
<p><strong>3. Настройка на Linux клиенте.</strong></p>
<p>При создании сетевого соединения укажите в качестве шлюза по умолчанию IP адрес машины, используемой в качестве маршрутизатора.</p>
<p><strong>4. Настройка на Windows клиенте.</strong></p>
<p>При создании сетевого соединения укажите в качестве шлюза по умолчанию IP адрес машины, используемой в качестве маршрутизатора.</p>
<h2>Сервер DHCP</h2>
<p>Сервер DHCP предназначен для раздачи клиентам адресов и сетевых настроек. Сервер по умолчанию настроен на раздачу адресов в двух диапазонах 192.168.1.0/24 для проводной сети и 192.168.2.0/24 для беспроводной сети. Клиенту выдаётся свободный IP адрес из диапазона 32-191. Кроме адреса, выдаются значения маски сети, сервера сетевой загрузки, сервера ДНС. Если у вас уже есть в сети DHCP сервер на базе WAN модема, вам нужно отключить эту службу на модеме.</p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Включите службу через параметр ini файла SERVICESSTART.</p>
<pre><code>SERVICESSTART=dhcpd
# Открытие портов
IPTABLESOPENPORTSUDP=67
</code></pre>
<p>Также необходимо указать статический адрес для сетевого интерфейса для самого сервера.</p>
<pre><code>[/etc/sysconfig/network-scripts/ifcfg-eth0]
# Автоподнятие сетевого интерфейса
ONBOOT=yes
# Пример настройки постоянного адреса
BOOTPROTO=static
IPADDR=192.168.1.31
NETMASK=255.255.255.0
# Шлюз по умолчанию, в данном случае WAN модем
GATEWAY=192.168.1.1
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<p>По умолчанию сетевые интерфейсы настроены на автоматическое получение адреса.</p>
<p><strong>3. Настройка на Linux клиенте.</strong></p>
<p>При создании сетевого соединения укажите автоматическое получение адреса.</p>
<p><strong>4. Настройка на Windows клиенте.</strong></p>
<p>При создании сетевого соединения укажите автоматическое получение адреса.</p>
<h2>Сервер DNS</h2>
<p>В MagOS по умолчанию включен кеширующий сервер <strong>pdnsd</strong>. Он запоминает адреса серверов, с которыми вы работаете и при последующем запросе выдаёт информацию из кеша. Этот механизм позволяет ускорить работу в Интернете. Так же, с помощью этого сервера вы можете заблокировать адреса нежелательных сайтов и доменов в вашей сети (см. файл /etc/pdnsd.conf). По умолчанию служба уже запущена при старте и работает локально, только для программ запущенных на этой машине. Если вы хотите, чтобы другие клиенты в сети использовали ваш ДНС сервер, то укажите службе работать на всех интерфейсасх и откройте порты TCP/UDP 53 в межсетевом экране (если не открыт доступ по диапазону).</p>
<p><strong>1. Настройка на сервере.</strong></p>
<pre><code># Открытие сети 192.168.1.0/255.255.255.0
IPTABLESTRUSTEDIP=192.168.1.0/24
# или открытие портов
IPTABLESOPENPORTSTCP=53
IPTABLESOPENPORTSUDP=53

[/etc/pdnsd.conf]
# указание серверу pdnsd принимать запросы на всех сетевых интерфейсах
server_ip=any;
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<pre><code>[/etc/pdnsd.conf]
# указание серверу pdnsd отправлять запросы не в Интернет, а к локальному серверу
ip=192.168.1.31;
</code></pre>
<p><strong>3. Настройка на Linux клиенте.</strong></p>
<p>При настройке сетевого подключения укажите адрес MagOS сервера в качестве ДНС сервера.</p>
<p><strong>4. Настройка на Windows клиенте.</strong></p>
<p>При настройке сетевого подключения укажите адрес MagOS сервера в качестве ДНС сервера.</p>
<h2>Прокси сервер</h2>
<p>В стандартную поставку включен небольшой прокси сервер <strong>polipo</strong>. Он может выполнять функции http прокси сервера для экономии трафика и для блокировки нежелательных ресурсов. Polipo может помочь вам работать через socks-сервер при использовании протокола <strong>TOR</strong>. Если вы хотите чтобы другие клиенты в сети использовали ваш прокси-сервер, то откройте порт TCP 8118 в межсетевом экране (если не открыт доступ по диапазону).
Для блокировки нежелательных ресурсов используйте файл /etc/polipo/forbidden.</p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Включите службу polipo через параметр ini файла SERVICESSTART и разрешите доступ в экране.</p>
<pre><code>SERVICESSTART=polipo
# Открытие сети 192.168.1.0/255.255.255.0
IPTABLESTRUSTEDIP=192.168.1.0/24
# или открытие порта
IPTABLESOPENPORTSTCP=8118
</code></pre>
<p>Для доступа к прокси-серверу других компьютеров локальной сети укажите в настройках polipo адрес интерфейса локальной сети</p>
<pre><code>[/etc/polipo/config]
proxyAddress="192.168.1.31"
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<p>Укажите в браузере адрес MagOS сервера в качестве http прокси сервера. Чтобы сделать прокси сервер системным (для всех пользователей), можно внести изменения в ini файл (переменная HTTP_PROXY)</p>
<p><strong>3. Настройка на Linux клиенте.</strong></p>
<p>Укажите в браузере адрес MagOS сервера в качестве http прокси сервера.</p>
<p><strong>4. Настройка на Windows клиенте.</strong></p>
<p>Укажите в браузере адрес MagOS сервера в качестве http прокси сервера.</p>
<h2>Терминальный сервер</h2>
<p>Терминальный сервер позволяет пользователям сети запускать на сервере программы под учётными записями, существующими на данном сервере. В MagOS есть возможность организации как консольного сервера, так и графического. Консольный вход осуществляется службой <strong>sshd</strong>. Доступ к графическому серверу организует служба <strong>freenx</strong>, также использующая sshd. При запуске службы sshd будет возможен вход как в консольном, так и в графическом режиме. Вам необходимо открыть порт TCP 22 в межсетевом экране (если не открыт доступ по диапазону).
Настройка.</p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Включите службу sshd через параметр ini файла SERVICESSTART и откройте доступ в экране</p>
<pre><code>SERVICESSTART=sshd
# Открытие сети 192.168.1.0/255.255.255.0
IPTABLESTRUSTEDIP=192.168.1.0/24
# или открытие порта
IPTABLESOPENPORTSTCP=22
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<p>Для консольного доступа к серверу используйте команду <em>ssh user@magos-server</em>.
Для входа в графическую систему используйте программу Remmina (Главное меню-Интернет-Администрирование-Клиент удалённого рабочего стола Remmina). Программа по умолчанию содержит настроенную запись для подключения к MagOS серверу.</p>
<p><strong>3. Настройка на Linux клиенте.</strong></p>
<p>Для консольного доступа к серверу используйте команду <em>ssh user@192.168.1.31.</em>
Для входа в графическую систему установите программу Remmina или бесплатный клиент NX Nomachine Client. При создании соединения вам понадобится открытый ключ MagOS сервера (см. /usr/share/magos/MagOS_client.id_dsa.key).</p>
<p><strong>4. Настройка на Windows клиенте.</strong></p>
<p>Для консольного доступа к серверу используйте утилиту <em>Putty.</em>
Для входа в графическую систему установите бесплатный клиент <em>NX Nomachine Client</em>. При создании соединения вам понадобится открытый ключ MagOS сервера (см. /usr/share/magos/MagOS_client.id_dsa.key).</p>
<h2>Сервер удалённой загрузки ОС (тонких клиентов)</h2>
<p>Вы можете выделить определённую машину c MagOS, превратить её в сервер. Тогда вы сможете загружать операционную систему на всех компьютерах в локальной сети удалённо по сети, с этого сервера. Компьютеры должны поддерживать такую загрузку. В BIOS необходимо выставить приоритет сетевой загрузки выше остальных носителей.
Преимущества удалённой загрузки:</p>
<ul>
<li>на клиентах можно не устанавливать ОС и вообще компьютер может не иметь винчестера</li>
<li>управление компьютерами осуществляется с централизованного места, это удобно для администратора и полезнее с т.зр. безопасности (меньше возможностей пользователю вмешаться в процесс загрузки)</li>
<li>легче производить обновление MagOS. После обновления сервера нет необходимости обновлять ОС на клиентах</li>
<li>при сетевом подключении 1ГБит/с скорость работы по сети соизмерима со скоростью работы с жёсткого диска</li>
</ul>
<p>Недостатки:</p>
<ul>
<li>необходима быстрая локальная сеть. Желательно от 100Мбит/с и выше. Иначе скорость работы системы будет ниже.</li>
<li>увеличивает трафик в сети, для минимизации этого можно использовать режим copy2ram, там где это возможно.</li>
</ul>
<p>Клиенты при загрузке будут использовать стандартный файл настроек <em>/boot/pxelinux.cfg/default</em> . Для каждого компьютера можно сделать свой собственный файл настроек. Посмотрите на клиенте MAC адрес сетевой карты (см. файл /etc/iftab). Предположим что он равен e0:cb:4e:43:77:70, тогда вы можете создать файл настроек для этого компьютера с именем <em>/boot/pxelinux.cfg/01-e0-cb-4e-43-77-70</em></p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Для настройки необходимо включить серверы DHCP и NFS и дополнительно службу tftp (служба является компонентом xinetd, поэтому его тоже следует включить). В межсетевом экране укажите разрешённый диапазон ip адесов.
Пример:</p>
<pre><code>SERVICESSTART=rpcbind,nfs-idmap,nfs-mountd,nfs-rquotad,nfs-server,dhcpd,xinetd,tftp
IPTABLESTRUSTEDIP=192.168.1.0/16

[/etc/sysconfig/network-scripts/ifcfg-eth0]
# Автоподнятие сетевого интерфейса
ONBOOT=yes
# Пример настройки постоянного адреса
BOOTPROTO=static
IPADDR=192.168.1.31
NETMASK=255.255.255.0
# Адрес шлюза по умолчанию, если сервер не является маршрутизатором
GATEWAY=192.168.1.1
</code></pre>
<p><strong>2. Настройка на клиенте.</strong></p>
<p>Включите в BIOS загрузку по сети.</p>
<h2>Сервер общего доступа NFS</h2>
<p>NFS сервер позволяет предоставить доступ к папкам вашего компьютера пользователям локальной сети. Использование NFS позволит получить вам максимально быстрый доступ (до полутора раз быстрее чем samba), а также позволит полноценно использовать атрибуты файлов. Получить доступ к NFS смогут только клиенты Linux.
По умолчанию, при включении служб nfs-server (и зависимых rpcbind nfs-common), предоставляется доступ к папке /mnt/livemedia. При использовании параметров ini файла PARTITIONSAUTOMOUNT=yes и PARTITIONSSHARE=yes автоматически предоставляется доступ на чтение-запись ко всем разделам, подключенным в /media при старте системы. Параметры файла настроек PARTITIONSNOMOUNT= и PARTITIONSNOSHARE= позволяют исключить определённые разделы из списка подключаемых и разделямых разделов. Желательно присвоить всем разделам понятные уникальные имена на латиннице.
Посмотреть какие именно ресурсы доступны в данное время вы можете в файле /etc/exports.</p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Включите в автозагрузку службы rpcbind,nfs-idmap,nfs-mountd,nfs-rquotad,nfs-server. В межсетевом экране укажите разрешённый диапазон ip адесов. Включите параметры PARTITIONSAUTOMOUNT и PARTITIONSSHARE. Параметрами PARTITIONSNOMOUNT и PARTITIONSNOSHARE определите список исключений.
Пример:</p>
<pre><code>SERVICESSTART=rpcbind,nfs-idmap,nfs-mountd,nfs-rquotad,nfs-server
IPTABLESTRUSTEDIP=192.168.1.0/16
PARTITIONSAUTOMOUNT=yes
PARTITIONSNOMOUNT=boot,hidden
PARTITIONSSHARE=yes
PARTITIONSNOSHARE=archive
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<p>Включите параметр ini файла AUTOMOUNTSERVER. При старте будут просканированы разделяемые ресурсы сервера (/media/*) и все разделы будут автоматически подключены при старте системы в папку /mnt/server</p>
<pre><code>AUTOMOUNTSERVER=yes
</code></pre>
<p><strong>3. Настройка на клиенте Linux.</strong></p>
<p>Добавьте на клиенте для каждого разделяемого ресурса в /etc/fstab запись вида:</p>
<pre><code>192.168.1.31:/media/data /mnt/server/data nfs vers=3,nolock,users,auto 0 0
</code></pre>
<p>Не забудьте создать пустые каталоги для монтирования (/mnt/server/data в данном примере)</p>
<p><strong>4. Настройка на клиенте Windows.</strong></p>
<p>Насколько автору известно, подключение со среды Windows не реализуемо. Если есть бесплатное решение для полноценного подключения NFS разделов, сообщите, и я исправлю этот пункт.</p>
<h2>Сервер общего доступа Samba</h2>
<p>Samba сервер позволяет предоставить доступ к папкам вашего компьютера пользователям локальной сети. Чаще всего используется в смешанных сетях, в которые включены не только Linux машины.
По умолчанию, при включении службы <strong>smb</strong>, предоставляется доступ чтение-запись к папке <em>/media</em>. Получить доступ можно используя учётки пользователей, существующих на сервере (стандартно это <em>user</em>). Пароли в самбе отличаются от обычных. Вы можете назначить нужный пароль командой <em>smbpasswd user</em>, либо использовать случайные пароли, созданные при первом запуске системы. Посмотреть эти пароли можно специальной командой (под пользователем root)</p>
<pre><code>[root@MagOS /]# /usr/lib/magos/rc.local.d/81-samba show
Default samba passwords:
user d0564f
guest account is enabled on default
</code></pre>
<p>Если на сервере существует раздел <em>/media/public</em>, то к нему предоставляется гостевой доступ на чтение запись. Можно будет подключиться к ресурсу пользователем guest , без пароля.</p>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Включите в автозагрузку службу smb. В межсетевом экране укажите разрешённый диапазон ip адесов. Включите параметры PARTITIONSAUTOMOUNT. Параметрами PARTITIONSNOMOUNT можно определить список разделов, не подключаемых автоматически. Специальный параметр SAMBADOMAIN позволяет задать рабочую группу.
Пример:</p>
<pre><code>SERVICESSTART=smb
SAMBADOMAIN=home
IPTABLESTRUSTEDIP=192.168.1.0/16
PARTITIONSAUTOMOUNT=yes
PARTITIONSNOMOUNT=boot,hidden
</code></pre>
<p><strong>2. Настройка на клиенте Linux.</strong></p>
<p>Используйте команды mount.cifs (под root) и fusesmb (от пользователя) для подключения ресурсов.</p>
<pre><code>#сначала создаём пустые каталоги для подключения
[root@MagOS /]# mkdir /mnt/server /mnt/public 
#теперь собственно подключаем
[root@MagOS /]# mount.cifs //magos-server/media /mnt/server -o user=user,pass=d0564f
[root@MagOS /]# mount.cifs //magos-server/public /mnt/public -o user=guest,pass=
</code></pre>
<p>Пароль указывать открытым текстом небезопасно, поэтому лучше не указывать параметр pass, тогда утилита потребует ввода пароля.Для автоматического подключение ресурсов при старте можно добавить в /etc/fstab запись вида:</p>
<pre><code>//192.168.1.31/public /mnt/public cifs user=guest,pass=,auto 0 0
</code></pre>
<p><strong>3. Настройка на клиенте Windows.</strong></p>
<p>Подключение возможно стандартными графическими средствами и консольной командой net use.</p>
<h2>Сервер общего доступа FTP</h2>
<p>В состав MagOS включен сервер <strong>proftpd</strong>, который позволяет предоставить доступ к папкам вашего компьютера пользователям локальной сети и Интернета по протоколу ftp. По умолчанию, при включении службы proftpd, предоставляется доступ до следующих папок (если они существуют):</p>
<ul>
<li>/media - чтение - под именем и паролем пользователей, существующих на сервере;</li>
<li>/media/common - чтение-запись - под именем и паролем пользователей, существующих на сервере;</li>
<li>/media/public - чтение - анонимный вход;</li>
<li>/media/public/inbox - чтение-запись - анонимный вход;</li>
</ul>
<p><strong>1. Настройка на сервере.</strong></p>
<p>Включите в автозагрузку службу proftpd. В межсетевом экране откройте TCP порт 21 или укажите разрешённый диапазон ip адесов. Включите параметры PARTITIONSAUTOMOUNT для автоматического подключения разделов. Параметрами PARTITIONSNOMOUNT определите список исключений. Пример:</p>
<pre><code>SERVICESSTART=proftpd
PARTITIONSAUTOMOUNT=yes
PARTITIONSNOMOUNT=boot,hidden
# Открытие сети 192.168.1.0/255.255.255.0
IPTABLESTRUSTEDIP=192.168.1.0/24
# или открытие порта
IPTABLESOPENPORTSTCP=21
</code></pre>
<p><strong>2. Настройка на клиенте.</strong></p>
<p>Вы можете использовать любую программу, которая умеет работать с протоколом ftp.</p>
<h2>Сервер времени NTPD</h2>
<p>В MagOS-Linux сервер времени <strong>ntpd</strong> настроен по умолчанию. При поднятии службы ntpd время будет синхронизироваться с серверами интернета <em>ntp1.vniiftri.ru ntp2.vniiftri.ru ntp2.vniiftri.ru</em>. Если вы хотите указать свои локальные серверы, это можно сделать параметром ini файла NTPSERVERS. Чтобы другие компьютеры в сети смогли брать время с вашей машины, откройте порт UDP 123 или укажите разрешённый диапазон ip адресов.</p>
<ol>
<li>Настройка на сервере.</li>
</ol>
<p>Включите в автозагрузку службу ntpd. Параметром NTPSERVERS можно изменить источник точного времени.</p>
<pre><code>SERVICESSTART=ntpd
# Открытие сети 192.168.1.0/255.255.255.0
IPTABLESTRUSTEDIP=192.168.1.0/24
# или открытие порта
IPTABLESOPENPORTSUDP=123
</code></pre>
<p><strong>2. Настройка на клиенте MagOS.</strong></p>
<p>По умолчанию, MagOS-Linux выполняет сихронизацию времени разово, при включении компьютера. Если вы хотите, чтобы машины вашей сети использовали в качестве источника точного времени не серверы интернета, а ваш сервер, укажите его адрес в параметре NTPSERVERS ini файла</p>
<pre><code>NTPSERVERS=magos-server
</code></pre>
<p>Дополнительно, если вы хотите чтобы время синхронизировалось постоянно, вы можете запустить сервер ntpd или использовать утилиту ntpdate для периодической синхронизации с помощью планировщика crond</p>
<p>а) Включите в автозагрузку службу ntpd. Параметром NTPSERVERS задайте ваш сервер точного времени.</p>
<pre><code>NTPSERVERS=magos-server
SERVICESSTART=ntpd
</code></pre>
<p>б) Включите в автозагрузку службу crond. Параметром NTPSERVERS задайте ваш сервер точного времени. В этом варианте время будет синхронизироваться каждые 10 минут командой ntpdate. Запускать сервер ntpd на клиенте нет необходимости.</p>
<pre><code>NTPSERVERS=magos-server
SERVICESSTART=crond
</code></pre>
<p><strong>3. Настройка на клиенте Linux.</strong></p>
<p>В файле настроек /etc/ntp.conf исправьте секцию серверов, добавив строки, указанные ниже. Включите в автозагрузку службу ntpd.</p>
<p>server 192.168.1.31
restrict 192.168.1.31 noquery notrap</p>
<p><strong>4. Настройка на клиенте Windows.</strong></p>
<p>Настройте источник точного времени используя стандартные средства операционной системы.</p>
<hr><a name="Pfs-utils"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Pfs utils</h1>
<p>Альтернативный набор утилит для работы с модулями. Развивается совместно с проектом Puppyrus. Форум проекта <a href="http://forum.puppyrus.org/index.php?board=172.0">здесь</a>, код <a href="https://github.com/pfs-utils/pfs-utils-cli">тут</a>. Основная документация <a href="http://wiki.puppyrus.org/puppyrus/pr218/pfs3">тут</a>.
Утилиты отличает расширенный, относительно скриптов MagOS, функционал и минимальная привязка к конкретному дистрибутиву.
Все утилиты имеют встроенный --help и небольшую общую справочную страничку (man pfs-utils).</p>
<h2>Составной модуль (контейнер) - два и более модулей объединенных в один.</h2>
<p>Технически это тот же squashfs модуль, только он содержит списки файлов и пустых каталогов для каждого подмодуля. 
Это позволяет в любой момент разобрать контейнер на составляющие или извлечь произвольный подмодуль. Собрать контейнер можно, как из модулей, так и из каталогов. Смотрите mkpfs.</p>
<h2>Утилиты.</h2>
<h3>aufs-n - вывод детальной информации о корневой aufs</h3>
<ul>
<li><code>aufs-n</code>        - вывод в удобном для чтения виде</li>
<li><code>aufs-n N</code>      - вернет точку монтирования слоя "N" </li>
<li><code>aufs-n --raw</code>  - полный вывод в удобном для конвейерной обработки виде</li>
<li><code>aufs-n --raw  '$n $source'</code>   - вернет значения только указанных переменных (см.--help)</li>
</ul>
<h3>mkpfs - создание модуля</h3>
<ul>
<li><code>mkpfs &lt;список источников&gt; -o out.xzm</code></li>
</ul>
<p><em>Примеры:</em>
* <code>mkpfs ./dir</code>                      -создаст dir.pfs из dir
* <code>mkpfs 1.xzm 2.xzm -o 3.xzm</code>       -соберет 1.xzm и 2.xzm в контейнер 3.xzm
* <code>mkpfs * -o ./big.xzm</code>             -соберет все каталоги, модули, образы (img) из текущего каталога в 
                                          один контейнер - big.xzm</p>
<h3>chroot2pfs - создание модуля из изменений сделанных в чруте</h3>
<ul>
<li><code>chroot2pfs -o nano.xzm --command urpmi nano</code> - создаст модуль с nano</li>
</ul>
<h3>mountfile - вспомогательный скрипт, монтирует модули</h3>
<ul>
<li><code>mountfile &lt;file&gt;</code> (куда то в /mnt/+...)</li>
</ul>
<p><em>или</em></p>
<ul>
<li><code>mountfile &lt;file&gt; &lt;mount point&gt;</code></li>
</ul>
<h3>pfs - библиотека функций для pfs-utils; функции могут быть использованы отдельно в консоли или в ваших скриптах</h3>
<ul>
<li><code>pfs &lt;function&gt; &lt;pars&gt;</code></li>
</ul>
<p><em>или</em></p>
<ul>
<li><code>source /path/to/scripts/pfs ; &lt;function&gt; &lt;pars&gt;</code> </li>
</ul>
<p><em>Доступные функции, которые могут быть полезны:</em>
* exitmsg - выход из скрипта с сообщением и кодом завершения
* allow_only_root - проверка на рута
* mklist - создание списка файлов и пустых каталогов (как в контейнерах)
* checksfsxzb - проверка системы на поддержку squashfs
* fs_type - тип fs файла (squashfs, ext2-4 и т.д.)
* mkaufs - создание aufs для утилит mkpfs, pfsextract
* delaufs - удаление aufs
* addlayer  - добавление слоя к aufs
* mksqmod - создание модуля (обертка к mksquashfs)
* pfs_update_caches - обновление кэшей и прочие мелочи, которые необходимо выполнять после подключения и отключения модулей
* lsblocked - показать список модулей, которые невозможно отключить</p>
<h3>pfsdepends - зависимости модулей</h3>
<p><em>(нам пока не интересно)</em></p>
<h3>pfsextract - распаковщик для модулей pfs</h3>
<ul>
<li><code>pfsextract file.pfs</code> - если модуль составной - разобрать на составляющие модули в папку ./file </li>
<li><code>pfsextract file.pfs</code> - если модуль простой - распаковать</li>
<li><code>pfsextract file.pfs pack1 pack2</code> - извлечь из file.pfs только модули pack1 и pack2</li>
</ul>
<h3>pfsfind - поиск файлов в aufs (какой файл в каком модуле лежит)</h3>
<ul>
<li><code>pfsfind  filename</code>        - find "filename"  формат удобный для чтения</li>
<li><code>pfsfind  filename --raw</code>  - find "filename"  формат для конвейеров</li>
<li><code>pfsfind  filename --raw  '$n $module'</code>   - только нужные поля (см.--help)</li>
</ul>
<h3>pfsload - подключение модулей (аналог - activate)</h3>
<ul>
<li><code>pfsload  файл.xzm</code> - подключить модуль</li>
<li><code>pfsload -r файл.xzm</code> - подключить модуль, предварительно скопировав в RAM</li>
<li><code>pfsload ./dir</code> - подключиьт каталог (слоем в ауфс аналогично модулю)</li>
</ul>
<h3>pfsrebuild - сборка нового модуля по списку файлов из уже подключенного к aufs.</h3>
<ul>
<li><code>pfsrebuild &lt;PACKAGE&gt; &lt;args for mkpfs&gt;</code></li>
</ul>
<p><em>списки берутся из подключенного модуля, а файлы из aufs, то есть в новый модуль попадут обновленные файлы.</em></p>
<h3>pfsuninstall - удаление файлов модуля из системы, действие обратное pfsextract -i модуль.xzm</h3>
<ul>
<li><code>pfsuninstall &lt;module&gt;</code></li>
</ul>
<h3>pfsunload - отключение модуля (аналог deactivate)</h3>
<ul>
<li><code>pfsunload &lt;module&gt;</code>
<em>действие обратное pfsload</em></li>
</ul>
<h3>runpfsload-<em>, runpfsunload-</em> - скрипты которые выполняются после подключения/отключения модулей</h3>
<p><em>специфичны для каждого дистрибутива   должны находиться в том же каталоге что и pfsload/pfsunload  и принадлежать руту</em></p>
<h3>sync2layer - переносит файлы из верхнего слоя aufs во второй слой.</h3>
<p><em>используется для освобождения RAM и для сохранения изменений сделанных за определенный период</em>
* <code>sync2layer &lt;newlayer&gt;</code>   - создать слой <newlayer> и перенести в него файлы из changes
* <code>sync2layer</code>              - перенести файлы в существующий второй слой
* <code>&lt;newlayer&gt;</code> - каталог
* <code>&lt;newlayer.rom&gt;</code> - fs in file</p>
<h3>unmountfile - размонтировать то, что смонтировано mountfile</h3>
<hr><a name="Режим-сохранения-в-модули---uird.mode=toxzm"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>Режим сохранения в модули   uird.mode=toxzm</h1>
<h2>режим - TOXZM</h2>
<p><em>Toxzm</em> - режим сохранения в модуль полностью реализованный в UIRD.</p>
<p>Это альтернатива machines и сохранению в модуль, которым требовались скрипты в системе (80-savetomodule в MagOS). Toxzm никак не пересекается с machines и вы можете выбирать что использовать. При этом режим полностью перекрывает возможности как machines так и сохранения в один модуль и имеет приличное количество своих плюшек.
Режим поддерживает сохранение модулей на разделах жестких дисков и съемных носителей со всеми доступными в uird фаловыми системами в том числе LUKS (См.в конце этой справки).</p>
<p>Включение режима сохранения в модуль в UIRD (подключение модулей при старте системы):</p>
<p><code>uird.mode=toxzm</code></p>
<p>Включение сохранения в модуль при выключении (только systemd):</p>
<p><code>uird.shutdown</code></p>
<p>При первом старте c этими параметрами UIRD создаст конфиг по которому при выключении будет создаваться модуль.
Расположение конфига (модуль будет там же) задается параметром uird.changes:</p>
<p><code>uird.changes=/existing_folder</code></p>
<p>Если передать имя существующей папки, то имя файла конфига для модуля UIRD сгенерирует сам на основе характеристик железа.
То есть на каждой машине имя будет свое и мы получим аналог machines от MagOS.</p>
<p><code>uird.changes=/existing_folder/newfile.cfg</code></p>
<p>или</p>
<p><code>uird.changes=/existing_folder/newfile.xzm</code> </p>
<p>Так имя конфига будет одно для всех машин.
(Первый вариант с <em>.cfg</em> - “правильный”, второй c <em>.xzm</em> для похожести на привычные <em>machines</em> и <em>uird.changes=file.xzm</em> можно использовать такую запись, например, при переходе с “магос сохраненки” на <em>toxzm</em> с тем же модулем).</p>
<p>Конфиг создается при первом старте с <em>uird.mode=toxzm</em> и новым значением в <em>uird.changes,</em> он содержит параметры определяющие как подключать и пересобирать модули.
При старте системы модуль может быть смонтирован либо распаковывается в систему, за это отвечает параметр конфига - <em>MODE0=(copy/mount/mount+wh) .</em>
При выключении системные изменения пакуются в новый модуль либо сохраняется старый модуль, а изменения игнорятся. За это отвечает параметр - <em>REBUILD0=(yes/no/once)</em>.</p>
<p>Если вам нужно сохранять в один модуль все системные изменения дальше можно не читать.
Теперь подробнее по конфигу.</p>
<h3>Дефолтный конфиг выглядит так:</h3>
<ul>
<li><strong>XZM0=mac-dc0ea1fbbb19.xzm</strong> (имя модуля по имени конфига)</li>
<li><strong>MODE0=copy</strong> (режим подключения, еще варианты mount, mount+wh)</li>
<li><strong>REBUILD0=yes</strong> (пересобирать или нет, аналог static/dynamic, варианты yes/no)</li>
<li><strong>ADDFILTER0=’’</strong> (список через пробел чего надо включить, пустой список означает включить все)</li>
<li><strong>DROPFILTER0=’’</strong> (список через пробел чего нужно исключить из выбранного ADDFILTER)</li>
<li><strong>SQFSOPT0=’’</strong> (параметры для mksquashfs - сжатие, размер блока и т.д.)</li>
<li><strong>MAXCOPYSIZE0=’’</strong> (максимальный размер модуля в мегабайтах при превышеннии которого модуль переводится в MODE0=mount, REBUILD0=no и создается новая секция)</li>
</ul>
<p>Каждая секция описывает работу с одним модулем. Количество секций не ограничено.
Ноль в конце имени параметров это индекс, который означает принадлежность параметра к секции конкретного модуля. Секции и строки можно перемещать как угодно важны только индексы.</p>
<p>Секции могут быть двух типов - с нумерованным идентификатором (индексом) и не нумерованные.
Нумерованные должны идти строго по порядку, от нуля и без пропусков. Именно в таком порядке они и подключаются при старте.</p>
<p>Ненумерованные (<em>XZMaaa=</em>) подключаются последними. Такая секция может быть нужна чтоб гарантированно подключить модуль последним, имеет смысл только с <em>MODE=copy.</em></p>
<p>Если вместо имени модуля параметру <em>XZM(index)=</em> передать пустое значение, то имя модуля будет сгенерировано на основе характеристик железа. Это позволяет использовать модули для конкретной машины и общие для всех машин в одном конфиге.</p>
<p>Модули в секцииях которые сочетаетают <em>MODE='mount'</em> и <em>REBUILD='yes'</em> имеют ограничение, в них не сохраняются тени ауфс/overlayfs Ниже будут примеры как это ограничение можно обойти используя два модуля.</p>
<p>В конфиге можно использовать код, например:</p>
<p><code>XZM0="$(echo mymod.xzm)"</code>         # не знаю зачем, просто пример :) <br>
или <br>
<code>ADDFILTER0="$(cat ${CFGPWD}/addfilter.lst)"</code>  # в переменной <em>$CFGPWD</em> путь до папки с конфигом.   </p>
<p>Фильтры работают по разному для файлов и папок. Если для файлов это просто вхождение подстроки в строку, то для папок обязателен путь от корня. То есть если .wh.’ это вообще все ауфс тени в любом месте, то /bin это только /bin и его подкаталоги с файлами, но не /usr/bin.</p>
<p>Примеры конфигов:</p>
<p><strong>Внимание!!! Во всех примерах удалены строки с дефолтными значениями чтоб не загромождать примеры, при реальном использовании нужны все строки.</strong></p>
<p><code>XZM0='root.xzm'</code> <br>
<code>MODE0='copy'</code> <br>
<code>REBUILD0='yes'</code> <br>
<code>ADDFILTER0=’/root’</code>              </p>
<p>Сохраняется только папка рут, модуль пересобирается при выключении и распаковывается при старте.</p>
<p><code>XZM0='mac-dc0ea1fbbb19.xzm'</code> <br>
<code>MODE0='copy'</code>     <br>
<code>REBUILD0='yes'</code>  <br>
<code>MAXCOPYSIZE0='20'</code>   </p>
<p>В модуль сохраняется все. Если размер модуля превысит 20 метров UIRD создаст секцию нового модуля с индексом “1”, а секцию модуля “0” переведет в <em>MODE0=mount</em>, <em>REBUILD0=no.</em> Такой режим позволяет совмещать монтируемые модули и сохранение теней.</p>
<p><code>XZM0=''</code> <br>
<code>MODE0='copy'</code> <br>
<code>REBUILD0='yes'</code>   </p>
<p><code>XZMend='88-magos.xzm'</code> <br>
<code>MODEend='copy'</code> <br>
<code>REBUILDend='no'</code>              </p>
<p>Первая секция имеет пустое значение в <em>XZM0</em>, значит на каждой машине там будет свое имя модуля, то есть свой модуль для каждой машины. А вторая секция распаковывает непересобираемый модуль, и он всегда распаковывается последним (поверх всех) независимо от того сколько еще модулей (нумерованных секций) будет создано.</p>
<p><code>XZM0='module.xzm'</code> <br>
<code>MODE0='mount'</code> <br>
<code>REBUILD0='yes'</code>   </p>
<p><code>XZM1='wh.xzm'</code> <br>
<code>MODE1='copy'</code> <br>
<code>REBUILD1='yes'</code> <br>
<code>ADDFILTER1='\.wh\..*'</code>    </p>
<p>В первой секции модуль монтируется при старте и пересобирается при выключении. Он включает все файлы и каталоги кроме теней aufs.
Модуль во второй секции распаковывается при старте и пересобирается при выключении. Он содержит только тени.
Такой режим также позволяет совмещать монтируемые модули и сохранение теней.</p>
<p><code>XZM0='system.xzm'</code> <br>
<code>MODE0='copy'</code> <br>
<code>REBUILD0='yes'</code>  <br>
<code>ADDFILTER0=''</code>  <br>
<code>DROPFILTER0='/home'</code> <br>
<code>MAXCOPYSIZE='50'</code>    </p>
<p><code>XZMh='home.xzm'</code> <br>
<code>MODEh='mount'</code>  <br>
<code>REBUILDh='yes'</code>  <br>
<code>ADDFILTERh='/home'</code>  <br>
<code>DROPFILTERh=''</code>    </p>
<p>В первом модуле системные изменения, во втором хомяк. Модуль с системными изменениями имеет лимит 50 метров, когда он его превысит модуль будет переведен в <em>MODE0=mount, REBUILD0=no</em> и создана новая секция <em>XZM1=system-(дата-время).xzm</em>
При этом последней будет подключаться ненумерованная секция с хомяком. Секция с хомяком поключается <em>MODEh=mount, REBUILDh=yes,</em> не смотря на это проблем с тенями быть не должно так как ниже этого модуля никакие другие модули не содержат файлов в хомяке (это справедливо для МагОС и до тех пор пока хомяк только в одном модуле)</p>
<p><code>XZM0='my.xzm'</code>  <br>
<code>ADDFILTER0='/root</code> <br>
<code>/home</code> <br>
<code>/etc'</code> <br>
<code>DROPFILTER0="$(cat $CFGPWD/drop.lst)"</code>   </p>
<p>Пример фильтров в несколько строк и из файла.</p>
<p><code>XZM0='mod.xzm'</code> <br>
<code>MODE0='mount+wh'</code> <br>
<code>REBUILD0='yes'</code>   </p>
<p>Режим <em>mount+wh</em> позволяет сохранения с учетом теней в один монтируемый модуль. Тени ауфс при этом разбираются скриптом, а не самой ауфс, что может замедлить выключение сиситемы. С марта 2021 режим доступен и для overlayfs.</p>
<p><code>XZM0='zsave.xzm'</code> <br>
<code>MODE0='mount'</code> <br>
<code>REBUILD0='yes'</code>   </p>
<p><code>XZM1='zwhiteout.xzm'</code> <br>
<code>MODE1='copy'</code> <br>
<code>REBUILD1='yes'</code> <br>
<code>ADDFILTER1="$(find /memory/ovl/changes/ -perm 0000 -size 0c -type c |sed 's:/memory/ovl/changes::')"</code>   </p>
<p>Аналог четвертого примера, но при загрузке с overlayfs. В первый модуль пишутся файлы, во второй тени. Второй модуль хранит тени, для оверлея это файлы с теми же именами, но с нулевыми правами.</p>
<h3>Дополнительные параметры (флаги) для uird.shutdown:</h3>
<ul>
<li>log включить журналирование, логи ищите рядом с конфигом и модулями.</li>
<li>ask спрашивать всякий раз перед созданием нового модуля</li>
<li>shell консоль перед созданием модуля</li>
<li>haltonly не создавать модуль при ребуте, создавать только при выключении.</li>
<li>silent работать молча, минимум информации на экран.</li>
</ul>
<p>Пример:</p>
<p><code>uird.shutdown=log,ask</code></p>
<p>Дополнительные параметры для <em>uird.mode=toxzm:</em></p>
<pre><code>_EXT=pfs_ - расширение для модулей, по умолчанию - xzm   
_MODE REBUILD DROPFILTER ADDFILTER SQFSOPT MAXCOPYSIZE_ - параметры для дефолтной секции   
_FSCK SGN MNT_OPTS TIMEOUT_ и т.д. параметры для монтирования папки в которой лежит конфиг, работают аналогично _uird.from, uird.mounts_
</code></pre>
<p>Пример: <br>
<code>uird.mode=toxzm::EXT=pfs::TIMEOUT=2::MODE=mount</code></p>
<h3>LUKS</h3>
<p>Режим toxzm можно использовать для сохранения на разделы LUKS. Но, при выключении вам также будет требоваться вводить пароль от раздела как и при старте, что не удобно. Вы можете привязать расшифровку luks раздела к железу, это может быть удобно если вы грузите с флешки на нескольких машинах. То есть на доверенных машинах UIRD расшифрует без запроса пароля, на остальных спросит пароль. Делается это так. У LUKS 8 слотов котрые могут хранить ключи и пароли (в luks 2, ограничения нет). В один слот вы записываете пароль который будете вводить, а в другой слот записываете выхлоп команды:</p>
<p><code>busybox.static lspci |md5sum |cut -f1 -d " "</code></p>
<p>Команду нужно запускать на той машине которой вы хотите разрешить беспарольную загрузку.
В cmdline к параметру который подключает LUKS (<em>uird.from, uird.mounts</em>) нужно добавить <em>PASS=//hardware//</em>, то есть типа такого должно получиться:</p>
<p><code>uird.mounts=LUKS@/::PASS=//hardware//</code></p>
<h3>Внимание. Возможно потребуется отключение plymouth для ввода пароля LUKS.</h3>
<hr><a name="ЧаВо(Часто-задаваемые-вопросы)"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>ЧаВо(Часто задаваемые вопросы)</h1>
<h3>Пароль по умолчанию</h3>
<p>Пароль по умолчанию для пользователей установлен в <strong>magos</strong>. Пароль администратора (пользователь root) определён как <strong>toor</strong>. </p>
<p>Вы можете сменить эти пароли через ini файл (см. комментарии в файле). В ini файле указывается хеш пароля. Чтобы узнать хеш от нужной парольной фразы, смените пароль пользователя через «Настройку компьютера», или консольную утилиту passwd, затем возьмите хеш из файла /etc/shadow (второе поле с разделителем <strong>:</strong>).</p>
<p>Пример хеша из строки /etc/shadow:</p>
<p>user:<strong>$6$kCP2oNGB$LD4VUJfTMxTmzbZNZg16AYDjSQ6CB1hEaqzb49I91KntXDTVxux6KueiYj59HiHddL9zJwlQ4Y8hzvXRTwpFQ0</strong>:16704:0:99999:7:::</p>
<p>Пример MagOS.ini:</p>
<pre><code>#Хеш пароля для пользователя по умолчанию (стандартно magos)
DEFAULTPASSWD='$6$BQPNljLTsudcWAvZ$mZByj3lC2uWwbq/GLtWQAvvro8syKJuIKD.F3ovrTrr6yZC2MmWm5lLMDXZezIwAhSqEdfKuXpVpfPM0RUYt01'
#Хеш пароля для пользователя root (стандартно toor)
DEFAULTROOTPASSWD='$6$cVE.1SJ6tLPauIEj$F6Osa0qK6sr4V6bnWhRJFcy/Zi8WQY8b1eEGPKk6zVYx3Kt9PLLAlKbFt77guAyRuyPU0RLBtfSfzDBHJ5JGa1'
# Пользователи системы (можно также указать хеш, латинская x означает хеш из DEFAULTPASSWD)
NEEDEDUSERS='user:500:x,user2:501:$6$3edKnRopOiB973oa$..eJqgkUGUEZ3TQXm68hw6XpSq/TjVMf90lp9WSYtCtumqP8iBdTlqeuhKlhPKSFdCWDBLV43wk7C5J8JOp8w.'
</code></pre>
<p>Пример смены пароля и получения хеша в консоли (нажмите F12, чтобы открыть всплывающую консоль):</p>
<pre><code>user@MagOS ~ $ su -
Пароль: toor (не печатается при вводе)

MagOS ~ # passwd root
Изменяется пароль пользователя root.
Новый пароль : 
Повторите ввод нового пароля : 
passwd: все данные аутентификации успешно обновлены.

MagOS ~ # passwd user
Изменяется пароль пользователя user.
Новый пароль : 
Повторите ввод нового пароля : 
passwd: все данные аутентификации успешно обновлены.

MagOS ~ # grep -E "^root:|^user:" /etc/shadow
user:$6$Eu1YImjA26czmPCZ$dZsOiwqkcMzxJ3XHHzfB1QEhAVurLtKT5HYTYz8lv5P/oOFUKWmxXj5cdeIMWW8mnIefa1BrLKdU2ojEN4TZB.:17800:0:99999:7:::
root:$6$OPovNx99TQB28THt$YEWiGwVowag5W5ThpGyT6ZiEcTMdRirPW0jUyXyen/UqyoEYyi5GWTULoIZx6gjCjq56nUTRAp3f0v4VC/8e2/:17800:0:99999:7:::

MagOS ~ # grep -E "^root:|^user:" /etc/shadow | awk -F: '{print $1 " " $2}'
user $6$Eu1YImjA26czmPCZ$dZsOiwqkcMzxJ3XHHzfB1QEhAVurLtKT5HYTYz8lv5P/oOFUKWmxXj5cdeIMWW8mnIefa1BrLKdU2ojEN4TZB.
root $6$OPovNx99TQB28THt$YEWiGwVowag5W5ThpGyT6ZiEcTMdRirPW0jUyXyen/UqyoEYyi5GWTULoIZx6gjCjq56nUTRAp3f0v4VC/8e2/
</code></pre>
<h3>Меняю пароль через центр управления, он работает, но после перегрузки опять magos</h3>
<p>Изменяйте пароль через ини файл, как это описано выше. Если пароль не указан, то будет использован пароль по умолчанию.</p>
<p>Проблема с паролем в том, что он хранится в /etc/shadow и соответственно попадает в модуль сохранений машины, а не в пользовательские данные. Т.е. пользователь при загрузке на каждой новой машине должен был бы иметь пароль по умолчанию, а на тех машинах, где менял - установленные ранее. Соответственно, приходилось бы постоянно менять пароль на каждой новой  машине и вспоминать пароли на старых, а это неудобно. </p>
<p>Поэтому сделано так, чтобы пароль из ини файла имел больший приоритет, чем сохранённый в системных данных. </p>
<p>С точки зрения безопасности, рекомендуется периодически менять свои пароли. С текущим алгоритмом вы меняете пароль в ини файле один раз и потом уже не нужно будет на каждой машине вспоминать все предыдущие варианты. </p>
<h3>Загрузка с жесткого диска вместо флешки</h3>
<p>Стартую в чистом режиме с флешки - после раздумья автоматически монтируется жесткий диск c установленной MagOS и система загружается оттуда… </p>
<ul>
<li>Можно сделать так чтобы флешка загружалась только с себя. Самый удобный способ - во все секции загрузчика к параметрам загрузки добавить параметр uird.sgnfiles=MagOS_flash.sgn,MagOS-data.sgn (для initrd нужно указать sgnfile=MagOS_flash.sgn) и переименовать на флешке файл MagOS.sgn в MagOS_flash.sgn</li>
</ul>
<h3>Я ничего не понимаю в консоли, не знаю как перейти в папку и как посмотреть файлы.</h3>
<p>Несколько советов:</p>
<ul>
<li>Нажмите <strong>F12</strong>, чтобы быстро попасть в консоль, та же кнопка скрывает её.</li>
<li>Если вам нужны полномочия администратора, то дайте команду <strong>su -</strong> и введите пароль администратора (по умолчанию <em>toor</em>). </li>
<li>Используйте файловый менеджер <strong>mc</strong> (Наберите в коммандной строке <strong>mc</strong> и нажмите <em>Enter</em>). Эта программа может существенно облегчить жизнь новичкам. Для просмотра вывода команд используйте горячую кнопку <em>Ctrl-O</em> для включения/выключения панелей. </li>
<li>При наборе длинных команд, путей и имен файлов в консоли используйте конпку <strong>TAB</strong> для дополнения до полного имени. </li>
<li>У каждой команды в линуксе есть описание, см. <em>команда --help</em> или <em>man команда</em> (из последней выход по нажатию кнопки <strong>q</strong>). </li>
<li>Для того чтобы скопировать текст в консоли, достаточно всего лишь выделить текст левой кнопкой мыши и нажатием средней кнопки вставить в текущую позицию курсора. В файловом менеджере <strong>mc</strong> операции копирования и вставки требуют удерживания кнопки Shift.</li>
</ul>
<p>Удачи!</p>
<h3>Как увеличить размер профиля</h3>
<p>Нужно загрузиться в чистом режиме без профиля и выполнить команды в консоли.</p>
<p>Получить права root:</p>
<pre><code>su -l
</code></pre>
<p>Перейти в папку где лежат профили:</p>
<pre><code>cd /mnt/livedata/MagOS-Data
</code></pre>
<p>Проверить профиль на ошибки (считаем что используется профиль home.img ):</p>
<pre><code>e2fsck -f home.img
</code></pre>
<p>Расширить профиль:</p>
<pre><code>resize2fs home.img 1000M
</code></pre>
<p>Вместо 1000M можно поставить размер в гигабайтах: 1G, 2G, 3.5G</p>
<h3>Как мне создать новый профиль большего размера?</h3>
<p>Опытные пользователи могут создать профиль с помощью команд: </p>
<pre><code>dd if=/dev/zero of=newhome.img bs=1M count=2048
mkfs.ext3 newhome.img
</code></pre>
<p>В этом примере создаётся  профиль размером 2Г c файловой системой ext3. 
Новичку проще достать готовый профиль из архива MagOS-Data\profiles.7z , особенно если это делать с помощью <strong>mc</strong></p>
<hr><a name="История"><p><a href="#%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F-%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">В начало</a></p><h1>История</h1>
<h3>сборка 20241220</h3>
<ul>
<li>обновления на 20.12.2024</li>
</ul>
<h3>сборка 20241121</h3>
<ul>
<li>обновления на 22.11.2024</li>
<li>добавлен пакет gostsum</li>
</ul>
<h3>сборка 20241025</h3>
<ul>
<li>обновления на 25.10.2024</li>
</ul>
<h3>сборка 20240927</h3>
<ul>
<li>обновления на 27.09.2024</li>
<li>добавлен пакет translate-shell (онлайн переводчик в консоли)</li>
</ul>
<h3>сборка 20240825</h3>
<ul>
<li>обновления на 25.08.2024</li>
<li>библиотеки lib64atomic1 lib64atomic_ops1 перенесены в модуль 10-core</li>
<li>исправлен файл блокировки модулей framebuffer консоли /etc/modprobe.d/blacklist-magos-fb.conf</li>
<li>в модуль 51-alvr.sh добвлена библиотека lib64openxr-1.0.24</li>
<li>собран и выложен на сервере пакет openmw-0.48 для виртуальной реальности</li>
</ul>
<h3>сборка 20240727</h3>
<ul>
<li>обновления на 27.07.2024</li>
<li>добавлен пакет yad в модуль 20-x-base</li>
<li>исправлен скрипт определения видеокарт amd</li>
<li>добавлен параметр загрузки xdriver=amdgpu равнозначный xdriver=ati</li>
<li>исправлен скрипт создания настроек для auditd</li>
</ul>
<h3>сборка 20240623</h3>
<ul>
<li>обновления на 23.06.2024</li>
<li>добавлен пакет audit (служба auditd выключена по умолчанию)</li>
<li>добавлен шаблон настроек auditd на основе рекомендаций ФСТЭК</li>
<li>исправлен скрипт установки boot/magos/linux/bootinst.sh для совместимости с другими дистрибутивами</li>
<li>исправлен скрипт определения звуковой карты по умолчанию для звуковой системы ALSA</li>
<li>добавлены начальные настройки для doublecmd</li>
<li>добавлен дополнительный модуль для yandex-browser</li>
</ul>
<h3>сборка 20240524</h3>
<ul>
<li>обновления на 24.05.2024</li>
<li>при использовании модуля nvidia автоматически загружается модуль nvidia*-uvm</li>
</ul>
<h3>сборка 20240428</h3>
<ul>
<li>обновления на 28.04.2024 (ядро не обновлялось)</li>
<li>драйверы nvidia525 обновлены до nvidia550 (модуль 01-x-drivers-nvidia550)</li>
<li>добавлен пакет nvidia550-cuda-opencl для поддержки cuda</li>
</ul>
<h3>сборка 20240323</h3>
<ul>
<li>обновления на 23.03.2024</li>
<li>модуль alvr пересобран с поддержкой cuda 12.1 (необходимы драйверы nvidia выше 525 серии)</li>
<li>добавлен дополнительный модуль 01-x-drivers-nvidia550 (не входит в сборку)</li>
</ul>
<h3>сборка 20240223</h3>
<ul>
<li>обновления на 23.02.2024</li>
</ul>
<h3>сборка 20240126</h3>
<ul>
<li>обновления на 26.01.2024</li>
<li>добавлен модуль 51-x-alvr с программой ALVR для шлемов виртуальной реальности</li>
</ul>
<h3>сборка 20231223</h3>
<ul>
<li>обновления на 23.12.2023</li>
<li>добавлена утилита yara</li>
<li>исправлена обработка параметров ядра debug debugfs</li>
<li>добавлены 2 сертификата Минцифры. Для добавления в браузер, их необходимо импортировать вручную из папки /usr/share/pki/ca-trust-source/anchors</li>
<li>внесены изменения по безопасности в соответствии с рекомендациями ФСТЭК:</li>
<li>в параметры ядра добавлено init_on_alloc=1 slab_nomerge iommu=force iommu.strict=1 iommu.passthrough=0 randomize_kstack_offset=1 vsyscall=no tsx=off (настройки загрузчика не изменяются при автоматическом обновлении, см. boot/grub/magos/grub_*.cfg boot/grub4dos/local/menu.lst)</li>
<li>пользователь по умолчанию добавлен в группу wheel</li>
<li>для команды su настроен /etc/pam.d/su на проверку наличия в группе wheel</li>
<li>группе wheel разрешен запуск sudo с вводом пароля</li>
<li>рекомендуемые настройки системы добавлены в /etc/sysctl.d/99-fstec_security.conf</li>
<li>изменены права доступа /etc/shadow /etc/skel</li>
<li>права доступа для файлов пользователя изменены (UMASK 077 в /etc/login.defs)</li>
<li>включен запрет входа root через ssh (PermitRootLogin no в /etc/ssh/sshd_config)</li>
</ul>
<h3>сборка 20231124</h3>
<ul>
<li>обновления на 24.11.2023</li>
</ul>
<h3>сборка 20231028</h3>
<ul>
<li>обновления на 28.10.2023</li>
<li>ядро 6.1.58</li>
<li>добавлены пакеты termhelper hspell</li>
</ul>
<h3>сборка 20230929</h3>
<ul>
<li>обновления на 29.09.2023</li>
<li>ядро 6.1.46</li>
</ul>
<h3>сборка 20230824</h3>
<ul>
<li>обновления на 24.08.2023</li>
</ul>
<h3>сборка 20230724</h3>
<ul>
<li>обновления на 24.07.2023</li>
<li>ядро 6.1.38, nvidia525.116.03</li>
<li>обновлен EFI загрузчик</li>
<li>добавлены пакеты rosa-imagewriter rtl8192eu</li>
</ul>
<h3>сборка 20230623</h3>
<ul>
<li>обновления на 23.06.2023</li>
<li>обновленный NetworkManager более не совместим с настройками /etc/sysconfig/network-scripts, для неавтоматических настроек можно использовать шаблоны из <a href="https://github.com/magos-linux/magos-linux/blob/master/make_MagOS/files/patches/flash/MagOS-Data/MagOS.ini">MagOS.ini</a></li>
</ul>
<h3>сборка 20230527</h3>
<ul>
<li>обновления на 27.05.2023</li>
</ul>
<h3>сборка 20230422</h3>
<ul>
<li>обновления на 22.04.2023</li>
<li>переход на ядро 6.1.20 nvidia 390.157 525.89</li>
</ul>
<h3>сборка 20230325</h3>
<ul>
<li>обновления на 25.03.2023</li>
<li>исправлена ошибка в скриптах при создании пользователей, если в именах содержатся точки</li>
</ul>
<h3>сборка 20230223</h3>
<ul>
<li>обновления на 23.02.2023</li>
<li>для совместимости с другими дистрибутивами в скриптах произведена замена egrep fgrep на grep</li>
</ul>
<h3>сборка 20230122</h3>
<ul>
<li>обновления на 22.01.2023</li>
</ul>
<h3>сборка 20221225</h3>
<ul>
<li>обновления на 25.12.2022, в т.ч. ядро 5.15.79</li>
<li>добавлены пакеты exfatprogs mtr</li>
</ul>
<h3>сборка 20221126</h3>
<ul>
<li>обновления на 26.11.2022</li>
<li>qmmp обновлен до текущей версии в хранилищах, добавлены дополнительные дополнения к нему.</li>
</ul>
<h3>сборка 20221025</h3>
<ul>
<li>обновления на 25.10.2022</li>
<li>откат версии qmmp до 1.6.0-3</li>
<li>в связи с особенностями запуска скриптов автозапуска в новой версии plasma исправлен скрипт rc.desktop</li>
</ul>
<h3>сборка 20220924</h3>
<ul>
<li>обновления на 24.09.2022</li>
<li>добавлен пакет vboxadditions-kernel</li>
<li>для видеокарт c драйвером intel по умолчанию отключено DPMS</li>
</ul>
<h3>сборка 20220823</h3>
<ul>
<li>обновления на 23.08.2022</li>
<li>вместо файла /etc/X11/xorg.conf теперь используется /etc/X11/xorg.conf.d/10-driver.conf</li>
<li>исправлены скрипты создания настроек bumblebeed для мобильных видеокарт nvidia</li>
<li>для мобильных видеокарт nvidia драйвер nvidia390 является приоритетным для карт указанных в списке поддерживаемого им оборудования.</li>
<li>развернуты циклические ссылки /usr/share/zoneinfo/posix /usr/libexec/openssh</li>
<li>сборка 2016.64 более не обновляется в связи с отсутствием обновлений</li>
</ul>
<h3>сборка 20220725</h3>
<ul>
<li>обновления на 25.07.2022</li>
<li>отключено автоподключение дисков в Plasma и udisksd</li>
<li>добавлен файл сессии Mate для lightdm</li>
<li>в автозапуск среды Mate добавлен выпадающий терминал qterminal</li>
<li>исправлен скрипт создания сессии по умолчанию для sddm</li>
<li>исправлено переключение lxqt на отсутствующую тему значков oxygen</li>
<li>для видеокарт intel теперь создаётся файл xorg.conf</li>
<li>добавлен дополнительный модуль 51-x-portproton.xzm</li>
<li>сборка 2016.64 не собиралась в связи с отсутствием обновлений за последний месяц</li>
<li>обновление сборок на Яндекс.Диске более не производится в связи с введением платной загрузки файлов более 1ГБ</li>
</ul>
<h3>сборка 20220625</h3>
<ul>
<li>обновления на 25.06.2022</li>
<li>в 2021 сборке драйверы nvidia470 заменены на nvidia515 </li>
<li>добавлены настройки по умолчанию сервера nginx для организации простого http сервера</li>
<li>добавлен пакет minidlna</li>
</ul>
<h3>сборка 20220527</h3>
<ul>
<li>обновления на 27.05.2022</li>
<li>переход на ядро 5.15 в 2021 сборке</li>
<li>добавлен сервер nginx</li>
<li>ipv6 по умолчанию отключен через sysctl</li>
</ul>
<h3>сборка 20220423</h3>
<ul>
<li>обновления на 23.04.2022</li>
<li>добавлен клиент telegram</li>
</ul>
<h3>сборка 20220326</h3>
<ul>
<li>обновления на 26.03.2022</li>
<li>удалены значки продуктов фирмы Meta (организация признана экстремистской в России)</li>
<li>обновлены закладки браузера (удалены ссылки на магазины, которые ввели санкции против российских пользователей)</li>
<li>через файл /etc/hosts заблокированы часть узлов mozilla.com для исключения изменения настроек браузера без ведома пользователя (удаление Яндекса из поиска) </li>
<li>в 2021 сборке изменен алгоритм сжатия с xz на zstd. Это увеличило размер сборки на 12% (250МБ), но в несколько раз сокращает скорость распаковки, что даёт прирост производительности на слабых процессорах.</li>
<li>в связи с техническими работами на сервере ftp, сборка доступна только на Яндекс.Диске. Автоматическое обновление и скачивание с зеркал будут доступны после восстановления работоспособности ftp сервера.</li>
</ul>
<h3>сборка 20220222</h3>
<ul>
<li>обновления на 22.02.2022</li>
<li>ядра 5.4.180 5.10.101</li>
</ul>
<h3>сборка 20220120</h3>
<ul>
<li>обновления на 20.01.2022</li>
<li>ядра 5.4.172 5.10.92</li>
<li>исправлены закладки firefox</li>
<li>исправления скриптов freenx</li>
<li>при наличии шифрованного раздела LUKS и включенном параметре PARTITIONSAUTOMOUNT загрузка системы не останавливается, по умолчанию такие разделы не подключаются. Если включить параметр CRYPTOPARTSAUTOMOUNT, то будет запрашиваться пароль для подключения разделов</li>
<li>
<p>исправления для 2021:</p>
<ul>
<li>добавлены доп.модули 18-squid.xzm 46-devel.xzm</li>
<li>rpm пакеты из дополнительных модулей исключены из базы rpm сборки</li>
<li>из-за проблем с сервером freenx произведён откат пакетов nxproxy nxagent lib64NX<em> lib64xcomp</em> до версии 3.5.0, remmina* до 1.4.1</li>
<li>служба iptables не стартовала на некоторых машинах, добавлена в автозагрузку</li>
</ul>
</li>
</ul>
<h3>сборка 20211225</h3>
<ul>
<li>обновления на 25.12.2021</li>
<li>ядра 5.4.168 5.10.88</li>
</ul>
<h3>сборка 20211127</h3>
<ul>
<li>бета версия MagOS-Linux 2021 на базе ROSA Fresh Desktop 12.1</li>
<li>обновления на 27.11.2021</li>
<li>ядра 5.4.161 5.10.79</li>
<li>в 2016.64 nvidia-current обновлён до версии 450.51, в версии 2021 включены драйверы 390.144 и 470.74</li>
</ul>
<h3>сборка 20211022</h3>
<ul>
<li>обновления на 22.10.2021</li>
<li>ядро 5.4.155</li>
<li>исправлен скрипт steamfix для запуска linux и proton игр из клиента steam</li>
<li>скрипт protontricks заменен пакетом с форка Matoking</li>
</ul>
<h3>сборка 20210925</h3>
<ul>
<li>обновления на 25.09.2021</li>
<li>ядро 5.4.148</li>
</ul>
<h3>сборка 20210827</h3>
<ul>
<li>обновления на 27.08.2021</li>
<li>ядро 5.4.143</li>
</ul>
<h3>сборка 20210720</h3>
<ul>
<li>обновления на 20.07.2021</li>
<li>ядро 5.4.132</li>
<li>исправлена ошибка в скрипте автоматического обновления</li>
<li>при использовании параметра uird.silent отключается вывод сообщений systemd </li>
<li>отключен по умолчанию plymouth в режиме загрузки UEFI</li>
<li>при загрузке с iso образа отключен поиск MagOS-Data, включен тихий режим загрузки (uird.silent)</li>
<li>в uird добавлен русский язык (используется по умолчанию, если не указан параметр lang)</li>
</ul>
<h3>сборка 20210626</h3>
<ul>
<li>обновления на 26.06.2021</li>
<li>ядро 5.4.128</li>
</ul>
<h3>сборка 20210529</h3>
<ul>
<li>обновления на 29.05.2021</li>
<li>ядро 5.4.122</li>
</ul>
<h3>сборка 20210424</h3>
<ul>
<li>обновления на 24.04.2021</li>
<li>ядро 5.4.114</li>
</ul>
<h3>сборка 20210327</h3>
<ul>
<li>обновления на 27.03.2021</li>
<li>ядро 5.4.108</li>
<li>начата работа над платформой Rosa 2019.1</li>
<li>приостановлено ежемесячное обновление сборок 2014*</li>
</ul>
<h3>сборка 20210223</h3>
<ul>
<li>обновления на 23.02.2021</li>
<li>ядра 5.4.99 (2016.64) 4.9.257 (2014.*)</li>
<li>добавлен пакет wizardpen (2016.64)</li>
<li>добавлен модуль 81-chromium с альтернативным браузером chromium-browser-stable (2016.64)</li>
</ul>
<h3>сборка 20210124</h3>
<ul>
<li>обновления на 24.01.2021</li>
<li>ядра 5.4.91 (2016.64) 4.9.252 (2014.*)</li>
<li>добавлены драйверы rtl8188fu (2016.64)</li>
<li>добавлены необходимые библиотеки для работы anydesk (2016.64)</li>
</ul>
<h3>сборка 20201224</h3>
<ul>
<li>обновления на 24.12.2020</li>
<li>ядра 5.4.85 (2016.64) 4.9.248 (2014.*)</li>
<li>исправления для pfs-utils</li>
</ul>
<h3>сборка 20201120</h3>
<ul>
<li>обновления на 20.11.2020</li>
<li>ядра 5.4.78 (2016.64) 4.9.244 (2014.*)</li>
<li>для работы системы bumblebeed с обновленным X сервером сделано автоматическое определение и указание BusID видеокарты в настройках bumblebeed</li>
</ul>
<h3>сборка 20200925</h3>
<ul>
<li>обновления на 25.09.2020</li>
<li>ядра 5.4.66 (2016.64) 4.9.236 (2014.*)</li>
</ul>
<h3>сборка 20200822</h3>
<ul>
<li>обновления на 22.08.2020</li>
<li>ядра 5.4.60 (2016.64) 4.9.233 (2014.*)</li>
<li>добавлен скрипт gethash отображающий хеши паролей для записи в MagOS.ini</li>
<li>отключено уведомление от virtualbox после загрузки рабочего стола</li>
<li>для ускорения загрузки отключены по умолчанию службы ntpdate openswan</li>
</ul>
<h3>сборка 20200711</h3>
<ul>
<li>обновления на 10.07.2020</li>
<li>ядра 5.4.50 (2016.64) 4.9.229 (2014.*)</li>
<li>в центр управления MagOS добавлена команда для обновления системы.</li>
<li>модули в папке MagOS/optional теперь будут обновляться вместе с системой</li>
<li>исправлен скрипт добавления команд в /etc/sudoers.</li>
<li>добавлена команда ntpdate для запуска пользователем через sudo</li>
<li>добавлено автоматическое определение драйвера и настройки службы bumblebeed, создания ссылок /usr/lib(64)/nvidia</li>
<li>скрипты startsteam steamfix теперь используют "optirun -b primus" вместо "primusrun"</li>
<li>в сборку 2016.64 добавлен драйвер broadcom-wl</li>
</ul>
<h3>сборка 20200619</h3>
<ul>
<li>обновления на 19.06.2020</li>
<li>ядра 5.4.46 (2016.64) 4.9.227 (2014.*)</li>
<li>для сборки 2016.64 доступны дополнительные модули 81-mate.xzm 81-newmoon.xzm</li>
</ul>
<h3>сборка 20200508</h3>
<ul>
<li>обновления на 07.05.2020</li>
<li>ядра 5.4.38 (2016.64) 4.9.222 (2014.*)</li>
<li>обновлён syslinux, добавлена поддержка установки на ФС ext4 64бит</li>
<li>при загрузке с предыдущей версии есть возможность обновить последнюю версию системы, либо откатить обновление</li>
<li>удален пакет aircrack-ng</li>
<li>добавлена поддержка рабочей среды mate</li>
<li>исправления в скриптах</li>
<li>
<p>для сборки 2016.64:</p>
<ul>
<li>обновлены драйверы rtlwifi_new и прошивки linux-firmware</li>
<li>доступен дополнительный модуль 81-wine.xzm, при использовании, модуль будет обновлятся вместе со сборкой.</li>
</ul>
</li>
</ul>
<h3>сборка 20200416</h3>
<ul>
<li>исправлена проблема с драйверами nvidia при загрузке в режимах uird.machines uird.changes</li>
<li>исправлена проблема с поддержкой некоторых файловых систем в UIRD (fat32)</li>
</ul>
<h3>сборка 20200414</h3>
<ul>
<li>обновления на 14.04.2020</li>
<li>ядра 5.4.31 (2016.64) 4.9.218 (2014.*)</li>
<li>для параметра загрузки desktop добавлен вариант nolan, отключающий по умолчанию проводную сеть</li>
<li>добавлены параметры ини файла для настройки нескольких мониторов</li>
<li>добавлен уровень загрузки /usr/lib/magos/rc.xorg для запуска скриптов сразу после старта X сервера</li>
<li>если не указан параметр ини файла RUNLDCONFIG, то после загрузки графической системы запускается утилита ldconfig</li>
<li>добавлен скрипт для автоматического перехода на tty2 в случае старта системы без X сервера</li>
<li>добавлен скрипт rc.post.d/60-blacklistdkms.diff для блокировки dkms модулей, в случае, если в ядре есть альтернативный драйвер. Скрипт выключен по умолчанию, используйте только в случае нестабильно работающего dkms драйвера</li>
<li>steam в классическом виде более не использует primusrun на ноутбуках с гибридной графикой. Используйте режим Big picture для активации игровой видеокарты</li>
<li>добавлен скрипт steamfix, позволяющий обходить ошибку неработоспособности оверлея steam. Скрипт также активирует primusrun для игры, если это необходимо. Для использования укажите в параметрах командной строки игры "steamfix %command%"</li>
<li>
<p>изменения в 2016.64:</p>
<ul>
<li>обновлена remmina, для устранения ошибок входа на некоторые типы удалённых серверов</li>
<li>драйверы nvidia-current обновлены до версии 440.82, драйверы nvidia304 заменены на nvidia340</li>
<li>исключён из сборки драйвер broadcom-wl</li>
<li>утилиты и элементы lxqt скрыты из главного меню Plasma</li>
<li>добавлена поддержка plymouth, по умолчанию включен в загрузчике efi, в загрузчике grub4dos выключен</li>
<li>добавлен менеджер входа lightdm, для plymouth используется автоматически, если явно не задан другой менеджер</li>
</ul>
</li>
<li>
<p>начата разработка экспериментальной сборки 2016.Ent для использования на предприятиях. </p>
</li>
</ul>
<h3>сборка 20200326</h3>
<ul>
<li>обновления на 26.03.2020</li>
<li>ядра 4.19.112 (2016.64) 4.9.217 (2014.*)</li>
<li>в параметрах ini файла SERVICES* теперь можно указывать и службы и цели. Службы можно указывать кратко и полно (ntpd или ntpd.service), цели только полно (test.target)</li>
<li>добавлен скрипт для запуска steam в режиме Big Picture</li>
<li>исправлена проблема со службой bumblebeed на ноутбуках с гибридной графикой nvidia. </li>
<li>классический режим steam при использовании bumblebeed неработоснособен из-за конфликтов со встроенными библиотеками steam, используйте режим Big Picture либо запускайте steam без использования primusrun (для запуска игры на карте nvidia укажите в параметрах командой строки игры primusrun %command%)</li>
<li>переписаны скрипты сборки (упрощение алгоритма, использование tmpfs, отвязка от urpmi)</li>
</ul>
<h3>сборка 20200220</h3>
<ul>
<li>обновления на 19.02.2020</li>
<li>ядра 4.19.104 (2016.64) 4.9.214 (2014.*)</li>
<li>исправлена проблема записи в модуль при использовании режима machines в сборках 2014*</li>
<li>для сборки 2016.64 импортирован основной ключ, которым подписано большинство пакетов Росы</li>
<li>исправления для pfs-utils</li>
<li>экспериментальный режим сохранения toxzm</li>
</ul>
<h3>сборка 20200123</h3>
<ul>
<li>обновления на 23.01.2020</li>
<li>ядра 4.19.97 (2016.64) 4.9.210 (2014.*)</li>
<li>исправлена проблема записи CD дисков</li>
<li>исправления для pfs-utils</li>
</ul>
<h3>сборка 20191226</h3>
<ul>
<li>обновления на 25.12.2019</li>
<li>ядра 4.19.91 (2016.64) 4.9.207 (2014.*)</li>
<li>исправлена ошибка cups при добавлении smb принтера</li>
<li>добавлен пакет pigz</li>
<li>добавлен скрипт beep )</li>
<li>
<p>изменения в скриптах для совместимости модуля magos с Ubuntu и Mageia по предложениям ingvaro (см. форум):</p>
<ul>
<li>скрипты /etc/rc.d /lib/systemd/ перенесены в /usr/lib/magos</li>
<li>отключено сохранение в модуль, в случае если система не была загружена (перезагрузка во время включения)</li>
<li>создан новый этап загрузки /usr/lib/magos/rc.network.d , запускаемый после цели network-online. часть сетевых скриптов перенесена из /usr/lib/magos/rc.local.d в /usr/lib/magos/rc.network.d</li>
<li>добавлен новый параметр ini файла SERVICESUNMASK</li>
<li>скрипт /usr/lib/magos/scripts/autoexec перенесён в /usr/lib/magos/rc.d/rc.desktop</li>
<li>файл настройки /etc/sysconfig/MagOS перенесён в /etc/MagOS/config</li>
</ul>
</li>
</ul>
<h3>сборка 20191122</h3>
<ul>
<li>обновления на 21.11.2019</li>
<li>ядра 4.19.84 (2016.64) 4.9.202 (2014.*)</li>
<li>в настройках по умолчанию для qmmp снижена громкость до 50% от максимальной</li>
<li>добавлены программы dbview inxi</li>
</ul>
<h3>сборка 20191024</h3>
<ul>
<li>обновления на 23.10.2019</li>
<li>ядра 4.19.80 (2016.64) 4.9.197 (2014.*)</li>
<li>исправления для скриптов и настроек рабочей среды i3</li>
<li>добавлены программы fsarchiver qt5-fsarchiver xdotool sshpass</li>
</ul>
<h3>сборка 20190925</h3>
<ul>
<li>обновления на 25.09.2019</li>
<li>ядра 4.19.75 (2016.64) 4.9.194 (2014.*)</li>
<li>изменены настройки EFI загрузчика. Добавлены 32 и 64-битные версии grub для efi с поддержкой файловых систем и образов (загружается автоматически, в случае если выключен SecureBoot)</li>
<li>в 2016.64 добавлена мозаичная рабочая среда i3 (рассчитана на опытных пользователей и разработчиков)</li>
<li>добавлены пакеты ms-sys libwebp-tools ranger(2016.64)</li>
</ul>
<h3>сборка 20190824</h3>
<ul>
<li>обновления на 23.08.2019</li>
<li>ядра 4.19.67 (2016.64) 4.9.189 (2014*)</li>
</ul>
<h3>сборка 20190712</h3>
<ul>
<li>обновления на 11.07.2019</li>
<li>ядра 4.19.57 (2016.64) 4.9.184 (2014*)</li>
<li>отключен запрос выбора оконного менеджера при страте lxqt</li>
<li>отключено уведомление о работе дополнений в отдельных окнах firefox</li>
<li>исправления для pfs-utils</li>
</ul>
<h3>сборка 20190625</h3>
<ul>
<li>обновления на 25.06.2019</li>
<li>ядро 4.9.183</li>
<li>исправления для pfs-utils</li>
</ul>
<h3>сборка 20190511</h3>
<ul>
<li>юбилейная сборка! 10 лет назад, 11 мая 2009 года, вышла первая сборка MagOS-Linux!</li>
<li>обновления на 10.05.2019</li>
<li>ядро 4.9.174</li>
<li>добавлена кроссплатформенная программа qtox для общения с помощью текстовых сообщений, аудио и видео связи по защищённому от прослушки корпорациями и АНБ протоколу точка-точка </li>
<li>в файл документации добавлен раздел UIRD со страницы проекта</li>
<li>в 2016.64 обновлены драйверы nvidia-current до версии 418.74</li>
<li>в 2016.64 обновлён xscreensaver, отключено предупреждение об обновлении</li>
</ul>
<h3>сборка 20190420</h3>
<ul>
<li>обновления на 19.04.2019</li>
<li>ядро 4.9.169</li>
<li>исправлен конфликт библиотек, мешавший работе samba и зависящим программам (в т.ч. mplayer)</li>
<li>исправлен скрипт загрузки программ вместо графической среды (параметр загрузки desktop=)</li>
</ul>
<h3>сборка 20190323</h3>
<ul>
<li>обновления на 23.03.2019</li>
<li>ядро 4.9.164</li>
<li>исправления для squashtest</li>
<li>в 2016.64 обновлены драйверы nvidia-current до версии 418.56, что решает проблему прозрачных объектов во многих играх, запускаемых с помощью Proton в Steam</li>
</ul>
<h3>сборка 20190222</h3>
<ul>
<li>обновления на 22.02.2019</li>
<li>ядро 4.9.158</li>
<li>исправлена ошибка определения видеокарты при использовании системного профиля</li>
<li>исправлена ошибка отображения содержимого xzm архивов в mc при наличии пробелов в именах файлов</li>
</ul>
<h3>сборка 20190125</h3>
<ul>
<li>обновления на 25.01.2019</li>
<li>ядро 4.9.151</li>
<li>в 2016.64 обновлены драйверы nvidia-current до версии 410.93</li>
<li>загрузчик grub4dos обновлён до версии 0.4.6a-2019-01-01, что решает проблему с подключением iso образов</li>
<li>добавлена поддержка ntfs в загрузчике EFI</li>
<li>изменен механизм работы параметра ини файла SERVICESNOSTART, добавлен параметр SERVICESMASK</li>
<li>время ожидания останова служб systemd снижено с 1.5 мин до 10 секунд, отключена служба adb</li>
<li>переписаны скрипты автоматического обновления</li>
</ul>
<h3>сборка 20181222</h3>
<ul>
<li>обновления на 22.12.2018</li>
<li>ядро 4.9.146</li>
<li>драйверы nvidia-current nvidia304 во всех сборках пересобраны для устранения конфликтов с ссылками /usr/lib(64)/nvidia</li>
<li>в переменной AUTOEXEC ини файла теперь можно использовать выражения и инструкции bash</li>
<li>при обновлении системы добавлено автоматическое обновление модулей с сервера magos.sibsau.ru/repository/modules/</li>
<li>в скрипте startsteam добавлен обход ошибки steam с самопроизвольным переключением клиента на английский язык</li>
<li>2016.64: драйверы nvidia обновлены до версий 304.137 и 410.78</li>
<li>2016.64: обновлены драйверы беспроводной сети rtl8812au rtlwifi_new, добавлены драйверы rtl8192eu rtl8812au rtl8821cu</li>
<li>2016.64: добавлен проигрыватель qmplay2 взамен rosa-media-player, добавлена головоломка tetzle</li>
<li>2016.64: устранена проблема с запуском  сервера DHCP (обновлен пакет dhcp-server)</li>
</ul>
<h3>сборка 20181123</h3>
<ul>
<li>обновления на 22.11.2018</li>
<li>ядро 4.9.137</li>
<li>утилиты urpm2xzm и urpm2pfs объединены в одну с привычным названием urpm2xzm, в модулях собранных новым urpm2xzm сохраняется информация по которой модуль можно собрать заново. Например для обновления. Делается так: urpm2xzm модуль.xzm. Остальные ключи и возможности смотрите в справке утилиты.</li>
<li>в тестовом режиме добавлена утилита chroot2pfs, позволяет делать модули из изменений сделанных в chroot. Например
chroot2pfs -o nano.xzm --command urpmi nano, соберет модуль с nano. Такие модули также пересобираются как и модули urpm2xzm.</li>
<li>добавлен новый параметр ини файла для включения ipv6 по умолчанию на всех сетевых интерфейсах</li>
<li>в настройки загрузчиков добавлен автоматический поиск раздела с MagOS в случае, если его нет на разделе с загрузчиком</li>
</ul>
<h3>сборка 20181026</h3>
<ul>
<li>обновления на 25.10.2018</li>
<li>ядро 4.9.135</li>
<li>исправления в pfs-utils (urpm2pfs pfsextract mkpfs)</li>
<li>добавлен скрипт shareinternet для раздачи Интернета андроид устройству, подключенному через USB</li>
</ul>
<h3>сборка 20180928</h3>
<ul>
<li>обновления на 27.09.2018</li>
<li>ядро 4.9.128</li>
<li>обновление pfs-utils до версии 4</li>
<li>для тонкой настройки игр в steam обновлён скрипт winetricks, добавлен скрипт protontricks</li>
<li>исправлен скрипт запуска steam, в случае если на видеокартах nvidia optimus нет невозможности использовать bumblebeed</li>
<li>исправлены настройки lxqt. Настройки вынесены в домашний каталог пользователя.</li>
</ul>
<h3>сборка 20180825</h3>
<ul>
<li>обновления на 25.08.2018</li>
<li>ядро 4.9.124</li>
</ul>
<h3>сборка 20180718</h3>
<ul>
<li>обновления на 18.07.2018</li>
<li>ядро 4.9.112</li>
<li>буфер обмена плазмы по умолчанию теперь синхронизирован с выделением мышью</li>
</ul>
<h3>сборка 20180622</h3>
<ul>
<li>обновления на 22.06.2018</li>
<li>ядро 4.9.109</li>
<li>исправлен скрипт блокировки хранителя экрана</li>
<li>исправлена утилита urpm2pfs</li>
<li>исправлены ярлыки sweeper krename в главном меню</li>
</ul>
<h3>сборка 20180525</h3>
<ul>
<li>обновления на 24.05.2018</li>
<li>ядро 4.9.101</li>
<li>ярлык главного меню plasma5-kdeconnect перенесён в "Настройки-Оборудование"</li>
<li>добавлена возможность использовать в параметре загрузки desktop произвольные значения для запуска приложений</li>
</ul>
<h3>сборка 20180427</h3>
<ul>
<li>обновления на 27.04.2018</li>
<li>ядро 4.9.95</li>
<li>переписаны скрипты выключения, для ускорения процесса и отключения сложных файловых систем (aufs, cryptsetup)</li>
<li>пакет kdeconnect заменён на plasma5-kdeconnect</li>
<li>эффекты плазмы отключены по умолчанию из-за конфликта с драйверами intel</li>
<li>для встроенных видеокарт Intel HD XXX вместо драйвера vesa используется fbdev</li>
</ul>
<h3>сборка 20180325</h3>
<ul>
<li>обновления на 24.03.2018</li>
<li>ядро ядро 4.9.88</li>
<li>файловый менеджер mc теперь распознаёт xzm модули как архивы: можно входить в модуль, как в архив, копировать из него файлы, просматривать текстовые файлы. xzm модули подсвечиваются тем же цветом, что и архивы</li>
<li>новый параметр загрузки uird.freemedia (применяется вместе uird.copy2ram), который отключает носитель перед стартом системы и создаёт правила для автоматического подключения устройств, если снова подключить устройство</li>
<li>перенастроен systemd, теперь система загружается без ошибок на незагруженные дополнительные службы, служба laptop-mode загружается только в случае наличия батареи, отключена служба systemd-resolved</li>
<li>перенастроен кеширующий сервер pdnsd, снова добавлен в автозагрузку, в связи с тем что от systemd-resolved не получилось добиться нормального кеширования запросов, в NetworkManager отключен перехват resolved.conf</li>
<li>при указании параметра загрузки flightmode беспроводные устройства блокируются на разных уровнях загрузки</li>
<li>изменены настройки compiz-fusion по умолчанию, отключена большая часть стандартных эффектов Plasma</li>
<li>изменена тема Plasma (взята за основу Breeze).</li>
<li>новые настройки xscreensaver. Через 5 минут простоя будут отображаться фото из папки по умолчанию для хранителя экрана MagOS-Data/backgrounds/screensaver/Default. Запрос пароля отменён. Настройки расположены в ~.xscreensaver. Добавлен дополнительный скрипт xss_heartbeat, через который происходит запуск харнителя, он же не даёт срабатывать хранителю при просмотре видео в программах и браузере.</li>
<li>исправлена ошибка подключения при старте разделов с одинаковыми именами</li>
<li>переработаны утилиты создания модулей rpmdrake2xzm, urpm2xzm, преобразования модулей conv4mod</li>
<li>исправлены скрипты /usr/lib/magos/scripts и дополнительные действия для dolphin. Добавлены ключи -b -f для dir2xzm. Удалены устаревшие и некоторые дублирующие скрипты.</li>
<li>исправлена загрузка с бездисковых терминалов через pxe+tftp+nfs</li>
<li>исправлены настройки samba сервера, переписан скрипт создающий пользователей и пароли samba</li>
<li>изменены некоторые сочетания горячих клавиш (список см при нажатии Win+k)</li>
<li>обновлён winetricks</li>
<li>исправления цвета фона активного выделения для темы MagOS-dark</li>
<li>обновлен раздел документации на Wiki странице</li>
<li>документация из wiki сконвертирована в html файл, который заместил файл readme.html в архиве сборки и "Справочную информацию" в главном меню. Документация будет обновляться ежемесячно.</li>
<li>добавлены пакеты gtk-engines2 python-markdown, в сборку 2016.64 добавлены утилиты leafpad chbg kdeconnect</li>
</ul>
<h3>сборка 20180224</h3>
<ul>
<li>обновления на 24.02.2018</li>
<li>ядро 4.9.83, с дополнительными механизмами противодействия аппаратным уязвимостям Spectre и Meltdown</li>
<li>исправлен скрипт подключения к домену</li>
<li>добавлены настройки тем для старых версий gtk3 (сборки 2014red, 2014.64), что устраняет проблемы с отображением граф. элементов в программах на gtk3 (firefox, remmina)</li>
</ul>
<h3>сборка 20180126</h3>
<ul>
<li>обновления на 26.01.2018</li>
<li>ядро 4.9.77, с заплатами против Spectre и Meltdown</li>
<li>
<p>изменения в uird:</p>
<ul>
<li>busybox собирается из git, а не копируется из системы, что позволило восстановить работоспособность утилиты resume.</li>
<li>добавлена возможность подключения образов виртуальных машин с помощью qemu-nbd (в т.ч. образов vitualbox)</li>
</ul>
</li>
<li>
<p>доработан обработчик ini файла, теперь возможно менять права доступа к файлам, добавлять  и удалять строки в текстовых файлах</p>
</li>
<li>изменен алгоритм добавления групп пользователям (на случай указания несуществующей группы)</li>
<li>исправлены темы MagOS MagOS-green MagOS-dark</li>
<li>добавлена тема MagOS-grey (копия стандартной темы из Rosa Fresh R10)</li>
<li>добавлен параметр загрузки theme для выбора темы (одной из MagOS MagOS-green MagOS-grey MagOS-dark)</li>
<li>изменены настройки по умолчанию для doublecmd</li>
<li>добавлены пути /usr/lib/magos/scripts в /etc/sudoers, добавлена группа sudo и настройки для неё в /etc/sudoers</li>
<li>исправлен скрипт формирования обоев. при определении разрешения экрана учитывается</li>
<li>только edid, если не удалось получить разрешения, используется 1920х1080. (в т.ч. решает проблему с низким качеством картинки на виртуальных машинах)</li>
<li>добавлены пакеты xmlstarlet qemu-nbd</li>
<li>
<p>исправления в сборке 2016.64:</p>
<ul>
<li>исправлено отображение значка главного меню в plasma</li>
<li>добавлены пакеты для gvfs (в LXQT при нажатии на Сеть или Компьютер выводилась ошибка)</li>
<li>добавлена утилита spectacle вместо ksnapshot, plasma5-ark вместо ark </li>
<li>для LXQT назначен sddm в качестве менеджера входа</li>
<li>исправлены настройки по умолчанию plasma</li>
<li>отключена страница конфиденциальности при старте firefox</li>
<li>добавлен значок для magos-ctrl-center</li>
<li>добавлены действия для dolphin</li>
<li>обновлён скрипт steam (решает проблему с запуском на картах nvidia optimus)</li>
<li>количество модулей сокращено с 33 до 12</li>
</ul>
</li>
</ul>
<h3>сборка 20171222</h3>
<ul>
<li>обновления на 22.12.2017</li>
<li>ядро 4.9.70</li>
<li>сборка на платформе Rosa Fresh 2016.1 64 Бит</li>
</ul>
<h3>сборка 20171127</h3>
<ul>
<li>обновления на 26.11.2017</li>
<li>ядро 4.9.60</li>
<li>драйверы fglrx удалены из сборки (видеокарты полностью поддерживаются свободным драйвером)</li>
<li>криптоконтейнеры подключаются через cryptsetup, setup для этого больше не применяется, использовавшиеся бинарные файлы удалены из сборки</li>
<li>переписаны утилиты createloop mountloop umountloop для работы через cryptsetup</li>
<li>
<p>переделаны загрузочные скрипты (через автоматическое обновление boot обновляться не будет, если есть необходимость, то на установленных системах необходимо выполнить обновление вручную)</p>
<ul>
<li>скрипты установки переписаны и проверены в ОС Linux, Windows XP,7,8,10.</li>
<li>универсальный скрипт запуска перенесён в /boot/magos/Install.bat</li>
<li>поддержка установки на ext2/3/4 ntfs fat32 осуществляется связкой syslinux+grub4dos</li>
<li>поддержка установки на xfs btrfs с помощью syslinux (в linux)</li>
<li>поддержка установки на носители без таблицы разделов «superfloppy» (поддерживаются не всеми bios)</li>
<li>поддержка установки на носители с таблицей разделов gpt (только в linux, в windows возможно установка вручную только на носители с установленным флагом boot_legacy)</li>
<li>переписан gfxmenu для совместимости с syslinux</li>
<li>в меню grub4dos добавлен пункт для загрузки с ISO/DVD (отображается только в этом случае)</li>
<li>в меню grub4dos добавлены пункты для загрузки с предыдущей версии MagOS (отображается только при наличии папки MagOS.bak)</li>
<li>в случае запуска универсального скрипта /boot/magos/install.bat в Windows с несъёмного диска, запускается скрипт добавления системы в BCD загрузчик, в остальных случаях - скрипт установки syslinux</li>
<li>из boot удалены все сторонние утилиты, кроме memtest и mkisofs</li>
</ul>
</li>
<li>
<p>в uird добавлен параметр uird.aria2ram - позволяет загрузить источник в RAM без предварительного монтирования. Поддерживаются все протоколы доступные для aria2c включая bittorrent (magnet и торрент файл). С aria2c возможна параллельная закачка файла с нескольких источников в т.ч. по разным протоколам, что теоретически позволит увеличить скорость загрузки до пропускной способности канала за счет закачки с нескольких зеркал и/или битторрент.</p>
</li>
<li>
<p>Обновлен urpm2pfs</p>
<ul>
<li>Задаваемое имя модуля может содержать путь. Допустимо, в качестве аргумента, указать существующий каталог, модуль будет создан в указанном каталоге с именем по умолчанию.</li>
<li>Обновление базы urpmi производится только при использовании опции »-u | –urpmidb», а также если версия какого-либо пакета устарела в текущих списках.</li>
<li>Добавлена опция для автоматического подключения созданного модуля.</li>
</ul>
</li>
<li>
<p>добавлено автозавершение параметров (по кнопке TAB в консоли) для утилит urpm2pfs urpm2xzm urpm2lzm, по аналогии с утилитами urpm*</p>
</li>
</ul>
<h3>сборка 20171021</h3>
<ul>
<li>обновления на 21.10.2017</li>
</ul>
<h3>сборка 20170923</h3>
<ul>
<li>обновления на 23.09.2017</li>
<li>ядро 4.1.44</li>
<li>ускорен поиск источников в uird</li>
<li>слой uird.mounts монтируется первым, до uird.from. Позволяет еще немного ускориться за счет предварительного монтирования нужных разделов. uird.mounts=/dev/sda1::/mnt/livemedia (Побочным эффектом будет корректное отображение раздела в dolphin).</li>
<li>добавлена возможность передачи параметров монтирования для uird.mounts, uird.from, uird.home uird.from=/dev/sda1/MagOS::noexec+ro;/MagOS-Data</li>
</ul>
<h3>сборка 20170827</h3>
<ul>
<li>обновления на 27.08.2017</li>
<li>для видеокарт 1002:68e0, 10de:1050 используется свободные драйвера, в связи с неработоспособностью фирменных.</li>
<li>исправлена ошибка подключения криптоконтейнера из uird</li>
</ul>
<h3>сборка 20170721</h3>
<ul>
<li>обновления на 20.07.2017</li>
<li>добавлен скрипт для создания номера машины (/etc/machine-id). Номер может создаваться автоматически в зависимости от встроенного оборудования (см вывод lspci по шине 00), вычисляться случайным образом, либо может быть задан напрямую. Управление номером осуществляется с помощью нового параметра MACHINEID в MagOS.ini</li>
<li>изменения в rpmdbreset, добавлен новый параметр –rebuild позволяет перестроить базу rpm в актуальное состояние после удаления части модулей из base. Вторым параметром ($2) можно указать маску для модулей, базы rpm из которых будут использованы.</li>
<li>новый скрипт urpm2pfs, аналог urpm2xzm, название изменено из-за изменения синтаксиса, подробности в соответствующей ветке форума.</li>
<li>исправления pfs-utils</li>
</ul>
<h3>сборка 20170623</h3>
<ul>
<li>обновления на 23.06.2017</li>
</ul>
<h3>сборка 20170526</h3>
<ul>
<li>обновления на 26.05.2017</li>
<li>исправление pfs утилит</li>
<li>исправления modmnger для работы через pfs утилиты</li>
</ul>
<h3>сборка 20170423</h3>
<ul>
<li>обновления на 23.04.2017</li>
<li>добавлены pfs утилиты</li>
<li>пользовательский кеш картинок ~.thumbnails перенесён из /tmp в /var/tmp</li>
<li>исправлена ошибка, когда при загрузке с iso на рабочем столе не появлялся значок установщика</li>
</ul>
<h3>сборка 20170325</h3>
<ul>
<li>обновления на 24.03.2017</li>
<li>алгоритм сжатия при сохранении в модуль изменён на более быстрый (-b 512K -comp lz4 -Xhc)</li>
<li>параметры сжатия в модуль можно настроить через MagOS.ini</li>
<li>в параметре загрузки xdriver можно указывать значение vesa</li>
<li>в связи с неработоспособностью текущего драйвера intel на видеокартах Intel HD Graphics XХX, для этих видеокарт используется драйвер vesa по умолчанию</li>
<li>при использовании видеодрайверов nvidia* nouveau fglrx, соответствующие модули помещаются в предзагрузку /etc/modprobe.preload</li>
<li>исправления usr/lib/magos/functions</li>
</ul>
<h3>сборка 20170227</h3>
<ul>
<li>обновления на 27.02.2017</li>
<li>ядро 4.1.38</li>
<li>исправлена проблема с зависанием rpm при работе в режиме сохранения в папку или в *.img файл</li>
<li>добавлен скрипт squashtest, для определения оптимального для вашей системы алгоритма сжатия модулей.</li>
<li>добавлен скрипт magosrepack, для перепаковки системных модулей по итогам теста squashtest. Спасибо ilfat за проделанную работу.</li>
<li>изменены настройки сжатия для базовых модулей и скриптов сжатия (xz -Xbcj x86)</li>
<li>пакет gxneur заменен на kdeneur</li>
<li>правка скриптов /usr/lib/magos/* (почти все скрипты «отвязаны» от liblinuxlive)</li>
</ul>
<h3>сборка 20170128</h3>
<ul>
<li>обновления на 28.01.2017, в т.ч. драйверы nvidia</li>
<li>произведен полный переход на UIRD, initrd будет оставлен в целях совместимости и как альтернативное решение</li>
<li>обновлен gfxmenu загрузчика grub4dos (исправлены пункты меню, параметры загрузки)</li>
<li>новый параметр flightmode, который по умолчанию отключает беспроводные устройства</li>
<li>дополнительный модуль 81-libs4primus.xzm переименован в 81-libs4mesagl32.xzm</li>
<li>в скрипте startsteam предусмотрена загрузка модуля 81-libs4mesagl32.xzm в случае использования MesaGL (для драйверов intel, nouveau и пр.)</li>
</ul>
<h3>сборка 20161225</h3>
<ul>
<li>обновления на 25.12.2016</li>
<li>исправлена ошибка подключения шифрованного контейнера из initrd</li>
<li>исправлена ошибка определения видеокарты при использовании uird</li>
<li>исправлен файл настройки xbindkeys</li>
<li>добавлен пакет kio-mtp</li>
<li>загрузка в чистом режиме производится с помощью uird</li>
<li>в фотоальбом добавлены новые обои для рабочего стола (19 шт.) и фоны для хранителя экрана (22 шт.)</li>
<li>добавлены правила udev для поддержки Steam контроллера</li>
<li>новый параметр desktop=steam для запуска клиента Steam в качестве графической среды</li>
<li>добавлен скрипт startsteam, задачей которого является запуск оконного менеджера openbox, звукового сервера pulseaudio, загрузка библиотек для primusrun (при необходимости)</li>
</ul>
<h3>сборка 20161126</h3>
<ul>
<li>ядро 4.1.34-2</li>
<li>обновления на 25.11.2016</li>
</ul>
<h3>сборка 20161026</h3>
<ul>
<li>обновления на 25.10.2016</li>
<li>исправлена проблема с определением старых nvidia видеокарт, которые не поддерживаются драйвером nvidia-current</li>
<li>если видеокарта nvidia не поддерживается фирменными драйверами, по умолчанию используется драйвер nouveau</li>
<li>в initrd добавлены модули ядра ohci-pci ohci-plat-hcd</li>
<li>добавлен скрипт для загрузки модулей ядра, прописанных в /etc/modprobe.preload</li>
</ul>
<h3>сборка 20160924</h3>
<ul>
<li>ядро 4.1.33-nrj</li>
<li>обновления на 23.09.2016</li>
<li>обновлены прошивки оборудования в модуле firmware. Пакеты kernel-firmware* заменены на linux-firmware</li>
<li>добавлены пакеты android-file-transfer android-tools lz4</li>
</ul>
<h3>сборка 20160824</h3>
<ul>
<li>обновления на 24.08.2016</li>
<li>добавлена утилита hardinfo</li>
</ul>
<h3>сборка 20160723</h3>
<ul>
<li>обновления на 23.07.2016</li>
</ul>
<h3>сборка 20160628</h3>
<ul>
<li>обновления на 27.06.2016</li>
<li>ядро 4.1.25</li>
<li>исправлен файл настроек bumblebee (по умолчанию используется драйвер nvidia-current)</li>
<li>значок vidalia в главном меню перенесён в Утилиты-Безопасность</li>
<li>в связи с изменениями в программном коде firefox, настройки по умолчанию и закладки задаются через firefox.cfg и distribution.ini</li>
</ul>
<h3>сборка 20160527</h3>
<ul>
<li>обновления на 27.05.2016</li>
<li>ядро 4.1.22</li>
<li>nvidia-current 364.15</li>
<li>в сборку 2014.64 добавлены 32битные источники (по умолчанию отключены)</li>
</ul>
<h3>сборка 20160423</h3>
<ul>
<li>обновления на 22.04.2016</li>
</ul>
<h3>сборка 20160326</h3>
<ul>
<li>обновления на 26.03.2016</li>
<li>ядро 4.1.19</li>
<li>java-1.8.0-openjdk</li>
<li>добавлен пакет dpkg</li>
<li>Экспериментальный режим загрузки обычного линукс дистрибутива в «MagOS» режиме.</li>
</ul>
<h3>сборка 20160227</h3>
<ul>
<li>обновления на 26.02.2016</li>
<li>ядро 4.1.16</li>
</ul>
<h3>сборка 20160123</h3>
<ul>
<li>обновления на 22.01.2016</li>
<li>ядро 4.1.15</li>
<li>обновлены закладки для firefox</li>
<li>в профиле пользователя по умолчанию создана ссылка для сохранения клиента Steam в /mnt/livedata/MagOS-Data/steam</li>
</ul>
<h3>сборка 20151228</h3>
<ul>
<li>обновления на 27.12.2015</li>
<li>ядро 4.1.13</li>
<li>драйверы nvidia-current 358.16-3, fglrx 15.201.1151, nvidia304 304.131</li>
<li>pulseaudio включено по умолчанию, для переключения на ALSA используйте параметр PULSEAUDIO ini файла</li>
<li>служба virtualbox включена по умолчанию</li>
<li>управление настройками ДНС осуществляется службой systemd-resolved, для настройки на статичные ДНС серверы используйте /etc/systemd/resolved.conf</li>
<li>в firefox по умолчанию отключено требование использовать только подписанные дополнения</li>
<li>игра pysol заменена на aisleriot, добавлены игры atomix lbreakout2</li>
<li>удалены пакеты fm_scripts magic_keys magos-tools modem_connect modmnger, их содержимое перенесено в модуль 88-magos</li>
</ul>
<h3>сборка 20151130</h3>
<ul>
<li>обновления на 29.11.2015</li>
<li>исправлена обработка параметра XORG_RES ini файла</li>
<li>отключено создание файлов coredump в systemd, что приводило к замедлению работы и исчерпанию места на корневой файловой сиcтеме при запуске некоторых игр в steam</li>
<li>добавлено правило udev, запрещающее ошибочное создание устройств джойстика для некоторых клавиатур и мышек (например, A4Tech X7)</li>
<li>переписаны скрипты сборки для большей универсальности</li>
<li>скрипты, темы и файлы настроек, дополняющие базовый дистрибутив, вынесены в отдельный модуль 88-magos</li>
</ul>
<h3>сборка 20151030</h3>
<ul>
<li>обновления на 29.10.2015</li>
<li>ядро 3.14.53</li>
<li>обновлены драйверы nvidia-current fglrx</li>
<li>унифицированы стартовые скрипты</li>
<li>исправлен скрипт выбора и настройки аудиокарты ALSA</li>
<li>исправлен скрипт создания копии базы rpm пакетов в режиме сохранения изменений.</li>
<li>другие мелкие исправления</li>
</ul>
<h3>сборка 20150925</h3>
<ul>
<li>обновления на 25.09.2015</li>
<li>добавлены драйверы для wifi bluetooth карт из пакетов rtl8188eu, rtl8812au, rtlwifi_new</li>
<li>добавлен скрипт syschanges для анализа изменения файлов</li>
<li>переписан скрипт определения видеокарт</li>
<li>автовключение службы bumblebee для ноутбуков с видеокартами nvidia optimus</li>
<li>исправлена обработка параметра xdriver=fglrx для ноутбуков с видеокартами intel + amd/ati</li>
<li>добавлены параметры ini файла для выбора звукового устройства ALSA по умолчанию</li>
<li>выбор второго устройство ALSA по умолчанию, в случае если на первом устройстве HDMI вывод (для ноутбуков DEXP 15-NV-940)</li>
<li>восстановлена работа параметра NUMLOCK ini файла</li>
<li>добавлена утилита primusrun для запуска steam, игр, других OpenGL программ на картах nvidia optimus</li>
<li>сборка на платформе 2012lts не обновлялась в связи с отсутствием обновлений</li>
</ul>
<h3>сборка 20150718</h3>
<ul>
<li>обновления на 17.07.2015</li>
<li>ядро 3.14.46-nrj для 2014.64</li>
<li>загрузчик uefi заменен на версию от Росы.</li>
</ul>
<h3>сборка 20150626</h3>
<ul>
<li>обновления на 26.06.2015</li>
<li>ядро 3.14.43-nrj для 2014.64</li>
<li>добавлен загрузчик uefi для режима secureboot</li>
<li>добавлены скрипты для автоматического обновления</li>
<li>настройки клавиатуры для консоли и графического сервера устанавливается автоматически на основе системной локали</li>
<li>добавлена поддержка параметра загрузки xres для 2014.64</li>
</ul>
<h3>сборка 20150523</h3>
<ul>
<li>обновления на 23.05.2015</li>
<li>ядро 3.14.39-nrj для 2014.64</li>
<li>исправлена ситуация когда при работе в КДЕ на подключение дисков требовался пароль администратора.</li>
<li>обновлен пакет fm_scripts</li>
<li>небольшие исправления для скриптов addmemory conky_orange magos-install</li>
<li>раскладка клавиатуры и шрифт консоли теперь настраиваются через /etc/vconsole.conf (к примеру, через ini файл)</li>
</ul>
<h3>сборка 20150424</h3>
<ul>
<li>обновления на 24.04.2015</li>
<li>ядро 3.14.37-nrj для 2014.64</li>
<li>заменены обои и фото для хранителя экрана, теперь в сборку будет попадать 30 случайно выбранных фото из материала, который присылают пользователи</li>
<li>исправлена обработка ini файла для UIRD</li>
<li>поддержка параметра CMDLINE ini файла для UIRD</li>
<li>поддержка параметра PARTITIONSAUTOMOUNT для UIRD</li>
</ul>
<h3>сборка 20150328</h3>
<ul>
<li>обновления на 28.03.2015</li>
<li>ядро 3.14.34-nrj для 2014.64</li>
<li>фоновые картинки и для рабочего стола и хранителя экрана выведены из системы в папку MagOS-Data/backgrounds</li>
<li>папка для хранения данных steam выведена из профиля пользователя в папку MagOS-Data/steam</li>
<li>исправлено некорректное описание ключей источников urpmi в 2014.64, приводившее к предупреждениям о неправильных подписях пакетов</li>
<li>исправлено определение видеокарты для UIRD</li>
<li>продолжаем тестировать UIRD</li>
</ul>
<h3>сборка 20150227</h3>
<ul>
<li>обновления на 27.02.2015</li>
<li>ядро 3.14.30-nrj для 2014.64, 3.10.63-nrjQL для 2012lts</li>
<li>в 2014.64 удалена программа radiotray.</li>
<li>продолжаем тестировать UIRD, в загрузчике для 2014.64 добавлена специальная строка для запуска UIRD</li>
</ul>
<h3>сборка 20150123</h3>
<ul>
<li>обновления на 23.01.2015</li>
<li>переход на платформу Rosa 2014 x64 как основную</li>
<li>прекращение поддержки 2012 Fresh со следующего месяца</li>
<li>добавлен UIRD, пока в статусе бета-версии</li>
<li>драйверы видеокарт для nvidia и ati вынесены в отдельные модули</li>
</ul>
<h3>сборка 20141224</h3>
<ul>
<li>обновления на 24.12.2014</li>
<li>ядро 3.10.61-nrj</li>
<li>добавлен мастер пошаговой установки MagOS</li>
<li>в версии 2012 убран автозапуск службы tor</li>
</ul>
<h3>сборка 20141128</h3>
<ul>
<li>обновления на 27.11.2014</li>
<li>в 2012lts версии добавлен менеджер модулей</li>
<li>в центре управления MagOS исправлен запуск менеджера модулей</li>
<li>обновлены скрипты для файлового менеджера share.ftp share.nfs</li>
<li>в скриптах MagOS на разных уровнях загрузки введена возможность отладки через параметр DEBUGMODE</li>
</ul>
<h3>сборка 20141025</h3>
<ul>
<li>обновления на 24.10.2014</li>
<li>исправлена работа параметра lang в части запуска графического сервера</li>
<li>английское меню загрузчика /boot/grub4dos/menu.lst запускает систему на английском языке</li>
<li>в русском меню загрузчика /boot/grub4dos/local/menu.lst сделана ссылка на английское меню</li>
</ul>
<h3>сборка 20140926</h3>
<ul>
<li>обновления на 26.09.2014</li>
<li>ядро 3.10.55-nrj</li>
</ul>
<h3>сборка 20140819</h3>
<ul>
<li>обновления на 18.08.2014</li>
<li>ядро 3.10.53-nrj</li>
</ul>
<h3>сборка 20140726</h3>
<ul>
<li>обновления на 25.07.2014</li>
<li>ядро 3.10.46</li>
<li>удалены пакеты cuneiform-linux yagf</li>
<li>добавлены пакеты fuse-exfat exfat-utils для поддержки файловой системы exfat</li>
<li>введён новый параметр ini файла PULSEAUDIO для включения звукового сервера pulseaudio</li>
</ul>
<h3>сборка 20140516</h3>
<ul>
<li>обновления на 16.05.2014</li>
<li>ядро 3.10.39-nrj</li>
<li>добавлен новый менеджер модулей MagOS</li>
<li>для исправления зависимости модуля КДЕ от других модулей общие rpm пакеты перенесены в модули 10-core 20-x-base</li>
</ul>
<h3>сборка 20140419</h3>
<ul>
<li>обновления на 18.04.2014</li>
<li>ядро 3.10.36-nrj</li>
<li>для совместимости с обновленной КДЕ, папка /media теперь подключается через tmpfs</li>
<li>исправлена ошибка с запуском wine</li>
<li>добавлен пакет qastools</li>
<li>в утилиту activate добавлен поиск модулей по имени в папках MagOS, MagOS-Data, кэше copy2ram</li>
<li>из списков urpmi удалён источник mib</li>
</ul>
<h3>сборка 20140323</h3>
<ul>
<li>обновления на 23.03.2014</li>
<li>ядро 3.10.30-nrj</li>
<li>добавлен скрипт для записи системного времени в аппаратные часы</li>
<li>добавлен скрипт для применения настроек /etc/sysctl.conf</li>
<li>группе wheel добавлено разрешение запускать sudo без ввода пароля</li>
<li>если не сменён пароль root по умолчанию, то пользователь с UID=500 добавляется в группу wheel</li>
<li>добавлен параметр загрузки exec для автозагрузки программ под пользователем</li>
<li>в initrd добавлены модули сетевых карт atl1c alx</li>
<li>для работы с криптопрофилем добавлена утилита /usr/lib/magos/losetup (старая сборка, поддерживающая losetup -e)</li>
<li>исправлена служба nfs-server</li>
</ul>
<h3>сборка 20140221</h3>
<ul>
<li>обновления на 21.02.2014</li>
<li>ядро 3.10.30-nrj</li>
<li>добавлена поддержка поднятия сетевых интерфейсов, не управляемых NetworkManager</li>
<li>исправлено отображение модулей в списке устройств для некоторых компонентов КДЕ и программ</li>
</ul>
<h3>сборка 20140125</h3>
<ul>
<li>обновления на 24.01.2014</li>
<li>ядро 3.10.25-nrj</li>
<li>добавлен скрипт для исправления неправильного определения видеокарты службой harddrake.</li>
<li>добавлен параметр xdriver=xorg для запуска X без файла настроек xorg.conf</li>
<li>eiskaltdcpp-gtk заменён на eiskaltdcpp-qt</li>
<li>добавлен пакет systemd-tools</li>
</ul>
<h3>сборка 20131229</h3>
<ul>
<li>обновления на 29.12.2013</li>
<li>ядро 3.10.24-nrj</li>
<li>для ускорения загрузки plymouth по умолчанию отключен через параметр загрузки plymouth.enable=0</li>
<li>в результате оптимизации скриптов, службы harddrake, отключения plymouth,в несколько раз сокращено время загрузки системы от старта systemd до старта графической среды</li>
<li>параметр blacklist теперь работает не только на уровне initrd, но и для всей системы</li>
<li>при включении/выключении служб через ini файл также используются команды mask,unmask системы systemd</li>
<li>служба bumblebee для технологии Nvidia optimus доступна «из коробки» (по умолчанию отключено)</li>
<li>добавлен скрипт в автозагрузку графической среды для установки раскладки клавиатуры</li>
<li>добавлена виртуальная клавиатура florence</li>
</ul>
<h3>сборка 20131127</h3>
<ul>
<li>обновления на 27.11.2013</li>
<li>ядро 3.10.19-nrj</li>
</ul>
<h3>сборка 20131026</h3>
<ul>
<li>обновления на 25.10.2013</li>
<li>ядро 3.10.17-nrj</li>
<li>добавлен параметр rdloaddriver для загрузки модулей ядра на уровне initrd</li>
<li>не уровне initrd добавлена обработка параметра загрузки blacklist для блокировки загрузки модулей ядра</li>
<li>поиск MagOS-Data происходит быстрее, без задержки в случае его отсутствия, что ускоряет загрузку с iso</li>
<li>графический материал (обои, фото для хранителя экрана) перенесён в /usr/share/magos и сгруппирован в папки по темам, что облегчает создание модулей, меняющих оформление системы.</li>
<li>при вводе машины в домен AD автоматически синхронизируется время с контроллером домена</li>
<li>добавлен новый параметр ini файла VARTMPFS для сохранения содержимого каталога /var/tmp, полезно для ускорения работы меню КДЕ</li>
<li>исправлены ошибки зависимостей для загрузки nfs-server через systemd.</li>
</ul>
<h3>сборка 20130929</h3>
<ul>
<li>обновления на 28.09.2013</li>
<li>ядро 3.10.12-nrj</li>
<li>исправлена ошибка определения оборудования на уровне initrd</li>
<li>отключена автозагрузка служб abrtd, hostapd, irqbalance, smartd</li>
<li>добавлены пакеты bash-completion, fm_scripts, magic_keys, whois, gnome-nettool, meld</li>
</ul>
<h3>сборка 20130820</h3>
<ul>
<li>обновления на 19.08.2013</li>
<li>ядро 3.9.11-nrj</li>
<li>установочный скрипт add2vista.bat исправлен и переименован в add2bcd.bat</li>
<li>добавлен новый универсальный скрипт установки под Linux и Windows boot/Install_MagOS.bat, скрипт может работать в файловых системах fat, подключенных в режиме showexec. Скрипт предназначен для установки загрузчика grub4dos в mbr (Linux) или в boot сектор раздела, в случае запуска с диска C: в Windows, добавляет загрузку MagOS к ntldr или bcd загрузчикам.</li>
<li>исправления утилит mkinitrd xuserrun profiler_helper и liblinuxlive</li>
<li>из сборки удалена программа geeqie</li>
<li>к параметрам загрузки добавлен параметр quiet</li>
</ul>
<h3>сборка 20130716</h3>
<ul>
<li>обновления на 16.07.2013</li>
<li>ядро 3.9.9-nrj</li>
<li>исправлена установка имени машины в сети</li>
<li>добавлены пакеты ddclient udpxy modem-manager-gui geeqie stylus-toolbox</li>
<li>исправлен выбор менеджера входа</li>
<li>добавлен новый параметр загрузки lang для выбора языка системы</li>
<li>отключена автозагрузка служб systemd abrtd,hostapd,irqbalance,smartd</li>
<li>добавлен скрипт rpmdbreset для сброса изменений базы RPM</li>
<li>drakconf заменен на magos-ctrl-center (в версии 2012lts)</li>
<li>исправлена регистрация модулей в обновленном firefox (2012)</li>
<li>по умолчанию отключена отправка данных в firefox (2012)</li>
<li>исправлена ошибка с подвисанием системы при выключении в случае подключения сетевых ресурсов NFS SMB (2012)</li>
<li>исправлен запуск службы nfs-server (2012)</li>
<li>оставлен Gnome 3.6 для 2012, т.к. обновленная версия 3.8 не имеет классического режима с поддержкой compiz</li>
</ul>
<h3>сборка 20130625</h3>
<ul>
<li>обновления на 25.06.2013</li>
<li>ядро 3.9.7-nrj</li>
<li>в сборку включены утилиты xsudo aircrack-ng, recoverjpeg(для 2012), ext3grep, foremost</li>
<li>исправлено включение 3D эффектов для 2012lts</li>
<li>исправленa ошибка с dbus для 2012lts</li>
<li>исправлена ошибка в файле загрузчика (splash=silent)</li>
</ul>
<h3>сборка 20130529</h3>
<ul>
<li>обновления на 29.05.2013</li>
<li>в сборку включен файловый менеджер doublecmd</li>
<li>исправлена ошибка неработоспособности сессии LXDE/GNOME в терминальном сервере freenx (2012)</li>
<li>пакет nfs-utils перенесён в модуль 10-core (2012)</li>
<li>исправлены настройки sshd для freenx (2012)</li>
<li>исправлен запуск autologin (2012)</li>
<li>исправлены темы gtk-3.0 MagOS MagOS-green MagOS-dark (2012)</li>
<li>исправлен файл с цветами КДЕ в теме по умолчанию (2012)</li>
</ul>
<h3>сборка 20130428</h3>
<ul>
<li>выпущена сборка на новой платформе Rosa Fresh 2012.1</li>
<li>в связи с отсутствием обновлений заморожена сборка на платформе 2011.</li>
<li>сборка ядра и dkms модулей выведена из скриптов сборки, в git выложены скрипты для сборки rpm пакетов.</li>
<li>обновления на 28.04.2013</li>
<li>ядро 3.7.10-nrj для 2012 и 2012lts</li>
<li>dkms модули для графических карт вынесены в модуль 23-x-3d</li>
<li>исправлена ошибка с определением оборудования на уровне initrd</li>
<li>исправлена поддержка USB клавиатур на уровне initrd (режим quickshell)</li>
<li>введён новый параметр загрузки «qs», аналогичен «quickshell»</li>
<li>база rpm оставлена в развёрнутом виде</li>
<li>добавлен Центр управления LXDE (lxde-ctrl-center)</li>
<li>добавлены gtk3 темы для MagOS MagOS-green MagOS-dark</li>
<li>добавлены пакеты beesu msec-gui mdvinput gigolo system-config-nfs system-config-samba</li>
<li>2012: Gnome3 с двумя вариантами оформления: Gnome classic, Gnome-shell. Фактически вместе с KDE и LXDE в сборке теперь 4 графических среды.</li>
<li>2012: Gnome-shell не совместим с compiz, поэтому 3D эффекты в нём не будут активированы. Compiz совместим с KDE, LXDE, Gnome classic</li>
<li>2012: Для выбора среды загрузки Gnome-shell обновлён gfxmenu загрузчика grub4dos</li>
<li>2012: Вместо drakconf добавлен Центр управления MagOS (на базе lxde-ctrl-center)</li>
<li>2012: в связи с закрытием проекта epdfview, утилита epdfview заменена на zathura</li>
</ul>
<h3>сборка 20130324</h3>
<ul>
<li>обновления на 24.03.2013</li>
<li>ядро 3.7.10-nrj для 2011 и 2012lts</li>
<li>переделан режим загрузки quickshell</li>
<li>исправлены некритичные ошибки в скриптах загрузки.</li>
</ul>
<h3>сборка 20130228</h3>
<ul>
<li>обновления на 28.02.2013</li>
<li>поддержка платформы Rosa Marathon 2012 (сборки на этой платформе обозначаются 2012lts).</li>
<li>добавлены пакеты gsmartcontrol smartmontools для просмотра информации по жестким дискам.</li>
<li>альтернативные настройки для conky (запуск через conky_orange).</li>
<li>новый параметр загрузки quickshell для работы на уровне загрузки initrd.</li>
</ul>
<h3>сборка 20130124</h3>
<ul>
<li>обновления на 24.01.2013</li>
<li>ядро NRJ 3.6.11</li>
<li>исправлена обработка паролей из ini файла, они имеют приоритет над сохранёнными в профиле.</li>
<li>исправлено отключение модулей и разделов из /media при выключении системы</li>
<li>добавлена горячая кнопка Win+S для масштабирования экрана</li>
<li>пользователи системы автоматически добавляются в группу lp</li>
<li>начинаем работу над платформой Rosa 2012.1 (Fresh)</li>
<li>создан собственный источник http://magos.sibsau.ru/repository/rpms , используемый во время сборки</li>
</ul>
<h3>сборка 20121230</h3>
<ul>
<li>обновления на 30.12.2012</li>
<li>ядро NRJ 3.6.10</li>
<li>по умолчанию используется новый режим с сохранением данных</li>
<li>изменён загрузчик</li>
<li>добавлены обои с kde-look.org (/usr/share/magos/wallpapers)</li>
<li>по умолчанию выбирается случайная картинка в качестве обоев</li>
<li>служба compcache отключена по умолчанию</li>
<li>добавлены параметры загрузки 3ddesktop no3ddesktop</li>
<li>исправления в скриптах системы</li>
<li>
<p>Изменения в загрузчике:</p>
<ul>
<li>syslinux используется только для загрузки grub4dos</li>
<li>добавлено графическое меню gfxmenu</li>
<li>поддержка русского языка в меню по умолчанию /boot/grub4dos/local</li>
<li>английский вариант /boot/grub4dos используется если удалена папка /boot/grub4dos/local</li>
<li>теперь всего 3 варианта загрузки (с сохранением, чистый, Интернет)</li>
<li>параметры загрузки: среда, 3d эффекты и режим copy2ram, вынесены на кнопки управления F2…F6</li>
</ul>
</li>
<li>
<p>новый режим с сохранением данных:</p>
<ul>
<li>по умолчанию используется режим с сохранением данных</li>
<li>в режиме сохранения данных пользовательские данные (/home) сохраняются в MagOS-Data/home.img</li>
<li>MagOS запоминает системные изменения отдельно для каждой машины</li>
<li>системные изменения сохраняются в xzm модуль с MAC адресом сетевой карты MagOS-Data/machines/dynamic/mac-xxxxxxxxxxxx.xzm</li>
<li>возможно приостановить сохранение системных данных на данной машине переносом модуля MagOS-Data/machines/dynamic/mac-xxxxxxxxxxxx.xzm в папку MagOS-Data/machines/static</li>
<li>при переносе модуля MagOS-Data/machines/static/mac-xxxxxxxxxxxx.xzm в папку MagOS-Data/machines/dynamic изменения будут снова сохраняться</li>
<li>при удалении файла /.savetomodule текущий сеанс работы разово не будет сохранён в xzm.</li>
</ul>
</li>
</ul>
<h3>сборка 20121130</h3>
<ul>
<li>обновления на 30.11.2012</li>
<li>ядро NRJ 3.6.7 от Nicolo' Costanza</li>
<li>поддержка загрузки с USB 3.0</li>
<li>добавлены пакеты microcode iperf gammu</li>
<li>добавлена новая программа для работы с телефонами Wammu</li>
</ul>
<h3>сборка 20121028</h3>
<ul>
<li>обновления на 28.10.2012</li>
<li>ядро 3.5.7</li>
<li>добавлены шрифты ptmono,ptsans,ptserif от http://www.paratype.ru/</li>
<li>протокол источников urpmi изменён с ftp: на http:</li>
<li>mplayerplugin заменён на gecko-mediaplayer</li>
</ul>
<h3>сборка 20120926</h3>
<ul>
<li>обновления на 26.09.2012</li>
<li>ядро 3.5.4</li>
<li>переход на модули с размером блока 512K, что позволило сократить размер сборки на 7%</li>
<li>в связи со сбоями на Яндекс зеркале, urpmi настроен на использование сервера ftp.free.fr</li>
<li>добавлен новый параметр ini файла USERGROUPS, для указания групп по умолчанию для пользователей</li>
<li>переделан механизм обработки параметра ini файла AUTOEXEC</li>
<li>исправлены скрипты compcache для работы с новыми ядрами.</li>
<li>тип файлов mht соотнесён с firefox</li>
<li>тип файлов vsd соотнесён с LibreOffice-Draw</li>
<li>добавлены пакеты icoutils libexttextcat0</li>
</ul>
<h3>сборка 20120719</h3>
<ul>
<li>обновления на 18.07.2012</li>
<li>ядро 3.4.5</li>
<li>исправлены зависания во время загрузки системы при использовании дисков с расширенными разделами</li>
<li>исправлены ошибки в утилите создания модулей rpmdrake2lzm</li>
<li>изменен драйвер печати по умолчанию для libreoffice (решена проблема печати альбомных страниц на некоторых принтерах)</li>
<li>ярлык для PlayOnLinux перенесён в меню «Утилиты-Эмуляторы»</li>
</ul>
<h3>сборка 20120624</h3>
<ul>
<li>обновления на 24.06.2012</li>
<li>ядро 3.3.8</li>
<li>LibreOffice 3.5.4.2 с поддержкой формата MS Visio</li>
<li>поддержка загрузки MagOS с FTP сервера</li>
<li>добавлены пакеты tree, gstreamer0.10-faad, python-pyxdg, python-distribute</li>
<li>исправлено подключение davfs версии 1(используется для Яндекс.Диск)</li>
<li>небольшие исправления в скриптах</li>
<li>экспериментальная поддержка загрузки с Интернета (http или ftp сервера) с помощью загрузчика ipxe.</li>
</ul>
<h3>сборка 20120523</h3>
<ul>
<li>ядро 3.3.7</li>
<li>обновления на 23.05.2012</li>
<li>стартовые скрипты MagOS распараллелены, их можно отключать через ini файл</li>
<li>исправлены настройки сервера ntpd</li>
<li>исправлены скрипты перехода в ждущий/спящий режимы</li>
<li>добавлено задание cron для синхронизации времени через ntpdate</li>
<li>добавлены пакеты libafpclient0 libnfs1 libshairport1 libyajl2 python-webkitgtk libbluray1 libcec1 pulseaudio-module-bluetooth libpodofo0</li>
<li>переделан механизм хранения базы rpm при использования режимов с сохранением данных</li>
<li>в случае использования паролей по умолчанию, на рабочем столе выводится соответствующее сообщение.</li>
</ul>
<h3>сборка 20120427</h3>
<ul>
<li>обновления на 26.04.2012</li>
<li>ядро 3.3.3</li>
<li>добавлено 13 источников rpm пакетов (отключены по умолчанию)</li>
<li>добавлены ключи для официальных источников мандривы</li>
<li>экспериментальный автоматический переход в спящий режим без указания раздела в параметрах загрузки (resume)</li>
<li>добавлен пакет autologin</li>
<li>исправлены некоторые ошибки в скриптах.</li>
</ul>
<h3>сборка 20120325</h3>
<ul>
<li>включены обновления на 25.03.2012</li>
<li>новое ядро 3.2.13</li>
<li>новая переразбивка на модули. Минимальный размер системы на базе gnome или lxde теперь около 250МБ.</li>
<li>добавлен «менеджер модулей» - графическая утилита для создания и управления модулями.</li>
<li>добавлены скрипты для подключения модемов. Теперь после подключения телефона войти в интернет можно одним щелчком мыши.</li>
<li>исправлены скрипты подключения модулей. Службы из модуля запускаются только в том случае, если они прописаны на данном уровне init</li>
<li>переработан скрипт создания модулей dir2[xl]zm</li>
<li>добавлены пакеты gnokii bridge-utils ebtables</li>
<li>удалены некоторые «осиротевшие» библиотеки</li>
<li>исправлена ошибка с подвисанием rpm на ext3 профиле. Индексные файлы теперь храняться в файловой системе tmpfs.</li>
<li>исправлена ошибка с разблокировкой сессии в lxde и gnome.</li>
<li>для сжатия размера, из базы rpm удалены записи о пакетах, лежащих в дополнительных модулях локализации.</li>
<li>обновлен скрипт winetricks до последней версии</li>
<li>обновлен playonlinux до последней версии</li>
<li>исправлена служба compcache (сжатый swap в памяти) для работы с новыми ядрами.</li>
</ul>
<h3>сборка 20120223</h3>
<ul>
<li>включены обновления на 22.02.2012</li>
<li>новое ядро 3.2.7</li>
<li>при настройке сетевых интерфейсов networkmanager отключен по умолчанию</li>
<li>добавлен альтернативный dhcp клиент udhcpc (busybox версия)</li>
<li>изменена схема определения рабочего разрешения видео</li>
<li>небольшие исправления в скриптах</li>
<li>добавлена утилита xdelta3</li>
</ul>
<h3>сборка 20120120</h3>
<ul>
<li>включены обновления на 19.01.2012</li>
<li>новое ядро 3.1.8 собственной сборки</li>
<li>дополнительно доступно ядро реального времени (в архив не входит).</li>
<li>система настроена в соответсвиии с рекомендациями к системам реального времени.</li>
<li>добавлено автоматическое определение принтера HP DJ 2050A</li>
<li>добавлен срез нашей wiki по состоянию на 16.01.2012</li>
<li>исправлен скрипт инициализации для samba</li>
<li>исправлена загрузка в режиме copy2ram=</li>
<li>начата работа над единым хранилищем модулей на ftp сервере</li>
</ul>
<h3>сборка 20111227</h3>
<ul>
<li>включены обновления на 26.12.2011</li>
<li>модули документации и локализаций переименованы (начинаются с 7<em> и 8</em>)</li>
<li>прошивки для оборудования выведены в модуль 01-firmware</li>
<li>страницы man info выведены в модуль 71-manpages</li>
<li>пакет kernel-devel перенесен в модуль 12-devel</li>
<li>удалены некоторые «осиротевшие» пакеты из модулей 35-x-kde 20-x-base</li>
<li>удалены значки размером 128х128</li>
<li>созданы устройства /dev/loop7…/dev/loop127</li>
<li>обновлен до последней версии playonlinux</li>
</ul>
<h3>сборка 20111119</h3>
<ul>
<li>включены обновления на 18.11.2011</li>
<li>исправлены настройки сервера сетевой загрузки pxe</li>
<li>исправлены скрипты сервера pdnsd</li>
<li>программа sunbird в 2011 сборке заменена на дополнение lightnings для thunderbird</li>
<li>в сборке 2011 тема по умолчанию для kdm изменена на oxygen, что позволяет отображать большое кол-во пользователей</li>
<li>настроено цветное приветствие в консоли для bash</li>
<li>добавлен новый параметр ini файла CMDLINE, который позволяет задавать параметры загрузки MagOS и linux-live</li>
<li>обновлены до последних версий winetricks и playonlinux</li>
</ul>
<h3>сборка 20111028</h3>
<ul>
<li>включены обновления на 27.10.2011</li>
<li>переделаны скрипты сборки, теперь для сборки скрипты linux-live не нужны</li>
<li>пересобрано ядро, решена проблема с некоторыми видеокартами</li>
<li>добавлен новый каталог MagOS-Data, в котором предлагается хранить пользовательские профили, ini файлы и модули. Это разграничивает общесистемные и пользовательские данные, что может быть удобно при обновлении. В случае отсутсвия MagOS-Data будет использован старый механизм поиска.</li>
<li>новый параметр загрузки sgndatafile для указания файла-метки при поиске MagOS-Data</li>
<li>решена проблема с зависанием udev при старте</li>
<li>решена проблема со «случайным» переводом времени на 4 часа назад</li>
<li>изменена раскладка русской клавиатуры с «ru(winkeys)» на «ru»</li>
<li>решена проблема с падением сетевого апплета</li>
<li>пользователям системы (группе users) предоставлен прямой доступ до аудио-видео оборудования, что решает проблему работы с таким оборудованием в LXDE</li>
<li>исправлено масштабирование фоновой картинки под рабочее разрешение при использовании параметра BACKGROUND в ini файле.</li>
<li>в панель KDE по умолчанию добавлен апплет батареи</li>
<li>главный регулятор громкости по умолчанию установлен на положение 50%, остальные на 90%, возможно задать эти значения через ini файл.</li>
<li>настройки pxelinux перенесёны из /mnt/livemedia в /boot</li>
<li>добавлены библиотеки, необходимые для xbmc</li>
<li>решена проблема с запуском dolphin вместо nautilus в Gnome</li>
<li>исправлен скрипт сохранения в модуль</li>
<li>добавлены стандартные значки для оригинальных утилит MagOS в drakconf</li>
</ul>
<h3>сборка 20110924</h3>
<ul>
<li>переход на Mandriva 2011</li>
<li>прекращена поддержка 2010.0</li>
</ul>
<h3>сборка 20110714</h3>
<ul>
<li>включены обновления на 14.07.2011</li>
<li>добавлены разные варианты масштабирования фонового рисунка (см. etc/sysconfig/theme)</li>
<li>поправлены некритичные ошибки при работе с темами Gtk2 в KDE</li>
<li>winetricks обновлён до версии 20110629</li>
<li>добавлены пакеты xclip kim</li>
</ul>
<h3>сборка 20110623</h3>
<ul>
<li>включены обновления на 22.06.2011</li>
<li>добавлены пакеты conky, kepas, eiskaltdcpp-gtk с зависимостями</li>
<li>добавлены библиотеки необходимые для установки xbmc</li>
<li>добавлены скрипты autoexec, createloop, editor, editor_root, filemanager, filemanager_root, imageview, mountloop, pdfview, umountloop</li>
<li>обновлён winetricks (до текущей версии 20110429)</li>
<li>исправлены мелкие ошибки в скриптах dolphin nautilus (поддержка пробелов в путях)</li>
<li>добавлен файл настроек для conky</li>
<li>в «горячие кнопки» добавлены функции поворота экрана на кнопки Win+</li>
<li>изменён механизм автозапуска пользовательских программ (fusion-icon, yakuake и др.), добавлен параметр AUTOEXEC ини файла.</li>
<li>добавлен параметр ini файла DEPMOD для обновления базы модулей ядра (необходимо при использовании сторонних модулей с драйверами)</li>
<li>в механизм сохранения в модуль добавлена возможность указания исключений (праметр savelist), а также возможность сохранения в модуль без сжатия.</li>
<li>в ini файле теперь можно указать XORG_RES=auto для автоматического определения разрешения сервером Xorg (полезно для нестандартных разрешений 1366х*)</li>
<li>вместо параметра ini файла FLATPANEL введён новый параметр MONITOR, позволяющий определять как ЖК панели , так и старые ЭЛТ мониторы.</li>
<li>расширены возможности параметра ini файла BACKGROUND для указания фонового изображения.</li>
</ul>
<h3>сборка 20110522</h3>
<ul>
<li>включены обновления на 21.05.2011;</li>
<li>изменён механизм save2module (сохраняется в один модуль)</li>
<li>в параметре changes можно указать путь до nfs сервера.</li>
<li>в качестве профиля (changes=) можно указывать lzm модуль, при выключении система будет сохранять данные в этот модуль. (пустой модуль для сохранения можно взять в архиве profiles.7z )</li>
<li>введён новый параметр savelist, который позволяет выборочно сохранять указанные файлы и папки по шаблонам. Параметр используется только при сохранении в lzm архив.</li>
<li>новый параметр ini файла UPDATEHOME который позволяет обновлять домашние папки в случае изменения пользовательского шаблона (может быть полезно при подключении некоторых модулей и при выборочном сохранении пользовательских папок)</li>
<li>в режиме загрузки MagOS_failsafe отключаются все модули (лежащие в папке /modules/)</li>
<li>во время загрузки системы отключена попытка установки dkms пакетов для оборудования</li>
<li>в темах MagOS MagOS-dark MagOS-green отключена анимация элементов для ускорении работы интерфейса на медленных процессорах</li>
<li>в менеджере входа цвет текста изменён на чёрный для лучшей контрастности</li>
<li>добавлена системная горячая кнопка Win+n для отображения активных пользовательских интерфейсов</li>
<li>в пути по умолчанию PATH добавлен путь /usr/lib/magos/scripts, в эту папку перенесены все собственные скрипты и утилиты MagOS</li>
<li>исправлено определение ДНС серверов для ppp0 соединений</li>
<li>исправлены настройки по умолчанию proftpd для анонимного доступа</li>
<li>добавлена утилита заметок zim</li>
<li>в режиме загрузки по сети добавлена поддержка модулей сетевых карт virtio_net atl1 atl2 igb</li>
<li>в контекстные меню файловых менеджеров KDE и GNOME добавлены команды для создания и изменения профилей, временного предоставления общего доступа по сети (ftp, nfs, samba), отправки файла по почте (thunderbird), создания и распаковки lzm модулей и пр.</li>
<li>добавлена графическая утилита для преобразования системных модулей в формат lzm без сжатия (для слабых компьютеров).</li>
</ul>
<h3>сборка 20110413</h3>
<ul>
<li>включены обновления на 11.04.2011;</li>
<li>исправлено выключение/перезагрузка компьютера из LXDE</li>
<li>включен сервер ntlmaps для работы через прокси-сервер MS ISA;</li>
<li>заменены графические эмблемы Mandriva на собственные;</li>
<li>сделаны 3 новые темы рабочего стола для всех графических сред (LXDE Gnome KDE)<ul>
<li>MagOS</li>
<li>MagOS-dark</li>
<li>MagOS-green</li>
</ul>
</li>
<li>добавлены новые обои bluesth bluesth-green bluesth-red KStarboard;</li>
<li>по умолчанию установлена тема MagOS, обои bluesth. Через ini файл возможно выбирать темы и обои. К примеру, для возврата к старому стилю оформления используйте параметры BACKGROUND=BlueC4D THEME=Mandriva;</li>
<li>добавлены пакеты lirc, proxychains с зависимостями;</li>
<li>добавлен виртуальный сжатый swap в памяти. Swap создаётся службой compcache автоматически при старте, если не подключен ни один swap раздел (или файл). Для отключения этой возможности используйте параметр ini файла SERVICESNOSTART=compcache;</li>
<li>сервер времени ntpd настроен на раздачу времени в локальную сеть;</li>
<li>возможно отключение tmpfs для /tmp при работе в профиле. Для этого введён новый параметр ini файла TMPFS. Используйте этот параметр при работе на машинах с небольшим кол-вом памяти и если профиль лежит на жёстком диске;</li>
<li>доработана утилита для создания lzm модулей.</li>
</ul>
<h3>сборка 20110319</h3>
<ul>
<li>включены обновления на 18.03.2011</li>
<li>openoffice выделен в отдельный модуль, чтобы была возможность заменить его альтернативной сборкой</li>
<li>модуль kernel перепакован без архивации модулей в gzip, что позволило сократить размер модуля на 13М</li>
<li>страницы руководства man выведены в модуль в документации</li>
<li>пересмотр модулей позволили сократить сборку на 30М</li>
<li>добавлена программа guake (всплывающий терминал) для Gnome и LXDE</li>
<li>настроена служба времени. При поднятии службы ntpd время будет синхронизироваться с серверами ntp2.vniiftri.ru,ru.pool.ntp.org .Возможно настроить свои собственные серверы через параметр ini файла NTPSERVERS</li>
<li>добавлен пакет krb5-workstation для прозрачной kerberos авторизации приложений.</li>
<li>kerberos, pam.d, службы smb, winbind настроены для работы с Active Directory. В ini файле введены параметры DOMAIN и ADSERVER.</li>
<li>введен параметр ini файла DPMS для отключения управления питанием монитора</li>
<li>введен параметр ini файла DMFASTBOOT для отключения параллельного старта графики во время запуска системных и сетевых служб</li>
<li>поправлено главное меню</li>
<li>при указании своих пользователей автовход будет осуществлен под первым указанным пользователем, если не указан параметр AUTOLOGINUSER</li>
<li>скрипты сборки перенесены на систему управления версиями GIT.</li>
<li>исправлена обработка параметра oldpc</li>
<li>добавлен новый графический мастер в меню drakconf для создания модулей.</li>
<li>playonlinux обновлен до версии 3.8.12</li>
</ul>
<h3>сборка 20110220</h3>
<ul>
<li>включены обновления на 19.02.2011</li>
<li>удалены программы evolution, kmail, korg</li>
<li>добавлены mozilla-sunbird, dia, playonlinux, powertop</li>
<li>playonlinux обновлен до версии 3.8.8</li>
<li>добавлен скрипт winetricks, упрощающий установку приложений в wine</li>
<li>в связи с проблемами на русских зеркалах, официальные хранилища временно настроены на сервер ftp.free.fr</li>
<li>исправлена ошибка неработоспособности lxde без модуля multimedia</li>
<li>экспериментальный параметр загрузки oldpc, позволяющий конвертировать модули для слабых процессоров</li>
</ul>
<h3>сборка 20110114</h3>
<ul>
<li>включены обновления на 12.01.2011</li>
<li>переход с источников 2010.1 на 2010.2</li>
<li>добавлены новые пакеты ddrescue gvfs-archive gvfs-fuse gvfs-gphoto2 gvfs-iphone gvfs-smb kopete-cryptography mozilla-thunderbird-enigmail radiotray</li>
<li>новое главное меню, стандартизированное под все графические среды.</li>
<li>возможность загрузки с заданным разрешением экрана, для этого введён новый параметр загрузки xres, также добавлены параметры XORG_RES и FLATPANEL ini файла.</li>
<li>новый параметр загрузки fsck для автоматической проверки и исправления файловых систем. С этим параметром система проверяет все подключаемые при старте разделы, файлы-профили, криптоконтейнеры.</li>
<li>возможно использование криптоконтейнера AES256 в качестве системного профиля. Подключение криптоконтейнера с пользовательскими данными (home) перенесено из графической загрузки в текстовую. В имени файла криптоконтейнера обязательно должно быть расширение .enc</li>
<li>новый параметр GRAFFITY в ini файле, включает отображение режима загрузки на обоях рабочего стола.</li>
<li>для разработчиков модулей упрощено создание модулей расширений для firefox thunderbird. Достаточно расположить расширение в папках /usr/lib/mozilla/firefox/extensions /usr/lib/mozilla/thunderbird/extensions, система зарегистрирует их как системные расширения в конкретных версиях этих программ</li>
<li>исправлена ошибка подключения стороннего клиента NX Nomachine Client к терминальному серверу MagOS.</li>
<li>исправлено включение Numlock при входе в текстовую консоль, при использовании параметра ini файла NUMLOCK=no</li>
<li>исправлена блокировка сервера статистики google.com приводившая к невозможности входа на translate.google.ru youtube.com</li>
<li>изменены настройки по умолчанию для программ remmina, linphone</li>
</ul>
<h3>сборка 20101213</h3>
<ul>
<li>включены обновления на 12.12.2010</li>
<li>для автоматического создания модулей добавлена утилита urpm2lzm и интерфейс для неё gurpm2lzm</li>
<li>добавлена поддержка AudioCD, действия для AudioCD/DVD</li>
<li>добавлена утилита rsync в initrd</li>
<li>в дополнительные языковые модули добавлены все доступные пакеты для локализации системы и программ на другие язык. Если положить языковой модуль в /base/ то система начинает говорить на этом языке с загрузки (локализуются система, kde, openoffice, firefox, thunderbird, myspell, aspell при наличии пакетов под этот язык).</li>
<li>настроены собственные комбинации «горячих» кнопок через xbindkeys, перечень можно посмотреть нажав Win+K</li>
<li>справка gnome и kde перенесены в модуль 92-documentation</li>
<li>расширен функционал MagOS.ini - возможность автоматической смены MAC адреса при поднятии сетевого интерфейса</li>
<li>для безопасности хэши паролей не копируются из ini файла в /etc/sysconfig/MagOS</li>
<li>исправление мелких ошибок</li>
<li>добавлены утилиты для работы с encfs и btrfs</li>
<li>добавлен пакет net_monitor для наблюдения за сетью</li>
<li>добавлены утилиты vlan-utils, vnstat, wmctrl, xkill, rfkill.</li>
</ul>
<h3>сборка 20101112</h3>
<ul>
<li>включены обновления на 12.11.2010</li>
<li>изменён приоритет источников - соответственно edu, plf, backports, updates, release</li>
<li>доработана обработка параметра home, исправлено подключение папки, поиск криптоконтейнера на жестких дисках, подключение (крипто)контейнера с сервера NFS</li>
<li>доработана возможность загрузки с образа через httpfs. Путь теперь можно указывать как с номером порта, так и без него.</li>
<li>убрана служба magosct, код перенесён в скрипты загрузки</li>
<li>добавлен hostapd , позволяющий организовать точку доступа (wpa2/web) для беспроводных сетей</li>
<li>возможность автоматического подключения при старте системы к найденной wifi сети</li>
<li>система настроена на большую анонимность (в firefox отключена отправка статистики на серверы google).</li>
<li>
<p>расширен функционал MagOS.ini</p>
<ul>
<li>настройка точки доступа hostapd</li>
<li>настройка системных прокси-серверов</li>
<li>настройка межсетевого экрана iptables</li>
<li>возможность включение режима шлюза</li>
<li>возможность прозрачного перенаправления всех сетевых соединений отдельных пользователей через TOR</li>
<li>настройка режима numlock на клавиатуре</li>
</ul>
</li>
<li>
<p>исправлена настройка dhcpd, для поддержки hostapd</p>
</li>
<li>pdnsd слушает на всех интерфейсах, для работы в режиме ДНС сервера в беспроводной сети.</li>
<li>добавлены утилиты blueman devede freerdp recordmydesktop heimdal-telnet keepassx plasma-applet-pastebin remmina screen</li>
</ul>
<h3>сборка 20101015</h3>
<ul>
<li>включены обновления на 13.10.2010</li>
<li>Пароли по умолчанию у root и пользователей toor и magos соответственно!</li>
<li>доработан параметр home. Его можно использовать без профиля системы и совместно с ним. Можно использовать криптоконтейнер с алгоритмом AES256.</li>
<li>
<p>расширен функционал MagOS.ini</p>
<ul>
<li>возможность указания пользователей системы, паролей, автовхода</li>
<li>автоматическое подключение разделов при старте системы</li>
<li>изменение списка загружаемых служб</li>
<li>возможность настройки в качестве сервера через MagOS.ini</li>
</ul>
</li>
<li>
<p>новый параметр загрузки copy2rep</p>
</li>
<li>изменён механизм создания общих разделов NFS. По умолчанию вместо одного /media каждый раздел публикуется отдельно.</li>
<li>исправлены ошибки в настройке pdnsd</li>
<li>Появилась поддержка tor. Для работы через tor, запустите службы tor и polipo, настройте браузер на прокси сервер localhost:8118</li>
<li>Добавлены утилиты chkrootkit, etherape, fbreader, ffmpegthumbs,,filelight, macchanger, plasma-applet-quickaccess, rkhunter</li>
</ul>
<h3>сборка 20100911</h3>
<ul>
<li>включены обновления на 11.09.2010</li>
<li>кол-во петлевых устройств (/dev/loop*) по умолчанию увеличено до 64</li>
<li>сокращён размер сборки примерно на 60-80М за счёт переделки файлов icon-theme.cache</li>
<li>все переводы справочной системы Gnome кроме русского и английского языка выведены из сборки, что позволило сократить размер модуля Gnome c 135М до 78М</li>
<li>исправлено монтирование разделов в Gnome и lxde</li>
<li>в KDE yakuake добавлено в автозагрузку</li>
<li>устройства подключенные до старта мандривы (например /mnt/livemedia) добавляются в /etc/mtab, это решило проблему перехода в них через файловые менеджеры.</li>
<li>добавлен пакет libjpeg7 для совместимости с модулем XBMC</li>
<li>добавлен параметр загрузки repository для указания удалённого или локального хранилища модулей</li>
<li>добавлена возможность отдельного хранения /home, Для этого введён новый параметр загрузки home</li>
<li>появилась возможность настройки системы через файл настроек MagOS.ini С помощью этого файла можно, к примеру, изменить часовой пояс, раскладку клавиатуры, сделать автоподнятие сети и много другое. Файл настройки меняет параметры всех режимов и переопределяет параметры из профиля.Для указания своего файла настроек введён новый параметр config.</li>
<li>пакеты udisks upower перенесены в базовый модуль, что позволяет использовать их в lxde без подключения модуля gnome</li>
<li>добавлены пакеты equinox-abomination fonts-ttf-pwt gnome-phone-manager grub2 gtk-equinox-engine gtk-icons-elementary kcm_touchpad nilfs-utils plasma-applet-smooth-tasks telepathy-filesystem xinitrc_dbus xl2tpd</li>
</ul>
<h3>сборка 20100711</h3>
<ul>
<li>включены обновления на 10.07.2010</li>
<li>eiskaltdc заменена на более продвинутую eiskaltdcpp (настройки программ различаются)</li>
<li>добавлены пакеты для авторизации в домене samba</li>
<li>davfs заменен на davfs2</li>
<li>
<p>существенные изменения загрузочных скриптов</p>
<ul>
<li>включены патчи neobht для httpfs (поддержка имен хостов)</li>
<li>на основе патчей neobht изменён режим copy2ram (есть также синоним toram). Теперь можно указывать модули для этого по аналогии с load= и noload=. Старое указание без параметров подразумевает загрузку всех модулей.</li>
<li>разделы подключенные скриптами , прописываются в /etc/fstab</li>
<li>скриптами поддерживается клавиатура USB</li>
<li>поддержка разделов и образов ext4</li>
<li>доработан параметр from=, который позволяет загружать систему с указанного раздела или образа (iso образа или loop файла)</li>
</ul>
</li>
<li>
<p>В связи с пересборкой httpfs тем кто собирает систему со скриптов необходимо доустановить пакет libfuse-devel</p>
</li>
</ul>
<h3>сборка 20100611</h3>
<ul>
<li>прекращена поддержка 2009.1, буду стараться в течение месяца сделать 2010.1</li>
<li>включены обновления на 11.06.2010</li>
<li>удалены шрифты 75dpi kscd autologin readahead</li>
<li>добавлено dkms-libafs socat transcode qbittorrent</li>
<li>добавлен терминальный сервер freenx. После поднятия демона sshd можно подключится к машине с помощью кросплатформенной nxclient. для подключения нужно имя/пароль пользователя и ключ из /var/lib/nxserver/nxhome/.ssh/client.id_dsa.key. в модуле nxclient всё уже настроено и выведено в спец. ярлык</li>
<li>добавлен сервер proftpd. Пользователям при авторизации даётся доступ до /media анонимусам до /media/public</li>
<li>настроен самба сервер. При поднятии демона пользователям расшаривается /media гостю /media/public (при подключении укажите guest без пароля). Пароли пользователей отличаются от юниксовых на вход. Пароли поставленные пользователям по умолчанию можно посмотреть запустив скрипт /etc/rc.d/rc.local.MagOS.samba showdefpass (на этой же машине или подключившись через sshd) Сменить пароль можно командой smbpasswd имя_пользователя</li>
<li>
<p>самое главное изменение - новая разбивка на модули, удобная для создания серверов, серверов для закачки с инета, мультимедиа сервера xbmc</p>
<ul>
<li>модули desktop fullrpmbase упразднены. база rpm пакетов входит в модуль drakconf.</li>
<li>исправлены зависимости программ в модулях.приложения inkscape gajim перенесены в гном. qt приложения работают с модулем qt и не требуют kde</li>
<li>иксовые дрова для карт nvidia ati перенесены в модуль 3d</li>
</ul>
</li>
</ul>
<h3>сборка 20100505</h3>
<ul>
<li>включены обновления на 04.05.2010</li>
<li>исправление ошибок предыдущей сборки (mplayer gxneur)</li>
<li>доработаны загрузочные скрипты (поддержка ДНС для сетевой загрузки, добавлены некоторые сетевые драйверы). Размер образа initrd теперь 12000.</li>
<li>теперь можно передать хеш пароля для автоматически создаваемых пользователей (параметр загрузки users=)</li>
<li>исправлена ошибка выключения системы при подключении вручную модулей со сменных носителей.</li>
<li>вся документация системы из /usr/share/doc/ выведена в отдельный модуль 92-documentation размером около 39М</li>
<li>удалены стандартные обои powerpack и kde.</li>
<li>последние 2 пункта позволили сократить размер модуля kde до ~ 115М (ранее ~175М)</li>
<li>включен скрипт gactivate Александра Бетхера для подключения/отключения модулей по двойному щелчку.</li>
<li>решена проблема при переходе в спящий режим при подключенной флэш карте (возможно не для всего оборудования, но по крайней мере для того, о котором сообщали на форуме).</li>
<li>данная сборка является базовой для серверных ролей, которые планируется в дальнейшем.</li>
<li>добавлен samba-server</li>
<li>служба xinetd включена по умолчанию, все её компоненты отключены.</li>
<li>возможность автоматического запуcка скриптов вида /etc/rc.d/rc.local.MagOS.* при подключении модуля и при старте системы.</li>
</ul>
<h3>сборка 20100411</h3>
<ul>
<li>включены обновления на 10.04.2010</li>
<li>переведены на русский скрипты установки</li>
<li>возможен режим загрузки по сети (PXE сервер и клент)</li>
<li>существенно переделаны скрипты сборки. Теперь и 2010 и 2009 версии собираются одними и теме же скриптами. В обоих версиях используется одинаковая версия скриптов linux-live.</li>
<li>в 2009.1 убрано splashy (освободившееся место пошло под pxe клиент)</li>
<li>
<p>добавлен софт</p>
<ul>
<li>slim cheese mp3splt dhcp-server tftp-server</li>
<li>eiskaltdc вместо linuxdcpp</li>
<li>qutim вместо pidgin-</li>
</ul>
</li>
<li>
<p>загрузка lxde осуществляется через менеджер входа slim. для выключения и перезагрузки через этот менеджер используйте «пользователей» halt reboot</p>
</li>
<li>в ядре теперь эмблема MagOS</li>
<li>теперь нет преднастроенного пользователя user (500). Соответственно нет и настроек /home/user (соответственно и модуля 90-app_prefs). Настройки по умолчанию теперь хранятся либо в системных папках либо в /etc/skel. Система при старте если не указан параметр users создаёт пользователя user (500) и его домашний каталог, если ранее он не создавался.</li>
<li>все создаваемые пользователи входят в группу users</li>
<li>через новый параметр user можно задавать нескольких пользователей со своими uid-ами</li>
<li>новый параметр autologin задаёт пользователя для автовхода</li>
<li>mplayer блокирует хранитель экрана.</li>
</ul>
<h3>сборка 20100308</h3>
<ul>
<li>включены обновления на 07.03.2010</li>
<li>
<p>добавлено</p>
<ul>
<li>векторный редактор inkscape</li>
<li>кеширующий ДНС сервер pdnsd (включен по умолчанию)</li>
<li>mplayerplugin для просмотра онлайн видео в firefox по протоколу ms-asf</li>
<li>видео драйвер X11-driver-video-psb</li>
</ul>
</li>
<li>
<p>lxde теперь от edumandriva. Теперь в нём всё по-русски, в т.ч. нормально работает переключатель клавиатуры</p>
</li>
<li>в гноме на панель выведен glipper (менеджер буфера обмена)</li>
<li>при открытии rpm файла в КДЕ выдаётся запрос на установку вместо архиватора</li>
</ul>
<h3>сборка 20100218</h3>
<ul>
<li>включены обновления на 17.02.2010 (включая ядро)</li>
<li>добавлено memtest4 gksu kppp-provider tcl usb_modeswitch vpnpptp</li>
<li>добавлен новый параметр загрузки save2module . Параметр позволяет сохранять изменения не в профиль, а в новый модуль /mnt/livemedia/MagOS/modules/save-Дата-Время.lzm Постоянно использовать этот параметр не нужно, слишком много модулей наделает, но для быстрого создания неубиваемой настроенной для себя системы очень хорошо подходит.</li>
</ul>
<h3>сборка 20100108</h3>
<ul>
<li>включены обновления на 08.01.2010</li>
<li>добавлено exiv2 cuneiform+yagf (распознавание текстов) xneur gxneur (автом. переключатель раскладки клавиатуры ) glipper (менеджер буфера обмена для гнома)</li>
<li>audacious заменён на qmmp, ekiga на linphone</li>
<li>добавлены источники EduMandriva и Mib basic (mib отключён по умолчанию)</li>
<li>в скриптах сборки переделана загрузка, теперь можно легко использовать official plf edu и mib источники. Во время сборки, дистрибутив настраивается на источники и закачивает описания, т.о. источники всегда соответствуют времени сборки, раньше я их частенько забывал обновить.</li>
<li>новая тема хранителя экрана «Виды России» взамен стандартной темы ( [mdv-club.ru] )</li>
</ul>
<h3>сборка 20091218</h3>
<ul>
<li>включены обновления на 17.12.2009</li>
<li>добавлено dkms-broadcom-wl htop flac flac123 wavpack easytag gajim ffmpeg</li>
<li>модуль 92-international теперь не входит в архив. Кому он нужен, может его скачать с папки additions</li>
<li>при запуске скрипты linux-live теперь не пытаются подключить первый попавшийся раздел где есть MagOS а проверяют, совпадает ли файл VERSION с тем что был во время сборки initrd. Т.о. можно с флешки загружать одну версию MagOS а на винте иметь другую.</li>
</ul>
<h3>сборка 20091114</h3>
<ul>
<li>обновления на 14.11.2009</li>
<li>убрано splashy (Мандрива теперь перешла на plymouth, который включать наверное не буду)</li>
<li>подчищены сообщения о некритичных ошибках в /etc/rc.d/rc.sysinit</li>
<li>исправленные скрипты установки для syslinux</li>
<li>подправлены настройки по умолчанию в некоторых программах</li>
<li>самое главное - наконец-то заметил слона. Файлы локализации (не русской и не английской) выведены в отдельный модуль 92-international.lzm . Таких файлов набралось около 13 тысяч, весом на 400М (в сжатом виде 110М). Модуль этот можно просто удалить, если он не нужен. Благодаря этому теперь можно делать livecd на базе MagOS с КДЕ или Гномом. Раньше они не влезали в объём 700М</li>
</ul>
<h3>сборка 20091102</h3>
<ul>
<li>включены обновления на 01.11.2009 (wine оставлен со старой сборки, т.к. текущий глючит с mp3)</li>
<li>добавлено mpg123 (нужно для новых сборок wine)</li>
<li>новый параметр загрузки findswap .Он подключает первый попавшийся линуксовый swap раздел. Если таковых нет, то находит pagefile.sys от винды и использует его.</li>
<li>новый параметр desktop=no3d отключает 3d эффекты стола</li>
<li>исправленные скрипты установки. Возможность установки на любой раздел в винде vista/7</li>
<li>доработан механизм автозапуска lxde. Теперь отрабатывают скрипты иксов (установка обоев, загрузка значка сети и пр.). Возможно использовать 3d эффекты с помощью desktop=lxde,3d или через настройку в drakconf</li>
</ul>
<h3>сборка 20091011</h3>
<ul>
<li>включены обновления на 10.10.2009</li>
<li>добавлено grip audacity hardinfo lm_sensors gnome-netstatus gnome-sensors-applet</li>
<li>поправлены настройки по умолчанию linuxdcpp</li>
<li>исправлена работа на ntfs разделе. Правильно выключается, русские имена доступны.</li>
<li>
<p>новый параметр загрузки desktop. С его помощью можно выбрать режим работы.</p>
<ul>
<li>none - консоль,</li>
<li>kde|gnome|lxde - загрузка указанной среды, даже если в профиле указано иначе</li>
<li>3d - включить эффекты 3D стола, даже если раньше были отключены.</li>
</ul>
</li>
</ul>
<h3>сборка 20090912</h3>
<ul>
<li>включены обновления на 10.09.2009 (включая ядро qt plasma)</li>
<li>удалён ненужный файл /usr/lib/drakx-installer-stage2/install/stage2/mdkinst.sqfs весом 45M, что позволило включить дополнительные пакеты</li>
<li>добавлен compiz-fusion с эффектами и значком в системном лотке fusion-icon. XGL не включен ввиду своей тормознутости (программный сервер снижает производительность мультимедиа программ). Используется только «родная» поддержка</li>
<li>
<p>compiz настроен на emerald. С ним, в отличие от kwin, работает стабильно.</p>
<ul>
<li>для включения 3D эффектов в профиле воспользуйтесь drak3d. В «чистом» варианте есть параметр загрузчика load=<em>compiz</em></li>
<li>для выключения есть «параметр ядра» no3ddesktop</li>
</ul>
</li>
<li>
<p>модули немного переделаны. Аналог gparted live можно собрать размером в 370М .Для мандривы со сборкой в режиме «всё включено» это очень неплохо.</p>
</li>
<li>поправлены настройки по умолчанию gqview firefox . Последний при выходе предлагает удалить кеш (полезно для скорости и экономии места) и личные данные.</li>
<li>исправлено монтирование разделов несъёмных жёстких. Разрешено пользователю, ntfs на запись.</li>
<li>в связи с предыдущим пунктом убран костыль mount-gtk</li>
<li>поставлены пакеты нужные для playonlinux (его самого планирую выпустить модулем)</li>
<li>/mnt/livemedia подключается с владельцем user. Что позволяет получить максимальные права и использовать drakloop для создания криптофайлов.</li>
<li>загрузочные скрипты подчищены, убраны лишние сообщения об ошибках (например при отключении splashy во время его работы)</li>
<li>новый параметр загрузки nofreemedia оставляет подключенным /mnt/livemedia в любом случае.</li>
<li>пользователю user разрешено запускать gparted с правами root (через sudo). Ярлык на запуск изменён (Утилиты-Системные)</li>
</ul>
<h3>сборка 20090717</h3>
<ul>
<li>включены обновления на 17.07.2009 (включая ядро)</li>
<li>lxde в рабочем состоянии. Теперь есть 3 среды KDE GNOME LXDE Для экономии места можно оставить только одну. Если присутствует несколько то «главным» будет модуль с большим номером. Для установки другой среды по умолчанию просто переименуйте модуль</li>
<li>решён глюк с часовым поясом (время показывалось нормально, а на файлах ставились странные даты)</li>
<li>все модули пересмотрены на предмет правильности вхождения в них пакетов</li>
<li>модули core x-desktop уменьшены в размере из них выведены модули printers qt multimedia. Полезно при установке на 1Г флешку и экономии памяти в режиме copy2ram</li>
<li>добавлено fuse, утилиты для работы с reiser4, testdisk, parted, partclone, partimage, pbzip2.</li>
<li>удалено totem, gftp</li>
<li>преднастройки gqview firefox (предложения в закладки принимаются), восстановлены ассоциации exe на wine</li>
<li>добавлены ключи от мандривовских источников и plf, чтобы при установке не было ругани на подписи</li>
</ul>
<h3>сборка 20090704</h3>
<ul>
<li>Включены обновления на 20090740, включая qt и kde</li>
<li>Исправлено двойное монтирование tmpfs /dev/shm, что приводило к пожиранию КДЕ около 150М памяти в /tmp , даёт ощутимый прирост производительности на машинах с 512М ОЗУ</li>
<li>Теперь есть Gnome. Чтобы Гном грузился по умолчанию, нужно поменять номер модуля, чтобы был больше чем у КДЕ. Один из модулей (КДЕ,Гном) можно удалить или перенести в optional.</li>
<li>Экспериментальный, нерабочий модуль LXDE.</li>
<li>Утилиты для монтирования pmount mount-gtk. Для тех разделов, которые игнорирует HAL</li>
<li>С панели КДЕ убран плазмоид монтирования. Он приводил к падению КДЕ, порче файловых систем. Апплет можно добавить вручную.</li>
<li>iptables настроен на блокировку всех входящих (кроме ответов на запросы)</li>
<li>ядро и initscripts убраны из автомат. обновлений.</li>
<li>Отключено по умолчанию Pulseaudio.</li>
<li>kppp настроен на Билайн МТС Мегафон ТЕЛЕ2 Gnome-PPP только на Билайн (не поддерживает нескольких провайдеров)</li>
</ul>
<h3>сборка 20090621</h3>
<ul>
<li>Поддержка 64Г памяти - на машинах с 4Г это даёт возможность работать с последним гигом памяти</li>
<li>Определение IDE - SATA контроллеров в initrd, что даёт возможность делать Livedvd. ставить на винт</li>
<li>
<p>Допилены скрипты для создания iso образов</p>
<ul>
<li>make_iso.sh - создание livedvd,</li>
<li>make_boot_iso.sh - создание загр. диска размером 10М для загрузки на компах, не поддерживающих загрузку с USB</li>
</ul>
</li>
<li>
<p>носитель с которого грузится маг-ось всегда монтируется в /mnt/livemedia</p>
</li>
<li>можно сделать ссылки ~/Документы → /mnt/livemedia/Документы</li>
<li>если указано copy2ram и не указано changes= то флешка-носитель освобождается скриптами initrd, её можно вытаскивать после старта мандривовских init скриптов</li>
<li>диски которые есть в системе автоматом не монтируются, не прописываются в /etc/fstab - чтобы не создавать проблем c HAL.</li>
<li>служба network теперь включена по умолчанию</li>
<li>удалено - draklive* amarok fonts-ttf-west-european dragonplayer</li>
<li>Включены обновления на 20090617, в скриптах можно указывать приоритетные источники. Wine например берётся первым делом с backports</li>
<li>
<p>добавлены</p>
<ul>
<li>minicom (средство работы с оборудованием через послед. порт)</li>
<li>chntpw (взлом винды 95-2000-XP-Vista)</li>
<li>epdfview (лёгкая утилита просмотра и печати pdf)</li>
<li>nfs-utils (для создания NFS сервера)</li>
<li>ncpfs ipxutils (для нетвари)</li>
</ul>
</li>
</ul>
<h3>сборка 20090511</h3>
<ul>
<li>первая сборка MagOS-Linux</li>
</ul>
<p>В случае возникновения вопросов и пожеланий, просим обращаться в наше сообщество в <a href="https://gitter.im/magos-linux-ru/chat">Gitter</a></p></body></html>
